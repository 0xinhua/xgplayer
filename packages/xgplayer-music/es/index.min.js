function styleInject(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}import Player from"xgplayer";var css='@charset "UTF-8";\n.xgplayer-skin-default.xgplayer-music .xgplayer-controls {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  height: 50px;\n  cursor: default; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-backward, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-backward-img {\n    -webkit-box-ordinal-group: 1;\n        -ms-flex-order: 0;\n            order: 0;\n    cursor: pointer; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-backward:hover, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-backward-img:hover {\n      opacity: 0.85; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-prev, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-prev-img {\n    -webkit-box-ordinal-group: 2;\n        -ms-flex-order: 1;\n            order: 1;\n    cursor: pointer; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-prev:hover, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-prev-img:hover {\n      opacity: 0.85; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-play, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-play-img {\n    -webkit-box-ordinal-group: 3;\n        -ms-flex-order: 2;\n            order: 2; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-play .xgplayer-tips, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-play-img .xgplayer-tips {\n      display: none; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-next, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-next-img {\n    -webkit-box-ordinal-group: 4;\n        -ms-flex-order: 3;\n            order: 3;\n    cursor: pointer; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-next:hover, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-next-img:hover {\n      opacity: 0.85; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-forward, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-forward-img {\n    -webkit-box-ordinal-group: 5;\n        -ms-flex-order: 4;\n            order: 4;\n    cursor: pointer; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-forward:hover, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-forward-img:hover {\n      opacity: 0.85; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-volume {\n    -webkit-box-ordinal-group: 6;\n        -ms-flex-order: 5;\n            order: 5;\n    cursor: pointer; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-volume .xgplayer-icon {\n      bottom: -13px; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-cover {\n    position: static;\n    -webkit-box-ordinal-group: 7;\n        -ms-flex-order: 6;\n            order: 6;\n    width: 40px;\n    height: 40px;\n    text-align: center;\n    vertical-align: middle;\n    position: relative;\n    top: 50%;\n    margin-top: -17px; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-cover img {\n      max-width: 100%;\n      max-height: 100%; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress {\n    position: relative;\n    -webkit-box-ordinal-group: 8;\n        -ms-flex-order: 7;\n            order: 7;\n    top: 70%;\n    left: 20px;\n    margin-top: -11px;\n    -webkit-box-flex: 99;\n        -ms-flex: 99;\n            flex: 99; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress .xgplayer-name {\n      position: absolute;\n      left: 0px;\n      top: -120%;\n      font-size: 12px;\n      color: #ddd; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress > * {\n      height: 3px;\n      margin-top: 8.5px; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress .xgplayer-progress-played:after {\n      top: -4px;\n      width: 10px;\n      height: 10px;\n      content: " ";\n      display: block; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress .xgplayer-tips {\n      display: none !important; }\n    .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress:hover .xgplayer-progress-btn, .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-progress:focus .xgplayer-progress-btn {\n      top: -5px; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-time {\n    -webkit-box-ordinal-group: 9;\n        -ms-flex-order: 8;\n            order: 8;\n    margin-left: 30px;\n    line-height: 1;\n    position: relative;\n    top: 55%; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-placeholder {\n    -webkit-box-ordinal-group: 1000;\n        -ms-flex-order: 999;\n            order: 999;\n    width: 0; }\n  .xgplayer-skin-default.xgplayer-music .xgplayer-controls .xgplayer-icon {\n    padding-top: 5px; }\n\n.xgplayer-skin-default.xgplayer-music.xgplayer-ended .xgplayer-controls {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n\n.xgplayer-skin-default.xgplayer-music.xgplayer-nostart .xgplayer-controls {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n\n.xgplayer-skin-default .xgplayer-lyric-item {\n  display: block;\n  line-height: 22px;\n  font-size: 14px;\n  color: black; }\n  .xgplayer-skin-default .xgplayer-lyric-item.xgplayer-lyric-item-active {\n    color: aquamarine; }\n\n.xgplayer-skin-default .xgplayer-lrcWrap {\n  overflow: auto;\n  height: 300px;\n  border: 1px solid #ddd;\n  padding: 20px; }\n\n.xgplayer-skin-default .xgplayer-lrcForward {\n  position: absolute;\n  top: 20%;\n  left: 300px;\n  cursor: pointer;\n  width: 0;\n  height: 0;\n  border-width: 0 10px 10px;\n  border-style: solid;\n  border-color: transparent transparent #333;\n  /*透明 透明  灰*/ }\n\n.xgplayer-skin-default .xgplayer-lrcBack {\n  position: absolute;\n  top: 80%;\n  left: 300px;\n  cursor: pointer;\n  width: 0;\n  height: 0;\n  border-width: 10px 10px 0;\n  border-style: solid;\n  border-color: #333 transparent transparent;\n  /*透明 透明  灰*/ }\n';styleInject(css);for(var classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=(function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()),inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},LyricTime=function e(t){classCallCheck(this,e),this.regRule=/(\d{2}(?=:)):(\d{2}(?=\.))\.(\d{2,3})/g,this.regRule.test(t)?this.time=60*RegExp.$1+1*RegExp.$2+1*("0."+RegExp.$3):this.time=-1},Lyric=function(){function e(t,n){var i=this;classCallCheck(this,e),this.rawTxts=t,this.txts=t.map(function(e){return e.replace(/^[\r\n]|[\r\n]$/g,"").match(/(\[.*\])[^[]+/g)}),this.isDynamics=t.map(function(e,t){return[].concat(e.match(/\[\d{2}:\d{2}\.\d{2,3}\]/g)).length===i.txts[t].length&&i.txts[t].length===i.txts[0].length&&i.txts[t].length>1}),this.isDynamic=this.isDynamics.some(function(e){return e}),this.__ainimateInterval__=0,this.__offset__=0,this.__offsetScale__=.5,this.dom=n,this.lists=[],this.isDynamics.map(function(e,t){e&&i.lists.push(i.txts[t].map(function(e,t){var n=/(\[[\d:\S]+\])([^[]+)/g.test(e),i=RegExp.$1,r=RegExp.$2;return{time:n?new LyricTime(i).time:-1,lyric:r,idx:t}}))}),this.list=this.lists.reduce(function(e,t){return e.map(function(e,n){return{time:e.time,lyric:"\n"===e.lyric?""+e.lyric+t[n].lyric:e.lyric+"<br/>"+t[n].lyric,idx:n}})}),this.line=0}return createClass(e,[{key:"adjust",value:function(){for(var e,t,n=this.list,i=0,r=n.length;i<r;i++){for(e=i+1;e<r&&!(n[e].time>n[i].time);e++);if(e<r){var a=(n[e].time-n[i].time)/(e-i);for(t=i+1;t<e;t++)n[t].time=n[t-1].time+a}}}},{key:"find",value:function(e){var t=this.list,n=this.__ainimateInterval__,i=this.__offset__;return e=e+i>0?e+i:0,t.filter(function(i,r){var a=i.time,o=r+1;return e>=a&&(t[o]&&1*e+1*n<=t[o].time||o>=t.length)})}},{key:"bind",value:function(e){var t=this,n=this;return this.__player__=e,!!n.isDynamic&&(n.__handle__=function(){var n=t.find(e.currentTime)[0];n&&n.idx!==t.line&&(t.line=n.idx,e.emit("lyricUpdate",n))}.bind(n,e),e.on("timeupdate",n.__handle__),n.__startHandle__=function(){e.emit("lyricUpdate",n.list[0])}.bind(n,e),e.once("playing",n.__startHandle__),!0)}},{key:"unbind",value:function(e){delete this.__player__,this.__handle__&&(e.off("lyricUpdate",this.__handle__),delete this.__handle__)}},{key:"show",value:function(){var e=this,t=this.dom,n=[],i=this,r=["click","touchstart"];if(t&&1===t.nodeType){var a=Player.util.createDom("div","<div></div>",{},"xgplayer-lrcWrap");t.appendChild(a),this.list.forEach(function(e){n.push('<xg-lyric-item class="xgplayer-lyric-item" data-idx="'+e.idx+'">'+e.lyric.replace(/[\r\n]/g,"")+"</xg-lyric-item>")}),a.innerHTML=n.join("");var o=Player.util.createDom("xg-lrcForward","<div></div>",{},"xgplayer-lrcForward");t.appendChild(o),r.forEach(function(e){o.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation(),i.offset-=i.offsetScale,console.log("lyric go forward "+i.offsetScale+"s")},!1)});var s=Player.util.createDom("xg-lrcBack","<div></div>",{},"xgplayer-lrcBack");t.appendChild(s),r.forEach(function(e){s.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation(),i.offset+=i.offsetScale,console.log("lyric go back "+i.offsetScale+"s")},!1)}),this.__updateHandle__=function(t){var n=e.dom.querySelector(".xgplayer-lrcWrap"),i=n.querySelector(".xgplayer-lyric-item-active"),r=n.offsetHeight,a=void 0;i&&(i.className="xgplayer-lyric-item"),(i=n.querySelector('.xgplayer-lyric-item[data-idx="'+t.idx+'"]'))&&(i.className="xgplayer-lyric-item xgplayer-lyric-item-active",(a=i.getBoundingClientRect().top-n.getBoundingClientRect().top+n.scrollTop-r/2)&&(n.scrollTop=a))},this.__player__.on("lyricUpdate",this.__updateHandle__)}else this.__player__.emit("error","lyric container can not be empty")}},{key:"hide",value:function(){this.__updateHandle__.off("lyricUpdate",this.__updateHandle__)}},{key:"interval",set:function(e){this.__ainimateInterval__=e},get:function(){return this.__ainimateInterval__}},{key:"offset",set:function(e){this.__offset__=e},get:function(){return this.__offset__}},{key:"offsetScale",set:function(e){this.__offsetScale__=e},get:function(){return this.__offsetScale__}}]),e}(),lastTime=0,prefixes="webkit moz ms o".split(" "),requestAnimationFrame=window.requestAnimationFrame,cancelAnimationFrame=window.cancelAnimationFrame,prefix,i=0;i<prefixes.length&&(!requestAnimationFrame||!cancelAnimationFrame);i++)prefix=prefixes[i],requestAnimationFrame=requestAnimationFrame||window[prefix+"RequestAnimationFrame"],cancelAnimationFrame=cancelAnimationFrame||window[prefix+"CancelAnimationFrame"]||window[prefix+"CancelRequestAnimationFrame"];requestAnimationFrame&&cancelAnimationFrame||(requestAnimationFrame=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-lastTime)),r=window.setTimeout(function(){e.call(n+i)},i);return lastTime=n+i,r},cancelAnimationFrame=function(e){window.clearTimeout(e)});var isSqrt=function(e,t){if(1!==e){for(;1!==e;){if(e%t!=0)return!1;e/=t}return!0}return!0},Color=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;classCallCheck(this,e),this.color=e.Valid.test(t)?t:"#ffffff",this.opacity=n}return createClass(e,[{key:"toArray",value:function(){var e=this.color.slice(1),t=[];return 6===e.length&&(t=(e=e.match(/\d{2}/g)).map(function(e){return Number("0x"+e)})),t}},{key:"toRGB",value:function(){var e=this.toArray();return 3===e.length?"rgb("+e[0]+","+e[1]+","+e[2]+")":""}},{key:"toGRBA",value:function(){var e=this.toArray();return 3===e.length?"rgba("+e[0]+","+e[1]+","+e[2]+","+this.opacity+")":""}}],[{key:"Valid",get:function(){return/^#[0-9A-F]{6}$|^#[0-9A-F]{3}$/i}}]),e}(),util={requestAnimationFrame:requestAnimationFrame,cancelAnimationFrame:cancelAnimationFrame,isSqrt:isSqrt,Color:Color},req=util.requestAnimationFrame,cancel=util.cancelAnimationFrame,isSqrt$1=util.isSqrt,Color$1=util.Color,Analyze=function(){function e(t,n){var i=this;if(classCallCheck(this,e),this.canvas=n,this.player=t,e.AudioCtx){var r=new e.AudioCtx,a=r.createAnalyser(),o=r.createGain();a.minDecibels=-90,a.maxDecibels=-10,a.smoothingTimeConstant=.85,o.gain.setValueAtTime(t.volume,t.currentTime),this.er=r.createMediaElementSource(t.video),this.analyser=a,this.ctx=n.getContext("2d"),this.er.connect(a),a.connect(o),o.connect(r.destination),this.style={bgColor:"#c8c8c8",color:"#643232"},this.__type__="bars",this.__size__=256,this.__status__={switch:"on"},["play","playing","seeked"].forEach(function(e){t.on(e,function(){i["__"+i.__type__+"__"]()})}),["seeking","waiting","pause","ended"].forEach(function(e){cancel(i.__status__[i.__type__])}),t.on("volumechange",function(){o.gain.setValueAtTime(t.volume,t.currentTime)}),t.on("destroy",function(){r.close()})}}return createClass(e,[{key:"__wave__",value:function(){var e=this;if(cancel(this.__status__.wave),cancel(this.__status__.bars),"off"!==this.__status__.switch){var t=this.analyser,n=this.canvas,i=this.ctx,r=t.frequencyBinCount,a=new Uint8Array(r),o=n.width,s=n.height,l=new Color$1(this.style.color).toRGB(),c=new Color$1(this.style.color).toRGB();t.fftSize=this.__size__;!function u(){e.__status__.wave=req(u),t.getByteTimeDomainData(a),i.clearRect(0,0,o,s),i.fillStyle=c,i.lineWidth=2,i.strokeStyle=l,i.beginPath();for(var p=1*o/r,f=0,d=0;d<r;d++){var h=a[d]/128*s/2;0===d?i.moveTo(f,h):i.lineTo(f,h),f+=p}i.lineTo(n.width,n.height/2),i.stroke()}()}}},{key:"__bars__",value:function(){var e=this;if(cancel(this.__status__.wave),cancel(this.__status__.bars),"off"!==this.__status__.switch){var t=this.analyser,n=this.canvas,i=this.ctx,r=t.frequencyBinCount,a=new Uint8Array(r),o=n.width,s=n.height,l=new Color$1(this.style.color).toArray(),c=new Color$1(this.style.color).toRGB();t.fftSize=this.__size__;!function n(){e.__status__.bars=req(n),t.getByteFrequencyData(a),i.clearRect(0,0,o,s),i.fillStyle=c,i.fillRect(0,0,o,s);for(var u=o/r*2.5,p=void 0,f=0,d=0;d<r;d++)p=a[d],i.fillStyle="rgb("+(p+l[0])+","+l[1]+","+l[2]+")",i.fillRect(f,s-p/2,u,p/2),f+=u+1}()}}},{key:"on",value:function(){this.__status__.switch="on",this["__"+this.__type__+"__"]()}},{key:"off",value:function(){this.__status__.switch="off",cancel(this.__status__.wave),cancel(this.__status__.bars)}},{key:"mode",set:function(t){e.Mode.filter(function(e){return e===t}).length&&(this.__type__=t,"on"===this.__status__.switch&&this["__"+t+"__"]())},get:function(){return this.__type__}},{key:"size",set:function(e){e<65536&&isSqrt$1(e,2)&&(this.__size__=e,this.analyser.fftSize=e,this["__"+this.__type__+"__"]())},get:function(){return this.__size__}},{key:"status",get:function(){return this.__status__.switch}}],[{key:"AudioCtx",get:function(){return window.AudioContext||window.webkitAudioContext}},{key:"Mode",get:function(){return["wave","bars"]}}]),e}(),_undefined=void 0,is=function(e){return e!==_undefined&&null!==e},possibleTypes={object:!0,function:!0,undefined:!0},is$1=function(e){return!!is(e)&&hasOwnProperty.call(possibleTypes,typeof e)},is$2=function(e){if(!is$1(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}},is$3=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!is$2(e)},classRe=/^\s*class[\s{\/}]/,functionToString=Function.prototype.toString,is$4=function(e){return!!is$3(e)&&!classRe.test(functionToString.call(e))},isImplemented=function(){var e,t=Object.assign;return"function"==typeof t&&(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},isImplemented$1=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}},noop=function(){},_undefined$1=noop(),isValue=function(e){return e!==_undefined$1&&null!==e},keys=Object.keys,shim=function(e){return keys(isValue(e)?Object(e):e)},keys$1=isImplemented$1()?Object.keys:shim,validValue=function(e){if(!isValue(e))throw new TypeError("Cannot use null or undefined");return e},max=Math.max,shim$1=function(e,t){var n,i,r,a=max(arguments.length,2);for(e=Object(validValue(e)),r=function(i){try{e[i]=t[i]}catch(e){n||(n=e)}},i=1;i<a;++i)t=arguments[i],keys$1(t).forEach(r);if(void 0!==n)throw n;return e},assign=isImplemented()?Object.assign:shim$1,forEach=Array.prototype.forEach,create=Object.create,process=function(e,t){var n;for(n in e)t[n]=e[n]},normalizeOptions=function(e){var t=create(null);return forEach.call(arguments,function(e){isValue(e)&&process(Object(e),t)}),t},str="razdwatrzy",isImplemented$2=function(){return"function"==typeof str.contains&&(!0===str.contains("dwa")&&!1===str.contains("foo"))},indexOf=String.prototype.indexOf,shim$2=function(e){return indexOf.call(this,e,arguments[1])>-1},contains=isImplemented$2()?String.prototype.contains:shim$2,d_1=createCommonjsModule(function(e){(e.exports=function(e,t){var n,i,r,a,o;return arguments.length<2||"string"!=typeof e?(a=t,t=e,e=null):a=arguments[2],is(e)?(n=contains.call(e,"c"),i=contains.call(e,"e"),r=contains.call(e,"w")):(n=r=!0,i=!1),o={value:t,configurable:n,enumerable:i,writable:r},a?assign(normalizeOptions(a),o):o}).gs=function(e,t,n){var i,r,a,o;return"string"!=typeof e?(a=n,n=t,t=e,e=null):a=arguments[3],is(t)?is$4(t)?is(n)?is$4(n)||(a=n,n=void 0):n=void 0:(a=t,t=n=void 0):t=void 0,is(e)?(i=contains.call(e,"c"),r=contains.call(e,"e")):(i=!0,r=!1),o={get:t,set:n,configurable:i,enumerable:r},a?assign(normalizeOptions(a),o):o}}),validCallable=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},eventEmitter=createCommonjsModule(function(e,t){var n,i,r,a,o,s,l,c=Function.prototype.apply,u=Function.prototype.call,p=Object.create,f=Object.defineProperty,d=Object.defineProperties,h=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};o={on:n=function(e,t){var n;return validCallable(t),h.call(this,"__ee__")?n=this.__ee__:(n=y.value=p(null),f(this,"__ee__",y),y.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:i=function(e,t){var i,a;return validCallable(t),a=this,n.call(this,e,i=function(){r.call(a,e,i),c.call(t,this,arguments)}),i.__eeOnceListener__=t,this},off:r=function(e,t){var n,i,r,a;if(validCallable(t),!h.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(i=n[e]))for(a=0;r=i[a];++a)r!==t&&r.__eeOnceListener__!==t||(2===i.length?n[e]=i[a?0:1]:i.splice(a,1));else i!==t&&i.__eeOnceListener__!==t||delete n[e];return this},emit:a=function(e){var t,n,i,r,a;if(h.call(this,"__ee__")&&(r=this.__ee__[e]))if("object"==typeof r){for(n=arguments.length,a=new Array(n-1),t=1;t<n;++t)a[t-1]=arguments[t];for(r=r.slice(),t=0;i=r[t];++t)c.call(i,this,a)}else switch(arguments.length){case 1:u.call(r,this);break;case 2:u.call(r,this,arguments[1]);break;case 3:u.call(r,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,a=new Array(n-1),t=1;t<n;++t)a[t-1]=arguments[t];c.call(r,this,a)}}},s={on:d_1(n),once:d_1(i),off:d_1(r),emit:d_1(a)},l=d({},s),e.exports=t=function(e){return null==e?p(l):d(Object(e),s)},t.methods=o}),eventEmitter_1=eventEmitter.methods,Xhr=function(){function e(t,n){classCallCheck(this,e),eventEmitter(this),this.url=t;var i=new window.XMLHttpRequest;i.target=this,i.responseType="arraybuffer",i.open("get",t),i.onload=function(){200!==i.status&&206!==i.status||n&&n instanceof Function&&n(i.response)},i.onerror=function(e){i.target.emit("error"+e.message)},this.xhr=i,this.run()}return createClass(e,[{key:"cancel",value:function(){this.xhr.abort()}},{key:"run",value:function(){1===this.xhr.readyState&&this.xhr.send()}}]),e}(),mode=void 0,timeScale=15,util$1=Player.util,Music=function(e){function t(e){classCallCheck(this,t);var n=util$1.deepCopy({controls:!0,mediaType:"audio",ignores:["fullscreen","start","definition","makeBullet","textTrack","loading","pc","mobile","playbackRate","replay","error","poster"]},e);n.volumeShow||n.ignores.push("volume");var i=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n)),r=i;return i.rawConfig=e,i.list="Array"===util$1.typeOf(n.url)?n.url:[{src:n.url,name:n.name,vid:n.vid,poster:n.poster}],i.name=i.list[0].name,i.vid=i.list[0].vid,i.poster=i.list[0].poster,i.nextIndex=1,i.prevIndex=i.list.length-1,i.halfPass=!1,i.history=[],i.index=0,n.controls?(util$1.addClass(i.root,"xgplayer-music"),n.width||(i.config.width="100%",i.root.style.width="100%"),n.height||(i.config.height="50px",i.root.style.height="50px"),Object.defineProperty(i,"src",{get:function(){return this.video.currentSrc},set:function(e){var t="String"===util$1.typeOf(e)?{src:e,name:""}:e;this.history.push(t),this.video.src=t.src},configurable:!0}),i.config.autoplayMuted&&(i.config.volume=i.config.autoplay?0:i.config.volume),r.once("ready",function(){util$1.addClass(r.root,"xgplayer-skin-default"),r.config.lang&&"en"===r.config.lang?util$1.addClass(r.root,"lang-is-en"):"jp"===r.config.lang&&util$1.addClass(r.root,"lang-is-jp")}),i.once("canplay",function(){this.config.autoplay&&this.config.autoplayMuted?this.volume=0:this.volume=this.config.volume}),i.on("timeupdate",function(){!i.halfPass&&i.currentTime>i.duration/2&&i.confirmOrder()}),i.on("ended",function(){if("order"===i.mode&&i.index+1>=i.list.length)return i.pause(),void(i.currentTime=0);switch(i.mode){case"sloop":i.change();break;case"order":case"loop":default:i.next()}}),i.config.segPlay||i.checkOffline(r.list[0].src,r.list[0].vid||r.list[0].name).then(function(e){r.config.url=e,r.start(e)}),i):(i.root.style.display="none",possibleConstructorReturn(i))}return inherits(t,e),createClass(t,[{key:"lyric",value:function(e,t){return this.__lyric__&&this.__lyric__.unbind(this),"Array"!==Player.util.typeOf(e)&&(e=[].concat(e)),this.__lyric__=new Lyric(e,t),this.__lyric__.bind(this),this.__lyric__}},{key:"confirmOrder",value:function(){var e=this;this.halfPass=!0,this.nextComput(),this.prevComput(),this.config.preloadNext&&this.checkOffline(this.list[this.nextIndex].src,this.list[this.nextIndex].vid||this.list[this.nextIndex].name).then(function(t){if(t.indexOf("blob:")<0){var n=e.list[e.nextIndex].vid||e.list[e.nextIndex].name;new Xhr(e.list[e.nextIndex].src,function(t){e.database.openDB(function(){e.database.addData(e.database.myDB.ojstore.name,[{vid:n,blob:new Blob([t],{type:'audio/mp4; codecs="mp4a.40.5"'})}]),setTimeout(function(){e.database.closeDB()},5e3)})})}})}},{key:"nextComput",value:function(){switch(this.mode){case"sloop":case"order":case"loop":this.index+1<this.list.length?this.nextIndex=this.index+1:this.nextIndex=0;break;default:this.nextIndex=Math.ceil(Math.random()*this.list.length)}}},{key:"prevComput",value:function(){switch(this.mode){case"sloop":case"order":case"loop":this.index-1>=0?this.prevIndev=this.index-1:this.prevIndev=this.list.length-1;break;default:this.prevIndev=Math.ceil(Math.random()*this.list.length)}}},{key:"add",value:function(e){this.list.push({src:e.src,name:e.name,vid:e.vid,poster:e.poster})}},{key:"remove",value:function(e){var t=-1;this.list.every(function(n,i){return n.src!==e&&n.name!==e&&n.vid!==e||(t=i,!1)}),t>-1&&this.list.splice(t,1)}},{key:"change",value:function(){var e=this,t=e.list[e.index].vid||e.list[e.index].name;this.halfPass=!1,this.checkOffline(e.list[e.index].src,t).then(function(t){Player.m4a?(e.video.load(),e.name=e.list[e.index].name,e.vid=e.list[e.index].vid,e.poster=e.list[e.index].poster,e.emit("change",{src:t,name:e.name,vid:e.vid,poster:e.poster})):(e.video.pause(),e.currentTime=0,e.src=t,e.name=e.list[e.index].name,e.vid=e.list[e.index].vid,e.poster=e.list[e.index].poster,setTimeout(function(){e.video.play().then(function(){e.emit("change",{src:t,name:e.name,vid:e.vid,poster:e.poster})})},60))})}},{key:"checkOffline",value:function(e,t){var n=this;return new Promise(function(i){n.config.offline||i(e),n.database.openDB(function(){n.database.getDataByKey(n.database.myDB.ojstore.name,t,function(t){setTimeout(function(){n.database.closeDB()},5e3),i(t?URL.createObjectURL(t.blob):e)})})})}},{key:"next",value:function(){this.halfPass||(this.halfPass=!0,this.nextComput()),this.index=this.nextIndex,this.change()}},{key:"prev",value:function(){this.halfPass||(this.halfPass=!0,this.prevComput()),this.index=this.prevIndex,this.change()}},{key:"forward",value:function(){this.currentTime=this.currentTime+timeScale<this.duration?this.currentTime+timeScale:this.duration-.1}},{key:"backward",value:function(){this.currentTime=this.currentTime-timeScale>0?this.currentTime-timeScale:0}},{key:"analyze",value:function(e){return new Analyze(this,e)}},{key:"mode",get:function(){return mode||t.ModeType[2]},set:function(e){switch(e){case 0:case 1:case 2:case 3:mode=t.ModeType[e]}this.confirmOrder()}},{key:"timeScale",get:function(){return timeScale||15},set:function(e){timeScale=e}}],[{key:"AudioCtx",get:function(){return window.AudioContext||window.webkitAudioContext}},{key:"ModeType",get:function(){return["order","random","loop","sloop"]}}]),t}(Player),backward=function(e){var t=Music.util,n=e.controls,i=["click","touchstart"],r=e.config.backwardBtn?e.config.backwardBtn:{},a=void 0;a="img"===r.type?Music.util.createImgBtn("backward",r.url,r.width,r.height):t.createDom("xg-backward",'<xg-icon class="xgplayer-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024">\n              <path transform = "scale(1.5 1.5) translate(8 4.5)"\n              d="m 14,2.99996 0,10 -7,-5 7,-5 z m -7,5 0,5 -7,-5 7,-5 0,5 z m -7,0 0,0 z"></path>\n          </svg></xg-icon>',{},"xgplayer-backward"),n.appendChild(a),i.forEach(function(t){a.addEventListener(t,function(t){t.preventDefault(),t.stopPropagation(),e.backward()},!1)})};Music.install("backward",backward);var cover=function(e){var t=Music.util,n=e.controls,i=t.createDom("xg-cover",'<img src="'+(e.config.poster||e.config.url[0].poster)+'">',{},"xgplayer-cover");n.appendChild(i),e.on("change",function(e){i.innerHTML='<img src="'+e.poster+'">'})};Music.install("cover",cover);var forward=function(e){var t=Music.util,n=e.controls,i=["click","touchstart"],r=e.config.forwardBtn?e.config.forwardBtn:{},a=void 0;a="img"===r.type?Music.util.createImgBtn("forward",r.url,r.width,r.height):t.createDom("xg-forward",'<xg-icon class="xgplayer-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024">\n              <path transform = "scale(1.5 1.5) translate(-2 4.5)"\n              d="m 2,2.99996 0,10 7,-5 -7,-5 z m 7,5 0,5 7,-5 -7,-5 0,5 z m 7,0 0,0 z"></path>\n          </svg></xg-icon>',{},"xgplayer-forward"),n.appendChild(a),i.forEach(function(t){a.addEventListener(t,function(t){t.preventDefault(),t.stopPropagation(),e.forward()},!1)})};Music.install("forward",forward);var meta=function(e){var t=Music.util,n=e.controls.querySelector(".xgplayer-progress"),i=t.createDom("xg-name",""+(e.config.name||e.config.url[0].name),{},"xgplayer-name");n.appendChild(i),e.on("change",function(e){i.innerHTML=""+e.name})};Music.install("meta",meta);var next=function(e){var t=Music.util,n=e.controls,i=["click","touchstart"],r=e.config.nextBtn?e.config.nextBtn:{},a=void 0;a="img"===r.type?Music.util.createImgBtn("next",r.url,r.width,r.height):t.createDom("xg-next",'<xg-icon class="xgplayer-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024">\n              <path transform="scale(0.025 0.025)"\n              d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>\n          </svg></xg-icon>',{},"xgplayer-next"),n.appendChild(a),i.forEach(function(t){a.addEventListener(t,function(t){t.preventDefault(),t.stopPropagation(),e.next()},!1)})};Music.install("next",next);var prev=function(e){var t=Music.util,n=e.controls,i=["click","touchstart"],r=e.config.prevBtn?e.config.prevBtn:{},a=void 0;a="img"===r.type?Music.util.createImgBtn("prev",r.url,r.width,r.height):t.createDom("xg-prev",'<xg-icon class="xgplayer-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024">\n              <path transform = "scale(0.025 0.025)"\n              d="M600 1140v-768h128v352l320-320v704l-320-320v352zz"></path>\n          </svg></xg-icon>',{},"xgplayer-prev"),n.appendChild(a),i.forEach(function(t){a.addEventListener(t,function(t){t.preventDefault(),t.stopPropagation(),e.prev()},!1)})};Music.install("prev",prev);export default Music;
//# sourceMappingURL=index.min.js.map
