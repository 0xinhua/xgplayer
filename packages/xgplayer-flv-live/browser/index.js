window.FlvPlayer=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=52)}([function(e,t,r){"use strict";e.exports={Context:r(13).default,EVENTS:r(15).default,WORKER_COMMANDS:r(16).default,sniffer:r(17).default,isLe:r(18).default,UTF8:r(19).default,MediaInfo:r(5).default,MediaSample:r(20).default,MediaSegment:r(21).default,MediaSegmentList:r(22).default,AudioTrackMeta:r(6).AudioTrackMeta,VideoTrackMeta:r(6).VideoTrackMeta,AudioTrackSample:r(7).AudioTrackSample,VideoTrackSample:r(7).VideoTrackSample,Mse:r(23).default,Stream:r(8).default,Buffer:r(24).default,MobileVideo:r(27)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.id=-1,this.sequenceNumber=0,this.samples=[],this.droppedSamples=[],this.length=0}reset(){this.sequenceNumber=0,this.samples=[],this.length=0}distroy(){this.reset(),this.id=-1}}t.default=n;t.AudioTrack=class extends n{constructor(){super(),this.TAG="AudioTrack",this.type="audio"}};t.VideoTrack=class extends n{constructor(){super(),this.TAG="VideoTrack",this.type="video",this.dropped=0}reset(){this.sequenceNumber=0,this.samples=[],this.length=0,this.dropped=0}};t.Tracks=class{constructor(){this.audioTrack=null,this.videoTrack=null}}},function(e,t,r){"use strict";e.exports={Nalunit:r(9).default,SpsParser:r(10).default,Compatibility:r(46).default}},function(e,t,r){"use strict";e.exports={Track:r(1).default,Tracks:r(1).Tracks,AudioTrack:r(1).AudioTrack,VideoTrack:r(1).VideoTrack,XgBuffer:r(12).XgBuffer,RemuxBuffer:r(12).RemuxBuffer,PreSource:r(48).default}},function(e,t){e.exports=window.Player},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e=>{for(let t in e)if(e.hasOwnProperty(t)&&null===e[t])return!1;return!0};class i{constructor(){this.mimeType=null,this.duration=null,this.hasVideo=null,this.video={codec:null,width:null,height:null,profile:null,level:null,frameRate:{fixed:!0,fps:25,fps_num:25e3,fps_den:1e3},chromaFormat:null,parRatio:{width:1,height:1}},this.hasAudio=null,this.audio={codec:null,sampleRate:null,sampleRateIndex:null,channelCount:null}}isComplete(){return i.isBaseInfoReady(this)&&i.isVideoReady(this)&&i.isAudioReady(this)}static isBaseInfoReady(e){return n(e)}static isVideoReady(e){return!e.hasVideo||n(e.video)}static isAudioReady(e){return!e.hasAudio||n(e.video)}}t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AudioTrackMeta=class{constructor(e){const t={sampleRate:48e3,channelCount:2,codec:"mp4a.40.2",config:[41,401,136,0],duration:0,id:2,refSampleDuration:21,sampleRateIndex:3,timescale:1e3,type:"audio"};return e?Object.assign({},t,e):t}};t.VideoTrackMeta=class{constructor(e){const t={avcc:null,sps:new Uint8Array(0),pps:new Uint8Array(0),chromaFormat:420,codec:"avc1.640020",codecHeight:720,codecWidth:1280,duration:0,frameRate:{fixed:!0,fps:25,fps_num:25e3,fps_den:1e3},id:1,level:"3.2",presentHeight:720,presentWidth:1280,profile:"High",refSampleDuration:40,parRatio:{height:1,width:1},timescale:1e3,type:"video"};return e?Object.assign({},t,e):t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){let t=n.getDefault();return e?Object.assign({},t,e):t}static getDefault(){return{dts:null,pts:null,data:new Uint8Array}}}t.AudioTrackSample=n;class i{constructor(e){let t=i.getDefault();return e?Object.assign({},t,e):t}static getDefault(){return{dts:null,pts:null,isKeyframe:!1,originDts:null,data:new Uint8Array}}}t.VideoTrackSample=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){if(!(e instanceof ArrayBuffer))throw new Error("data is invalid");this.buffer=e,this.dataview=new DataView(e),this.dataview.position=0}get length(){return this.buffer.byteLength}set position(e){this.dataview.position=e}get position(){return this.dataview.position}back(e){this.position-=e}skip(e){let t=Math.floor(e/4),r=e%4;for(let e=0;e<t;e++)n.readByte(this.dataview,4);r>0&&n.readByte(this.dataview,r)}static readByte(e,t,r){let n;switch(t){case 1:n=r?e.getInt8(e.position):e.getUint8(e.position);break;case 2:n=r?e.getInt16(e.position):e.getUint16(e.position);break;case 3:if(r)throw new Error("not supported for readByte 3");n=e.getUint8(e.position)<<16,n|=e.getUint8(e.position+1)<<8,n|=e.getUint8(e.position+2);break;case 4:n=r?e.getInt32(e.position):e.getUint32(e.position);break;case 8:if(r)throw new Error("not supported for readBody 8");n=e.getUint32(e.position)<<32,n|=e.getUint32(e.position+4);break;default:n=""}return e.position+=t,n}readUint8(){return n.readByte(this.dataview,1)}readUint16(){return n.readByte(this.dataview,2)}readUint24(){return n.readByte(this.dataview,3)}readUint32(){return n.readByte(this.dataview,4)}readUint64(){return n.readByte(this.dataview,8)}readInt8(){return n.readByte(this.dataview,1,!0)}readInt16(){return n.readByte(this.dataview,2,!0)}readInt32(){return n.readByte(this.dataview,4,!0)}writeUint32(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}}t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(10),o=(n=i)&&n.__esModule?n:{default:n};class s{static getNalunits(e){if(e.length-e.position<4)return[];let t=e.dataview,r=e.position;return 1===t.getInt32(r)||0===t.getInt16(r)&&1===t.getInt8(r+2)?s.getAnnexbNals(e):s.getAvccNals(e)}static getAnnexbNals(e){let t=[],r=s.getHeaderPositionAnnexB(e),n=r.pos,i=n;for(;n<e.length-4;){let o=e.buffer.slice(n,n+r.headerLength);r.pos===e.position&&e.skip(r.headerLength),i=(r=s.getHeaderPositionAnnexB(e)).pos;let a={header:o,body:new Uint8Array(e.buffer.slice(n+o.byteLength,i))};s.analyseNal(a),t.push(a),e.skip(i-e.position),n=i}return t}static getAvccNals(e){let t=[];for(;e.position<e.length-4;){let r=e.dataview.getInt32(e.position);if(!(e.length-e.position>=r))break;{let n=e.buffer.slice(e.position,e.position+4);e.skip(4);let i=e.buffer.slice(e.position,e.position+r);e.skip(r);let o={header:n,body:i};s.analyseNal(o),t.push(o)}}return t}static analyseNal(e){switch(31&e.body[0]){case 1:e.ndr=!0;break;case 5:e.idr=!0;break;case 6:break;case 7:e.sps=o.default.parseSPS(e.body);break;case 8:e.pps=!0}}static getHeaderPositionAnnexB(e){let t=e.position,r=0;for(;3!==r&&4!==r&&t<e.length-4;)0===e.dataview.getInt16(t)?1===e.dataview.getInt16(t+2)?r=4:1===e.dataview.getInt8(t+2)?r=3:t++:t++;return t===e.length-4&&(0===e.dataview.getInt16(t)?1===e.dataview.getInt16(t+2)&&(r=4):(t++,0===e.dataview.getInt16(t)&&1===e.dataview.getInt8(t)?r=3:t=e.length)),{pos:t,headerLength:r}}static getAvcc(e,t){let r=new Uint8Array(e.byteLength+t.byteLength+11);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;let n=6;return r.set(new Uint8Array([e.byteLength>>>8&255,255&e.byteLength]),n),n+=2,r.set(e,n),r[n+=e.byteLength]=1,n++,r.set(new Uint8Array([t.byteLength>>>8&255,255&t.byteLength]),n),n+=2,r.set(t,n),r}}t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(30),o=(n=i)&&n.__esModule?n:{default:n};class s{static _ebsp2rbsp(e){let t=e,r=t.byteLength,n=new Uint8Array(r),i=0;for(let e=0;e<r;e++)e>=2&&3===t[e]&&0===t[e-1]&&0===t[e-2]||(n[i]=t[e],i++);return new Uint8Array(n.buffer,0,i)}static parseSPS(e){let t=s._ebsp2rbsp(e),r=new o.default(t);r.readByte();let n=r.readByte();r.readByte();let i=r.readByte();r.readUEG();let a=s.getProfileString(n),u=s.getLevelString(i),l=1,d=420,c=[0,420,422,444],f=8;if((100===n||110===n||122===n||244===n||44===n||83===n||86===n||118===n||128===n||138===n||144===n)&&(3===(l=r.readUEG())&&r.readBits(1),l<=3&&(d=c[l]),f=r.readUEG()+8,r.readUEG(),r.readBits(1),r.readBool())){let e=3!==l?8:12;for(let t=0;t<e;t++)r.readBool()&&(t<6?s._skipScalingList(r,16):s._skipScalingList(r,64))}r.readUEG();let h=r.readUEG();if(0===h)r.readUEG();else if(1===h){r.readBits(1),r.readSEG(),r.readSEG();let e=r.readUEG();for(let t=0;t<e;t++)r.readSEG()}r.readUEG(),r.readBits(1);let p=r.readUEG(),m=r.readUEG(),g=r.readBits(1);0===g&&r.readBits(1),r.readBits(1);let y=0,_=0,E=0,v=0;r.readBool()&&(y=r.readUEG(),_=r.readUEG(),E=r.readUEG(),v=r.readUEG());let w=1,b=1,A=0,S=!0,D=0,T=0;if(r.readBool()){if(r.readBool()){let e=r.readByte(),t=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],n=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];e>0&&e<16?(w=t[e-1],b=n[e-1]):255===e&&(w=r.readByte()<<8|r.readByte(),b=r.readByte()<<8|r.readByte())}if(r.readBool()&&r.readBool(),r.readBool()&&(r.readBits(4),r.readBool()&&r.readBits(24)),r.readBool()&&(r.readUEG(),r.readUEG()),r.readBool()){let e=r.readBits(32),t=r.readBits(32);S=r.readBool(),A=(D=t)/(T=2*e)}}let k=1;1===w&&1===b||(k=w/b);let R=0,O=0;if(0===l)R=1,O=2-g;else{R=3===l?1:2,O=(1===l?2:1)*(2-g)}let M=16*(p+1),B=16*(m+1)*(2-g);M-=(y+_)*R,B-=(E+v)*O;let U=Math.ceil(M*k);return r.destroy(),r=null,{profile_string:a,level_string:u,bit_depth:f,chroma_format:d,chroma_format_string:s.getChromaFormatString(d),frame_rate:{fixed:S,fps:A,fps_den:T,fps_num:D},par_ratio:{width:w,height:b},codec_size:{width:M,height:B},present_size:{width:U,height:B}}}static _skipScalingList(e,t){let r=8,n=8,i=0;for(let o=0;o<t;o++)0!==n&&(n=(r+(i=e.readSEG())+256)%256),r=0===n?r:n}static getProfileString(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}static getLevelString(e){return(e/10).toFixed(1)}static getChromaFormatString(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}static toVideoMeta(e){let t={};e&&e.codec_size&&(t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height),t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.parRatio={width:e.par_ratio.width,height:e.par_ratio.height},t.frameRate=e.frame_rate;let r=t.frameRate.fps_den,n=t.frameRate.fps_num;t.refSampleDuration=Math.floor(t.timescale*(r/n))}}t.default=s},function(e,t,r){"use strict";var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.XgBuffer=class{constructor(e){this.length=e||0,this.historyLen=e||0,this.array=[],this.offset=0}push(e){this.array.push(e),this.length+=e.byteLength,this.historyLen+=e.byteLength}shift(e){if(this.array.length<1)return new Uint8Array(0);if(void 0===e)return this._shiftBuffer();if(this.offset+e===this.array[0].length){let t=this.array[0].slice(this.offset,this.offset+e);return this.offset=0,this.array.shift(),this.length-=e,t}if(this.offset+e<this.array[0].length){let t=this.array[0].slice(this.offset,this.offset+e);return this.offset+=e,this.length-=e,t}let t=new Uint8Array(e),r=0;for(;this.array.length>0&&e>0;){if(this.offset+e<this.array[0].length){let n=this.array[0].slice(this.offset,this.offset+e);t.set(n,r),this.offset+=e,this.length-=e,e=0;break}{let n=this.array[0].length-this.offset;t.set(this.array[0].slice(this.offset,this.array[0].length),r),this.array.shift(),this.offset=0,r+=n,this.length-=n,e-=n}}return t}clear(){this.array=[],this.length=0,this.offset=0}destroy(){this.clear(),this.historyLen=0}_shiftBuffer(){return this.length-=this.array[0].length,this.offset=0,this.array.shift()}toInt(e,t){let r=0,n=this.offset+e;for(;n<this.offset+t+e;)n<this.array[0].length?r=256*r+this.array[0][n]:this.array[1]&&(r=256*r+this.array[1][n-this.array[0].length]),n++;return r}};t.RemuxBuffer=class{constructor(){this.video=[],this.audio=[]}destroy(){this.video=[],this.audio=[]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n},s=r(14);const a="__TO__";t.default=class{constructor(e=[]){this._emitter=new s.EventEmitter,this._instanceMap={},this._clsMap={},this._inited=!1,this.mediaInfo=new o.default,this.allowedEvents=e,this._hooks={}}getInstance(e){return this._instanceMap[e]?this._instanceMap[e]:null}initInstance(e,...t){if(this._clsMap[e]){const r=new this._clsMap[e](...t);return this._instanceMap[e]=r,r.init&&r.init(),r}throw new Error(`${e}未在context中注册`)}init(e){if(!this._inited){for(let t in this._clsMap)this._clsMap.hasOwnProperty(t)&&!this._instanceMap[t]&&this.initInstance(t,e);this._inited=!0}}registry(e,t){const r=this._emitter,n=this._isMessageNameValid.bind(this),i=this;return this._clsMap[e]=class extends t{constructor(...t){super(...t),this.listeners={},this.onceListeners={},this.TAG=e,this._context=i}on(t,i){return n(t),this.listeners[t]?this.listeners[t].push(i):this.listeners[t]=[i],r.on(`${t}${a}${e}`,i),r.on(t,i)}before(e,t){n(e),i._hooks[e]?i._hooks[e].push(t):i._hooks[e]=[t]}once(t,i){return n(t),this.onceListeners[t]?this.onceListeners[t].push(i):this.onceListeners[t]=[i],r.once(`${t}${a}${e}`,i),r.once(t,i)}emit(e,...t){n(e);const o=i._hooks[e];if(o)for(let e=0,t=o.length;e<t;e++){(0,o[e])()}return r.emit(e,...t)}emitTo(e,t,...i){return n(t),r.emit(`${t}${a}${e}`,...i)}off(e,t){return n(e),r.off(e,t)}removeListeners(){const t=Object.prototype.hasOwnProperty.bind(this.listeners);for(let n in this.listeners)if(t(n)){const t=this.listeners[n]||[];for(let i=0;i<t.length;i++){const o=t[i];r.off(n,o),r.off(`${n}${a}${e}`,o)}}for(let n in this.onceListeners)if(t(n)){const t=this.onceListeners[n]||[];for(let i=0;i<t.length;i++){const o=t[i];r.off(n,o),r.off(`${n}${a}${e}`,o)}}}destroy(){this.removeListeners(),delete i._instanceMap[e],super.destroy&&super.destroy()}},(...t)=>this.initInstance(e,...t)}destroyInstances(){Object.keys(this._instanceMap).forEach(e=>{this._instanceMap[e].destroy&&this._instanceMap[e].destroy()})}destroy(){this._emitter=null,this.allowedEvents=[],this._clsMap=null,this._context=null,this.destroyInstances()}_isMessageNameValid(e){if(!this.allowedEvents.indexOf(e)<0)throw new Error(`unregistered message name: ${e}`)}}},function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,r,n){var i,o,s,a;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return e}function c(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=c.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):m(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var l=u.length,d=m(u,l);for(r=0;r<l;++r)o(d[r],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,o,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_ERROR:"LOADER_ERROR"},i={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO"},o={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT"},s={SOURCE_UPDATE_END:"SOURCE_UPDATE_END"},a={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},u=Object.assign({},n,i,o,s,a),l=[],d=[];for(let e in u)u.hasOwnProperty(e)&&l.push(u[e]);for(let e in u)u.hasOwnProperty(e)&&d.push(u[e]);t.default={ALLEVENTS:u,HLS_EVENTS:a,REMUX_EVENTS:o,DEMUX_EVENTS:i,MSE_EVENTS:s,LOADER_EVENTS:n,FlvAllowedEvents:l,HlsAllowedEvents:d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CONTEXT_COMOMANDS={ON:"on",ONCE:"once",OFF:"off",EMIT:"emit",DESTROY:"destroy"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}(),i={get device(){let e=i.os;return e.isPc?"pc":e.isTablet?"tablet":"mobile"},get browser(){let e=navigator.userAgent.toLowerCase(),t={ie:/rv:([\d.]+)\) like gecko/,firfox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(t).filter(r=>t[r].test(e)))[0]},get os(){let e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),r=/(?:SymbianOS)/.test(e)||t,n=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),o=/(?:iPad|PlayBook)/.test(e)||n&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e),s=/(?:iPhone)/.test(e)&&!o;return{isTablet:o,isPhone:s,isAndroid:n,isPc:!s&&!n&&!r,isSymbian:r,isWindowsPhone:t,isFireFox:i}},get isLe(){return n}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static decode(e){const t=[],r=e;let i=0;const o=e.length;for(;i<o;)if(r[i]<128)t.push(String.fromCharCode(r[i])),++i;else{if(r[i]<192);else if(r[i]<224){if(n._checkContinuation(r,i,1)){const e=(31&r[i])<<6|63&r[i+1];if(e>=128){t.push(String.fromCharCode(65535&e)),i+=2;continue}}}else if(r[i]<240){if(n._checkContinuation(r,i,2)){const e=(15&r[i])<<12|(63&r[i+1])<<6|63&r[i+2];if(e>=2048&&55296!=(63488&e)){t.push(String.fromCharCode(65535&e)),i+=3;continue}}}else if(r[i]<248&&n._checkContinuation(r,i,3)){let e=(7&r[i])<<18|(63&r[i+1])<<12|(63&r[i+2])<<6|63&r[i+3];if(e>65536&&e<1114112){e-=65536,t.push(String.fromCharCode(e>>>10|55296)),t.push(String.fromCharCode(1023&e|56320)),i+=4;continue}}t.push(String.fromCharCode(65533)),++i}return t.join("")}static _checkContinuation(e,t,r){let n=e;if(t+r<n.length){for(;r--;)if(128!=(192&n[++t]))return!1;return!0}return!1}}t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){let t=n.getDefaultInf();if(!e||"[object Object]"!==Object.prototype.toString.call(e))return t;let r=Object.assign({},t,e);Object.entries(r).forEach(([e,t])=>{this[e]=t})}static getDefaultInf(){return{dts:null,pts:null,duration:null,position:null,isRAP:!1,originDts:null}}}t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.startDts=-1,this.endDts=-1,this.startPts=-1,this.endPts=-1,this.originStartDts=-1,this.originEndDts=-1,this.randomAccessPoints=[],this.firstSample=null,this.lastSample=null}addRAP(e){e.isRAP=!0,this.randomAccessPoints.push(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this._type=e,this._list=[],this._lastAppendLocation=-1}get type(){return this._type}get length(){return this._list.length}isEmpty(){return 0===this._list.length}clear(){this._list=[],this._lastAppendLocation=-1}_searchNearestSegmentBefore(e){let t=this._list;if(0===t.length)return-2;let r=t.length-1,n=0,i=0,o=r,s=0;if(e<t[0].originDts)return s=-1;for(;i<=o;){if((n=i+Math.floor((o-i)/2))===r||e>t[n].lastSample.originDts&&e<t[n+1].originDts){s=n;break}t[n].originDts<e?i=n+1:o=n-1}return s}_searchNearestSegmentAfter(e){return this._searchNearestSegmentBefore(e)+1}append(e){let t=this._list,r=this._lastAppendLocation,n=0;-1!==r&&r<t.length&&e.originStartDts>=t[r].lastSample.originDts&&(r===t.length-1||r<t.length-1&&e.originStartDts<t[r+1].originStartDts)?n=r+1:t.length>0&&(n=this._searchNearestSegmentBefore(e.originStartDts)+1),this._lastAppendLocation=n,this._list.splice(n,0,e)}getLastSegmentBefore(e){let t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null}getLastSampleBefore(e){let t=this.getLastSegmentBefore(e);return null!==t?t.lastSample:null}getLastRAPBefore(e){let t=this._searchNearestSegmentBefore(e),r=this._list[t].randomAccessPoints;for(;0===r.length&&t>0;)t--,r=this._list[t].randomAccessPoints;return r.length>0?r[r.length-1]:null}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.configs=Object.assign({},e),this.container=this.configs.container,this.mediaSource=null,this.sourceBuffers={},this.preloadTime=this.configs.preloadTime||1}init(){this.mediaSource=new self.MediaSource,this.mediaSource.addEventListener("sourceopen",this.onSourceOpen.bind(this)),this.container.src=URL.createObjectURL(this.mediaSource),this.url=this.container.src,this.container.addEventListener("timeupdate",this.onTimeUpdate.bind(this)),this.container.addEventListener("waiting",this.onWaiting.bind(this))}onTimeUpdate(){this.emit("TIME_UPDATE",this.container)}onWaiting(){this.emit("WAITING",this.container)}onSourceOpen(){this.addSourceBuffers()}onUpdateEnd(){this.emit("SOURCE_UPDATE_END"),this.doAppend()}addSourceBuffers(){if("open"!==this.mediaSource.readyState)return;let e,t=this._context.getInstance("PRE_SOURCE_BUFFER"),r=this._context.getInstance("TRACKS");t=t.sources;let n=!1;for(let i=0,o=Object.keys(t).length;i<o;i++){let o=Object.keys(t)[i];if("audio"===o?e=r.audioTrack:"video"===o&&(e=r.videoTrack),e){let r="audio"===o?21:40;e.meta&&e.meta.refSampleDuration&&(r=e.meta.refSampleDuration),t[o].data.length>=this.preloadTime/r&&(n=!0)}}if(n){if(Object.keys(this.sourceBuffers).length>0)return;for(let e=0,r=Object.keys(t).length;e<r;e++){let r=Object.keys(t)[e],n=t[r],i="video"===r?"video/mp4;codecs="+n.mimetype:"audio/mp4;codecs="+n.mimetype,o=this.mediaSource.addSourceBuffer(i);this.sourceBuffers[r]=o,o.addEventListener("updateend",this.onUpdateEnd.bind(this)),this.doAppend()}}}doAppend(){let e=this._context.getInstance("PRE_SOURCE_BUFFER");if(e)for(let t=0;t<Object.keys(this.sourceBuffers).length;t++){let r=Object.keys(this.sourceBuffers)[t],n=this.sourceBuffers[r];if(!n.updating){let t=e.sources[r];if(t&&!t.inited)n.appendBuffer(t.init.buffer.buffer),t.inited=!0;else if(t){let e=t.data.shift();e&&n.appendBuffer(e.buffer.buffer)}}}}endOfStream(){"open"===this.mediaSource.readyState&&this.mediaSource.endOfStream()}remove(e){for(let t=0;t<Object.keys(this.sourceBuffers).length;t++){let r=this.sourceBuffers[Object.keys(this.sourceBuffers)[t]];r.updating||r.remove(0,e)}}destroy(){this.container.removeEventListener("timeupdate",this.onTimeUpdate),this.container.removeEventListener("waiting",this.onWaiting),this.mediaSource.removeEventListener("sourceopen",this.onSourceOpen),this.configs={},this.container=null,this.mediaSource=null,this.sourceBuffers={},this.preloadTime=1;for(let e=0;e<Object.keys(this.sourceBuffers).length;e++){let t=this.sourceBuffers[Object.keys(this.sourceBuffers)[e]];t.removeEventListener("updateend",this.onUpdateEnd),this.mediaSource.removeSourceBuffer(t),delete this.sourceBuffers[Object.keys(this.sourceBuffers)[e]]}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(25),o=(n=i)&&n.__esModule?n:{default:n};t.default=class{constructor(e){this.buffer=e||new Uint8Array(0)}write(...e){e.forEach(e=>{this.buffer=(0,o.default)(Uint8Array,this.buffer,e)})}static writeUint32(e){return new Uint8Array([e>>24,e>>16&255,e>>8&255,255&e])}static readAsInt(e){let t="";return e.forEach(e=>{t+=function(e){return e.toString(16).padStart(2,"0")}(e)}),parseInt(t,16)}}},function(e,t,r){"use strict";var n,i=r(26),o=(n=i)&&n.__esModule?n:{default:n};e.exports=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=0,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=!0,s=!1,a=void 0;try{for(var u,l=n[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var d=u.value;t+=d.length}}catch(e){s=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw a}}var c=new e(t),f=0,h=!0,p=!1,m=void 0;try{for(var g,y=n[Symbol.iterator]();!(h=(g=y.next()).done);h=!0){var _=g.value;c.set(_,f),f+=_.length}}catch(e){p=!0,m=e}finally{try{!h&&y.return&&y.return()}finally{if(p)throw m}}return c}},function(e,t,r){"use strict";var n=o(r(28)),i=o(r(37));function o(e){return e&&e.__esModule?e:{default:e}}class s extends HTMLElement{constructor(e){super(),this.vCtx=new n.default,this.aCtx=new i.default(e),this.historyTime=0}destroy(){}onDemuxComplete(e,t){this.vCtx.decodeVideo(e)}setAudioMeta(e){this.aCtx.setAudioMetaData(e)}setVideoMeta(e){this.vCtx.setVideoMetaData(e)}get currentTime(){}play(){this.aCtx.play(),this.vCtx.play()}}customElements.define("mobile-video",s)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(29)),i=s(r(8)),o=s(r(9));function s(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e){this.canvas=document.createElement("canvas"),this.config=Object.assign({},e),this._decoderInited=!1,this.oncanplay=void 0,this.meta=void 0,this._avccpushed=!1,this.initWasmWorker()}initWasmWorker(){let e=this;this.wasmworker=(0,n.default)(31),this.wasmworker.postMessage({msg:"init"}),this.wasmworker.addEventListener("message",t=>{switch(t.data.msg){case"DECODER_READY":e._decoderInited=!0;break;case"DECODED":console.log("decoded",t.data.data,t.data.width,t.data.height,t.data.info)}})}setVideoMetaData(e){if(console.log(e),this.meta=e,!this._decoderInited)return;this._avccpushed=!0;let t=new Uint8Array(e.sps.byteLength+4);t.set([0,0,0,1]),t.set(e.sps,4),this.wasmworker.postMessage({msg:"decode",data:t}),(t=new Uint8Array(e.pps.byteLength+4)).set([0,0,0,1]),t.set(e.pps,4),this.wasmworker.postMessage({msg:"decode",data:t})}decodeVideo(e){if(!this._decoderInited)return;this._avccpushed||this.setVideoMetaData(this.meta);let{samples:t}=e,r=t.shift();if(!r)return;let n=o.default.getAvccNals(new i.default(r.data.buffer)),s=0;for(let e=0;e<n.length;e++){s+=n[e].body.byteLength+4}let a=0,u=new Uint8Array(s);for(let e=0;e<n.length;e++){let t=n[e];u.set([0,0,0,1],a),a+=4,u.set(new Uint8Array(t.body),a),a+=t.body.byteLength}this.wasmworker.postMessage({msg:"decode",data:u,info:{dts:r.dts,pts:r.pts}})}play(){}}},function(e,t,r){"use strict";function n(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+i+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,n){var a={};a[n]=[];var u=t.toString(),l=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return a;for(var d,c=l[1],f=new RegExp("(\\\\n|\\W)"+s(c)+o,"g");d=f.exec(u);)"dll-reference"!==d[3]&&a[n].push(d[3]);for(f=new RegExp("\\("+s(c)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+o,"g");d=f.exec(u);)e[d[2]]||(a[n].push(d[1]),e[d[2]]=r(d[1]).m),a[d[2]]=a[d[2]]||[],a[d[2]].push(d[4]);for(var h,p=Object.keys(a),m=0;m<p.length;m++)for(var g=0;g<a[p[m]].length;g++)h=a[p[m]][g],isNaN(1*h)||(a[p[m]][g]=1*a[p[m]][g]);return a}function u(e){return Object.keys(e).reduce((function(t,r){return t||e[r].length>0}),!1)}e.exports=function(e,t){t=t||{};var i={main:r.m},o=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},n={main:[]},i={main:{}};u(r);)for(var o=Object.keys(r),s=0;s<o.length;s++){var l=o[s],d=r[l].pop();if(i[l]=i[l]||{},!i[l][d]&&e[l][d]){i[l][d]=!0,n[l]=n[l]||[],n[l].push(d);for(var c=a(e,e[l][d],l),f=Object.keys(c),h=0;h<f.length;h++)r[f[h]]=r[f[h]]||[],r[f[h]]=r[f[h]].concat(c[f[h]])}}return n}(i,e),s="";Object.keys(o).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;o[e][t];)t++;o[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),s=s+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var l=new window.Blob([s],{type:"text/javascript"});if(t.bare)return l;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),c=new window.Worker(d);return c.objectURL=d,c}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.TAG="Golomb",this._buffer=e,this._bufferIndex=0,this._totalBytes=e.byteLength,this._totalBits=8*e.byteLength,this._currentWord=0,this._currentWordBitsLeft=0}destroy(){this._buffer=null}_fillCurrentWord(){let e=this._totalBytes-this._bufferIndex,t=Math.min(4,e),r=new Uint8Array(4);r.set(this._buffer.subarray(this._bufferIndex,this._bufferIndex+t)),this._currentWord=new DataView(r.buffer).getUint32(0,!1),this._bufferIndex+=t,this._currentWordBitsLeft=8*t}readBits(e){if(e<=this._currentWordBitsLeft){let t=this._currentWord>>>32-e;return this._currentWord<<=e,this._currentWordBitsLeft-=e,t}let t=this._currentWordBitsLeft?this._currentWord:0;this._currentWordBitsLeft;let r=e-this._currentWordBitsLeft;this._fillCurrentWord();let n=Math.min(r,this._currentWordBitsLeft),i=this._currentWord>>>32-n;return this._currentWord<<=n,this._currentWordBitsLeft-=n,t=t<<n|i}readBool(){return 1===this.readBits(1)}readByte(){return this.readBits(8)}_skipLeadingZero(){let e;for(e=0;e<this._currentWordBitsLeft;e++)if(0!=(this._currentWord&2147483648>>>e))return this._currentWord<<=e,this._currentWordBitsLeft-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}readUEG(){let e=this._skipLeadingZero();return this.readBits(e+1)-1}readSEG(){let e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}}},function(e,t,r){"use strict";(function(t,r,n){var i=function(e,i){var o=function(){var n,o=void 0!==o?o:{},s={};for(n in o)o.hasOwnProperty(n)&&(s[n]=o[n]);var a,u=[],l="./this.program",d=function(e,t){throw t},c=!1,f=!1;c="object"==typeof window,f="function"==typeof importScripts,a="object"==typeof t&&"object"==typeof t.versions&&"string"==typeof t.versions.node;var h,p,m="";(c||f)&&(f?m=self.location.href:document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},f&&(p=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var g=o.print||console.log.bind(console),y=o.printErr||console.warn.bind(console);for(n in s)s.hasOwnProperty(n)&&(o[n]=s[n]);s=null,o.arguments&&(u=o.arguments),o.thisProgram&&(l=o.thisProgram),o.quit&&(d=o.quit);function _(e){var t=H[q>>2],r=t+e+15&-16;return r>Ve()&&fe(),H[q>>2]=r,t}function E(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return 4;if("i"===e[0]){var t=parseInt(e.substr(1));return R(t%8==0,"getNativeTypeSize invalid bits "+t+", type "+e),t/8}return 0}}var v={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0);var w,b,A,S=0;function D(e,t,r,n){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":z[e>>0]=t;break;case"i16":G[e>>1]=t;break;case"i32":H[e>>2]=t;break;case"i64":ye=[t>>>0,(ge=t,+re(ge)>=1?ge>0?(0|oe(+ie(ge/4294967296),4294967295))>>>0:~~+ne((ge-+(~~ge>>>0))/4294967296)>>>0:0)],H[e>>2]=ye[0],H[e+4>>2]=ye[1];break;case"float":X[e>>2]=t;break;case"double":W[e>>3]=t;break;default:fe("invalid type for setValue: "+r)}}o.wasmBinary&&(w=o.wasmBinary),o.noExitRuntime&&(b=o.noExitRuntime),"object"!=typeof WebAssembly&&y("no native wasm support detected");var T=new WebAssembly.Table({initial:1896,maximum:1896,element:"anyfunc"}),k=!1;function R(e,t){e||fe("Assertion failed: "+t)}var O=0,M=3;function B(e,t,r,n){var i,o;"number"==typeof e?(i=!0,o=e):(i=!1,o=e.length);var s,a="string"==typeof t?t:null;if(s=r==M?n:[it,ot,_][r](Math.max(o,a?1:t.length)),i){var u;for(n=s,R(0==(3&s)),u=s+(-4&o);n<u;n+=4)H[n>>2]=0;for(u=s+o;n<u;)z[n++>>0]=0;return s}if("i8"===a)return e.subarray||e.slice?V.set(e,s):V.set(new Uint8Array(e),s),s;for(var l,d,c,f=0;f<o;){var h=e[f];0!==(l=a||t[f])?("i64"==l&&(l="i32"),D(s+f,h,l),c!==l&&(d=E(l),c=l),f+=d):f++}return s}function U(e){return te?it(e):_(e)}var L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function P(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.subarray&&L)return L.decode(e.subarray(t,i));for(var o="";t<i;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var u=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|u:(7&s)<<18|a<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var l=s-65536;o+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function x(e,t){return e?P(V,e,t):""}function C(e,t,r,n){if(!(n>0))return 0;for(var i=r,o=r+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(r>=o)break;t[r++]=a}else if(a<=2047){if(r+1>=o)break;t[r++]=192|a>>6,t[r++]=128|63&a}else if(a<=65535){if(r+2>=o)break;t[r++]=224|a>>12,t[r++]=128|a>>6&63,t[r++]=128|63&a}else{if(r+3>=o)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63,t[r++]=128|a>>6&63,t[r++]=128|63&a}}return t[r]=0,r-i}function N(e,t,r){return C(e,V,t,r)}function I(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++r)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");function F(e,t,r){for(var n=0;n<e.length;++n)z[t++>>0]=e.charCodeAt(n);r||(z[t>>0]=0)}var j,z,V,G,H,X,W;var Y,q=239120,K=o.TOTAL_MEMORY||16777216;function $(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?o.dynCall_v(r):o.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}(A=o.wasmMemory?o.wasmMemory:new WebAssembly.Memory({initial:K/65536,maximum:K/65536}))&&(j=A.buffer),K=j.byteLength,j=Y=j,o.HEAP8=z=new Int8Array(Y),o.HEAP16=G=new Int16Array(Y),o.HEAP32=H=new Int32Array(Y),o.HEAPU8=V=new Uint8Array(Y),o.HEAPU16=new Uint16Array(Y),o.HEAPU32=new Uint32Array(Y),o.HEAPF32=X=new Float32Array(Y),o.HEAPF64=W=new Float64Array(Y),H[q>>2]=5482208;var J=[],Z=[],Q=[],ee=[],te=!1;var re=Math.abs,ne=(Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil),ie=Math.floor,oe=(Math.pow,Math.imul,Math.fround,Math.round,Math.min),se=(Math.max,Math.clz32,Math.trunc),ae=0,ue=null,le=null;function de(e){ae++,o.monitorRunDependencies&&o.monitorRunDependencies(ae)}function ce(e){if(ae--,o.monitorRunDependencies&&o.monitorRunDependencies(ae),0==ae&&(null!==ue&&(clearInterval(ue),ue=null),le)){var t=le;le=null,t()}}function fe(e){throw o.onAbort&&o.onAbort(e),g(e+=""),y(e),k=!0,1,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}o.preloadedImages={},o.preloadedAudios={};var he="data:application/octet-stream;base64,";function pe(e){return String.prototype.startsWith?e.startsWith(he):0===e.indexOf(he)}var me,ge,ye,_e="https://sf6-ttcdn-tos.pstatp.com/obj/ttfe/media/decoder_em.wasm";function Ee(){try{if(w)return new Uint8Array(w);if(p)return p(_e);throw"both async and sync fetching of the wasm failed"}catch(e){fe(e)}}pe(_e)||(me=_e,_e=o.locateFile?o.locateFile(me,m):m+me),o.asm=function(){var e={env:$e,wasi_unstable:$e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:v};function t(e,t){var r=e.exports;o.asm=r,ce()}function r(e){t(e.instance)}function n(t){return(w||!c&&!f||"function"!=typeof fetch?new Promise((function(e,t){e(Ee())})):fetch(_e,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+_e+"'";return e.arrayBuffer()})).catch((function(){return Ee()}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){y("failed to asynchronously prepare wasm: "+e),fe(e)}))}if(de(),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(e){return y("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(w||"function"!=typeof WebAssembly.instantiateStreaming||pe(_e)||"function"!=typeof fetch)return n(r);fetch(_e,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(e){y("wasm streaming compile failed: "+e),y("falling back to ArrayBuffer instantiation"),n(r)}))}))}(),{}};Z.push({func:function(){Qe()}});var ve=239312;function we(e){return e}function be(e){return e.replace(/\b__Z[\w\d_]+/g,(function(e){var t=we(e);return e===t?e:t+" ["+e+"]"}))}function Ae(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function Se(){var e=Ae();return o.extraStackTrace&&(e+="\n"+o.extraStackTrace()),be(e)}var De={};function Te(e){return o.___errno_location&&(H[o.___errno_location()>>2]=e),e}var ke={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=ke.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=ke.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:function(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return ke.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return ke.normalize(e.join("/"))},join2:function(e,t){return ke.normalize(e+"/"+t)}},Re={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:xe.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return(t?"/":"")+(e=ke.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."},relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=Re.resolve(e).substr(1),t=Re.resolve(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),o=Math.min(n.length,i.length),s=o,a=0;a<o;a++)if(n[a]!==i[a]){s=a;break}var u=[];for(a=s;a<n.length;a++)u.push("..");return(u=u.concat(i.slice(s))).join("/")}},Oe={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Oe.ttys[e]={input:[],output:[],ops:t},xe.registerDevice(e,Oe.stream_ops)},stream_ops:{open:function(e){var t=Oe.ttys[e.node.rdev];if(!t)throw new xe.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,r,n,i){if(!e.tty||!e.tty.ops.get_char)throw new xe.ErrnoError(60);for(var o=0,s=0;s<n;s++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(e){throw new xe.ErrnoError(29)}if(void 0===a&&0===o)throw new xe.ErrnoError(6);if(null==a)break;o++,t[r+s]=a}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,r,n,i){if(!e.tty||!e.tty.ops.put_char)throw new xe.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,t[r+o])}catch(e){throw new xe.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=Ke(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(g(P(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(g(P(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(y(P(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(y(P(e.output,0)),e.output=[])}}},Me={ops_table:null,mount:function(e){return Me.createNode(null,"/",16895,0)},createNode:function(e,t,r,n){if(xe.isBlkdev(r)||xe.isFIFO(r))throw new xe.ErrnoError(63);Me.ops_table||(Me.ops_table={dir:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr,lookup:Me.node_ops.lookup,mknod:Me.node_ops.mknod,rename:Me.node_ops.rename,unlink:Me.node_ops.unlink,rmdir:Me.node_ops.rmdir,readdir:Me.node_ops.readdir,symlink:Me.node_ops.symlink},stream:{llseek:Me.stream_ops.llseek}},file:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr},stream:{llseek:Me.stream_ops.llseek,read:Me.stream_ops.read,write:Me.stream_ops.write,allocate:Me.stream_ops.allocate,mmap:Me.stream_ops.mmap,msync:Me.stream_ops.msync}},link:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr,readlink:Me.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr},stream:xe.chrdev_stream_ops}});var i=xe.createNode(e,t,r,n);return xe.isDir(i.mode)?(i.node_ops=Me.ops_table.dir.node,i.stream_ops=Me.ops_table.dir.stream,i.contents={}):xe.isFile(i.mode)?(i.node_ops=Me.ops_table.file.node,i.stream_ops=Me.ops_table.file.stream,i.usedBytes=0,i.contents=null):xe.isLink(i.mode)?(i.node_ops=Me.ops_table.link.node,i.stream_ops=Me.ops_table.link.stream):xe.isChrdev(i.mode)&&(i.node_ops=Me.ops_table.chrdev.node,i.stream_ops=Me.ops_table.chrdev.stream),i.timestamp=Date.now(),e&&(e.contents[t]=i),i},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],r=0;r<e.usedBytes;++r)t.push(e.contents[r]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)|0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var r=e.contents;return e.contents=new Uint8Array(new ArrayBuffer(t)),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=xe.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,xe.isDir(e.mode)?t.size=4096:xe.isFile(e.mode)?t.size=e.usedBytes:xe.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Me.resizeFileStorage(e,t.size)},lookup:function(e,t){throw xe.genericErrors[44]},mknod:function(e,t,r,n){return Me.createNode(e,t,r,n)},rename:function(e,t,r){if(xe.isDir(e.mode)){var n;try{n=xe.lookupNode(t,r)}catch(e){}if(n)for(var i in n.contents)throw new xe.ErrnoError(55)}delete e.parent.contents[e.name],e.name=r,t.contents[r]=e,e.parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var r=xe.lookupNode(e,t);for(var n in r.contents)throw new xe.ErrnoError(55);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var n=Me.createNode(e,t,41471,0);return n.link=r,n},readlink:function(e){if(!xe.isLink(e.mode))throw new xe.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,n,i){var o=e.node.contents;if(i>=e.node.usedBytes)return 0;var s=Math.min(e.node.usedBytes-i,n);if(s>8&&o.subarray)t.set(o.subarray(i,i+s),r);else for(var a=0;a<s;a++)t[r+a]=o[i+a];return s},write:function(e,t,r,n,i,o){if(!n)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(o)return s.contents=t.subarray(r,r+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===i)return s.contents=new Uint8Array(t.subarray(r,r+n)),s.usedBytes=n,n;if(i+n<=s.usedBytes)return s.contents.set(t.subarray(r,r+n),i),n}if(Me.expandFileStorage(s,i+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(r,r+n),i);else for(var a=0;a<n;a++)s.contents[i+a]=t[r+a];return s.usedBytes=Math.max(s.usedBytes,i+n),n},llseek:function(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&xe.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new xe.ErrnoError(28);return n},allocate:function(e,t,r){Me.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,n,i,o,s){if(!xe.isFile(e.node.mode))throw new xe.ErrnoError(43);var a,u,l=e.node.contents;if(2&s||l.buffer!==t&&l.buffer!==t.buffer){(i>0||i+n<e.node.usedBytes)&&(l=l.subarray?l.subarray(i,i+n):Array.prototype.slice.call(l,i,i+n)),u=!0;var d=t.buffer==z.buffer;if(!(a=it(n)))throw new xe.ErrnoError(48);(d?z:t).set(l,a)}else u=!1,a=l.byteOffset;return{ptr:a,allocated:u}},msync:function(e,t,r,n,i){if(!xe.isFile(e.node.mode))throw new xe.ErrnoError(43);if(2&i)return 0;Me.stream_ops.write(e,t,0,n,r,!1);return 0}}},Be={dbs:{},indexedDB:function(){if("undefined"!=typeof indexedDB)return indexedDB;var e=null;return"object"==typeof window&&(e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),R(e,"IDBFS used, but indexedDB not supported"),e},DB_VERSION:21,DB_STORE_NAME:"FILE_DATA",mount:function(e){return Me.mount.apply(null,arguments)},syncfs:function(e,t,r){Be.getLocalSet(e,(function(n,i){if(n)return r(n);Be.getRemoteSet(e,(function(e,n){if(e)return r(e);var o=t?n:i,s=t?i:n;Be.reconcile(o,s,r)}))}))},getDB:function(e,t){var r,n=Be.dbs[e];if(n)return t(null,n);try{r=Be.indexedDB().open(e,Be.DB_VERSION)}catch(e){return t(e)}if(!r)return t("Unable to connect to IndexedDB");r.onupgradeneeded=function(e){var t,r=e.target.result,n=e.target.transaction;(t=r.objectStoreNames.contains(Be.DB_STORE_NAME)?n.objectStore(Be.DB_STORE_NAME):r.createObjectStore(Be.DB_STORE_NAME)).indexNames.contains("timestamp")||t.createIndex("timestamp","timestamp",{unique:!1})},r.onsuccess=function(){n=r.result,Be.dbs[e]=n,t(null,n)},r.onerror=function(e){t(this.error),e.preventDefault()}},getLocalSet:function(e,t){var r={};function n(e){return"."!==e&&".."!==e}function i(e){return function(t){return ke.join2(e,t)}}for(var o=xe.readdir(e.mountpoint).filter(n).map(i(e.mountpoint));o.length;){var s,a=o.pop();try{s=xe.stat(a)}catch(e){return t(e)}xe.isDir(s.mode)&&o.push.apply(o,xe.readdir(a).filter(n).map(i(a))),r[a]={timestamp:s.mtime}}return t(null,{type:"local",entries:r})},getRemoteSet:function(e,t){var r={};Be.getDB(e.mountpoint,(function(e,n){if(e)return t(e);try{var i=n.transaction([Be.DB_STORE_NAME],"readonly");i.onerror=function(e){t(this.error),e.preventDefault()},i.objectStore(Be.DB_STORE_NAME).index("timestamp").openKeyCursor().onsuccess=function(e){var i=e.target.result;if(!i)return t(null,{type:"remote",db:n,entries:r});r[i.primaryKey]={timestamp:i.key},i.continue()}}catch(e){return t(e)}}))},loadLocalEntry:function(e,t){var r,n;try{n=xe.lookupPath(e).node,r=xe.stat(e)}catch(e){return t(e)}return xe.isDir(r.mode)?t(null,{timestamp:r.mtime,mode:r.mode}):xe.isFile(r.mode)?(n.contents=Me.getFileDataAsTypedArray(n),t(null,{timestamp:r.mtime,mode:r.mode,contents:n.contents})):t(new Error("node type not supported"))},storeLocalEntry:function(e,t,r){try{if(xe.isDir(t.mode))xe.mkdir(e,t.mode);else{if(!xe.isFile(t.mode))return r(new Error("node type not supported"));xe.writeFile(e,t.contents,{canOwn:!0})}xe.chmod(e,t.mode),xe.utime(e,t.timestamp,t.timestamp)}catch(e){return r(e)}r(null)},removeLocalEntry:function(e,t){try{xe.lookupPath(e);var r=xe.stat(e);xe.isDir(r.mode)?xe.rmdir(e):xe.isFile(r.mode)&&xe.unlink(e)}catch(e){return t(e)}t(null)},loadRemoteEntry:function(e,t,r){var n=e.get(t);n.onsuccess=function(e){r(null,e.target.result)},n.onerror=function(e){r(this.error),e.preventDefault()}},storeRemoteEntry:function(e,t,r,n){var i=e.put(r,t);i.onsuccess=function(){n(null)},i.onerror=function(e){n(this.error),e.preventDefault()}},removeRemoteEntry:function(e,t,r){var n=e.delete(t);n.onsuccess=function(){r(null)},n.onerror=function(e){r(this.error),e.preventDefault()}},reconcile:function(e,t,r){var n=0,i=[];Object.keys(e.entries).forEach((function(r){var o=e.entries[r],s=t.entries[r];(!s||o.timestamp>s.timestamp)&&(i.push(r),n++)}));var o=[];if(Object.keys(t.entries).forEach((function(r){t.entries[r];e.entries[r]||(o.push(r),n++)})),!n)return r(null);var s=!1,a=("remote"===e.type?e.db:t.db).transaction([Be.DB_STORE_NAME],"readwrite"),u=a.objectStore(Be.DB_STORE_NAME);function l(e){if(e&&!s)return s=!0,r(e)}a.onerror=function(e){l(this.error),e.preventDefault()},a.oncomplete=function(e){s||r(null)},i.sort().forEach((function(e){"local"===t.type?Be.loadRemoteEntry(u,e,(function(t,r){if(t)return l(t);Be.storeLocalEntry(e,r,l)})):Be.loadLocalEntry(e,(function(t,r){if(t)return l(t);Be.storeRemoteEntry(u,e,r,l)}))})),o.sort().reverse().forEach((function(e){"local"===t.type?Be.removeLocalEntry(e,l):Be.removeRemoteEntry(u,e,l)}))}},Ue={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},Le={isWindows:!1,staticInit:function(){Le.isWindows=!!t.platform.match(/^win/);var e=t.binding("constants");e.fs&&(e=e.fs),Le.flagsForNodeMap={1024:e.O_APPEND,64:e.O_CREAT,128:e.O_EXCL,0:e.O_RDONLY,2:e.O_RDWR,4096:e.O_SYNC,512:e.O_TRUNC,1:e.O_WRONLY}},bufferFrom:function(e){return r.alloc?r.from(e):new r(e)},convertNodeCode:function(e){var t=e.code;return R(t in Ue),Ue[t]},mount:function(e){return R(a),Le.createNode(null,"/",Le.getMode(e.opts.root),0)},createNode:function(e,t,r,n){if(!xe.isDir(r)&&!xe.isFile(r)&&!xe.isLink(r))throw new xe.ErrnoError(28);var i=xe.createNode(e,t,r);return i.node_ops=Le.node_ops,i.stream_ops=Le.stream_ops,i},getMode:function(e){var t;try{t=fs.lstatSync(e),Le.isWindows&&(t.mode=t.mode|(292&t.mode)>>2)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}return t.mode},realPath:function(e){for(var t=[];e.parent!==e;)t.push(e.name),e=e.parent;return t.push(e.mount.opts.root),t.reverse(),ke.join.apply(null,t)},flagsForNode:function(e){e&=-2097153,e&=-2049,e&=-32769,e&=-524289;var t=0;for(var r in Le.flagsForNodeMap)e&r&&(t|=Le.flagsForNodeMap[r],e^=r);if(e)throw new xe.ErrnoError(28);return t},node_ops:{getattr:function(e){var t,r=Le.realPath(e);try{t=fs.lstatSync(r)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}return Le.isWindows&&!t.blksize&&(t.blksize=4096),Le.isWindows&&!t.blocks&&(t.blocks=(t.size+t.blksize-1)/t.blksize|0),{dev:t.dev,ino:t.ino,mode:t.mode,nlink:t.nlink,uid:t.uid,gid:t.gid,rdev:t.rdev,size:t.size,atime:t.atime,mtime:t.mtime,ctime:t.ctime,blksize:t.blksize,blocks:t.blocks}},setattr:function(e,t){var r=Le.realPath(e);try{if(void 0!==t.mode&&(fs.chmodSync(r,t.mode),e.mode=t.mode),void 0!==t.timestamp){var n=new Date(t.timestamp);fs.utimesSync(r,n,n)}void 0!==t.size&&fs.truncateSync(r,t.size)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},lookup:function(e,t){var r=ke.join2(Le.realPath(e),t),n=Le.getMode(r);return Le.createNode(e,t,n)},mknod:function(e,t,r,n){var i=Le.createNode(e,t,r,n),o=Le.realPath(i);try{xe.isDir(i.mode)?fs.mkdirSync(o,i.mode):fs.writeFileSync(o,"",{mode:i.mode})}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}return i},rename:function(e,t,r){var n=Le.realPath(e),i=ke.join2(Le.realPath(t),r);try{fs.renameSync(n,i)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},unlink:function(e,t){var r=ke.join2(Le.realPath(e),t);try{fs.unlinkSync(r)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},rmdir:function(e,t){var r=ke.join2(Le.realPath(e),t);try{fs.rmdirSync(r)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},readdir:function(e){var t=Le.realPath(e);try{return fs.readdirSync(t)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},symlink:function(e,t,r){var n=ke.join2(Le.realPath(e),t);try{fs.symlinkSync(r,n)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},readlink:function(e){var t=Le.realPath(e);try{return t=fs.readlinkSync(t),t=NODEJS_PATH.relative(NODEJS_PATH.resolve(e.mount.opts.root),t)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}}},stream_ops:{open:function(e){var t=Le.realPath(e.node);try{xe.isFile(e.node.mode)&&(e.nfd=fs.openSync(t,Le.flagsForNode(e.flags)))}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},close:function(e){try{xe.isFile(e.node.mode)&&e.nfd&&fs.closeSync(e.nfd)}catch(e){if(!e.code)throw e;throw new xe.ErrnoError(Le.convertNodeCode(e))}},read:function(e,t,r,n,i){if(0===n)return 0;try{return fs.readSync(e.nfd,Le.bufferFrom(t.buffer),r,n,i)}catch(e){throw new xe.ErrnoError(Le.convertNodeCode(e))}},write:function(e,t,r,n,i){try{return fs.writeSync(e.nfd,Le.bufferFrom(t.buffer),r,n,i)}catch(e){throw new xe.ErrnoError(Le.convertNodeCode(e))}},llseek:function(e,t,r){var n=t;if(1===r)n+=e.position;else if(2===r&&xe.isFile(e.node.mode))try{n+=fs.fstatSync(e.nfd).size}catch(e){throw new xe.ErrnoError(Le.convertNodeCode(e))}if(n<0)throw new xe.ErrnoError(28);return n}}},Pe={DIR_MODE:16895,FILE_MODE:33279,reader:null,mount:function(e){R(f),Pe.reader||(Pe.reader=new FileReaderSync);var t=Pe.createNode(null,"/",Pe.DIR_MODE,0),r={};function n(e){for(var n=e.split("/"),i=t,o=0;o<n.length-1;o++){var s=n.slice(0,o+1).join("/");r[s]||(r[s]=Pe.createNode(i,n[o],Pe.DIR_MODE,0)),i=r[s]}return i}function i(e){var t=e.split("/");return t[t.length-1]}return Array.prototype.forEach.call(e.opts.files||[],(function(e){Pe.createNode(n(e.name),i(e.name),Pe.FILE_MODE,0,e,e.lastModifiedDate)})),(e.opts.blobs||[]).forEach((function(e){Pe.createNode(n(e.name),i(e.name),Pe.FILE_MODE,0,e.data)})),(e.opts.packages||[]).forEach((function(e){e.metadata.files.forEach((function(t){var r=t.filename.substr(1);Pe.createNode(n(r),i(r),Pe.FILE_MODE,0,e.blob.slice(t.start,t.end))}))})),t},createNode:function(e,t,r,n,i,o){var s=xe.createNode(e,t,r);return s.mode=r,s.node_ops=Pe.node_ops,s.stream_ops=Pe.stream_ops,s.timestamp=(o||new Date).getTime(),R(Pe.FILE_MODE!==Pe.DIR_MODE),r===Pe.FILE_MODE?(s.size=i.size,s.contents=i):(s.size=4096,s.contents={}),e&&(e.contents[t]=s),s},node_ops:{getattr:function(e){return{dev:1,ino:void 0,mode:e.mode,nlink:1,uid:0,gid:0,rdev:void 0,size:e.size,atime:new Date(e.timestamp),mtime:new Date(e.timestamp),ctime:new Date(e.timestamp),blksize:4096,blocks:Math.ceil(e.size/4096)}},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp)},lookup:function(e,t){throw new xe.ErrnoError(44)},mknod:function(e,t,r,n){throw new xe.ErrnoError(63)},rename:function(e,t,r){throw new xe.ErrnoError(63)},unlink:function(e,t){throw new xe.ErrnoError(63)},rmdir:function(e,t){throw new xe.ErrnoError(63)},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){throw new xe.ErrnoError(63)},readlink:function(e){throw new xe.ErrnoError(63)}},stream_ops:{read:function(e,t,r,n,i){if(i>=e.node.size)return 0;var o=e.node.contents.slice(i,i+n),s=Pe.reader.readAsArrayBuffer(o);return t.set(new Uint8Array(s),r),o.size},write:function(e,t,r,n,i){throw new xe.ErrnoError(29)},llseek:function(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&xe.isFile(e.node.mode)&&(n+=e.node.size),n<0)throw new xe.ErrnoError(28);return n}}},xe={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof xe.ErrnoError))throw e+" : "+Se();return Te(e.errno)},lookupPath:function(e,t){if(t=t||{},!(e=Re.resolve(xe.cwd(),e)))return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};for(var n in r)void 0===t[n]&&(t[n]=r[n]);if(t.recurse_count>8)throw new xe.ErrnoError(32);for(var i=ke.normalizeArray(e.split("/").filter((function(e){return!!e})),!1),o=xe.root,s="/",a=0;a<i.length;a++){var u=a===i.length-1;if(u&&t.parent)break;if(o=xe.lookupNode(o,i[a]),s=ke.join2(s,i[a]),xe.isMountpoint(o)&&(!u||u&&t.follow_mount)&&(o=o.mounted.root),!u||t.follow)for(var l=0;xe.isLink(o.mode);){var d=xe.readlink(s);if(s=Re.resolve(ke.dirname(s),d),o=xe.lookupPath(s,{recurse_count:t.recurse_count}).node,l++>40)throw new xe.ErrnoError(32)}}return{path:s,node:o}},getPath:function(e){for(var t;;){if(xe.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%xe.nameTable.length},hashAddNode:function(e){var t=xe.hashName(e.parent.id,e.name);e.name_next=xe.nameTable[t],xe.nameTable[t]=e},hashRemoveNode:function(e){var t=xe.hashName(e.parent.id,e.name);if(xe.nameTable[t]===e)xe.nameTable[t]=e.name_next;else for(var r=xe.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:function(e,t){var r=xe.mayLookup(e);if(r)throw new xe.ErrnoError(r,e);for(var n=xe.hashName(e.id,t),i=xe.nameTable[n];i;i=i.name_next){var o=i.name;if(i.parent.id===e.id&&o===t)return i}return xe.lookup(e,t)},createNode:function(e,t,r,n){if(!xe.FSNode){xe.FSNode=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=xe.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n},xe.FSNode.prototype={};Object.defineProperties(xe.FSNode.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return xe.isDir(this.mode)}},isDevice:{get:function(){return xe.isChrdev(this.mode)}}})}var i=new xe.FSNode(e,t,r,n);return xe.hashAddNode(i),i},destroyNode:function(e){xe.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=xe.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return xe.ignorePermissions?0:(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){var t=xe.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{xe.lookupNode(e,t);return 20}catch(e){}return xe.nodePermissions(e,"wx")},mayDelete:function(e,t,r){var n;try{n=xe.lookupNode(e,t)}catch(e){return e.errno}var i=xe.nodePermissions(e,"wx");if(i)return i;if(r){if(!xe.isDir(n.mode))return 54;if(xe.isRoot(n)||xe.getPath(n)===xe.cwd())return 10}else if(xe.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?xe.isLink(e.mode)?32:xe.isDir(e.mode)&&("r"!==xe.flagsToPermissionString(t)||512&t)?31:xe.nodePermissions(e,xe.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||xe.MAX_OPEN_FDS;for(var r=e;r<=t;r++)if(!xe.streams[r])return r;throw new xe.ErrnoError(33)},getStream:function(e){return xe.streams[e]},createStream:function(e,t,r){xe.FSStream||(xe.FSStream=function(){},xe.FSStream.prototype={},Object.defineProperties(xe.FSStream.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}}));var n=new xe.FSStream;for(var i in e)n[i]=e[i];e=n;var o=xe.nextfd(t,r);return e.fd=o,xe.streams[o]=e,e},closeStream:function(e){xe.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=xe.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new xe.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){xe.devices[e]={stream_ops:t}},getDevice:function(e){return xe.devices[e]},getMounts:function(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs:function(e,t){"function"==typeof e&&(t=e,e=!1),xe.syncFSRequests++,xe.syncFSRequests>1&&console.log("warning: "+xe.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=xe.getMounts(xe.root.mount),n=0;function i(e){return xe.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,i(e));++n>=r.length&&i(null)}r.forEach((function(t){if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:function(e,t,r){var n,i="/"===r,o=!r;if(i&&xe.root)throw new xe.ErrnoError(10);if(!i&&!o){var s=xe.lookupPath(r,{follow_mount:!1});if(r=s.path,n=s.node,xe.isMountpoint(n))throw new xe.ErrnoError(10);if(!xe.isDir(n.mode))throw new xe.ErrnoError(54)}var a={type:e,opts:t,mountpoint:r,mounts:[]},u=e.mount(a);return u.mount=a,a.root=u,i?xe.root=u:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),u},unmount:function(e){var t=xe.lookupPath(e,{follow_mount:!1});if(!xe.isMountpoint(t.node))throw new xe.ErrnoError(28);var r=t.node,n=r.mounted,i=xe.getMounts(n);Object.keys(xe.nameTable).forEach((function(e){for(var t=xe.nameTable[e];t;){var r=t.name_next;-1!==i.indexOf(t.mount)&&xe.destroyNode(t),t=r}})),r.mounted=null;var o=r.mount.mounts.indexOf(n);r.mount.mounts.splice(o,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,r){var n=xe.lookupPath(e,{parent:!0}).node,i=ke.basename(e);if(!i||"."===i||".."===i)throw new xe.ErrnoError(28);var o=xe.mayCreate(n,i);if(o)throw new xe.ErrnoError(o);if(!n.node_ops.mknod)throw new xe.ErrnoError(63);return n.node_ops.mknod(n,i,t,r)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,xe.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,xe.mknod(e,t,0)},mkdirTree:function(e,t){for(var r=e.split("/"),n="",i=0;i<r.length;++i)if(r[i]){n+="/"+r[i];try{xe.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:function(e,t,r){return void 0===r&&(r=t,t=438),t|=8192,xe.mknod(e,t,r)},symlink:function(e,t){if(!Re.resolve(e))throw new xe.ErrnoError(44);var r=xe.lookupPath(t,{parent:!0}).node;if(!r)throw new xe.ErrnoError(44);var n=ke.basename(t),i=xe.mayCreate(r,n);if(i)throw new xe.ErrnoError(i);if(!r.node_ops.symlink)throw new xe.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename:function(e,t){var r,n,i=ke.dirname(e),o=ke.dirname(t),s=ke.basename(e),a=ke.basename(t);try{r=xe.lookupPath(e,{parent:!0}).node,n=xe.lookupPath(t,{parent:!0}).node}catch(e){throw new xe.ErrnoError(10)}if(!r||!n)throw new xe.ErrnoError(44);if(r.mount!==n.mount)throw new xe.ErrnoError(75);var u,l=xe.lookupNode(r,s),d=Re.relative(e,o);if("."!==d.charAt(0))throw new xe.ErrnoError(28);if("."!==(d=Re.relative(t,i)).charAt(0))throw new xe.ErrnoError(55);try{u=xe.lookupNode(n,a)}catch(e){}if(l!==u){var c=xe.isDir(l.mode),f=xe.mayDelete(r,s,c);if(f)throw new xe.ErrnoError(f);if(f=u?xe.mayDelete(n,a,c):xe.mayCreate(n,a))throw new xe.ErrnoError(f);if(!r.node_ops.rename)throw new xe.ErrnoError(63);if(xe.isMountpoint(l)||u&&xe.isMountpoint(u))throw new xe.ErrnoError(10);if(n!==r&&(f=xe.nodePermissions(r,"w")))throw new xe.ErrnoError(f);try{xe.trackingDelegate.willMovePath&&xe.trackingDelegate.willMovePath(e,t)}catch(r){console.log("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+r.message)}xe.hashRemoveNode(l);try{r.node_ops.rename(l,n,a)}catch(e){throw e}finally{xe.hashAddNode(l)}try{xe.trackingDelegate.onMovePath&&xe.trackingDelegate.onMovePath(e,t)}catch(r){console.log("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+r.message)}}},rmdir:function(e){var t=xe.lookupPath(e,{parent:!0}).node,r=ke.basename(e),n=xe.lookupNode(t,r),i=xe.mayDelete(t,r,!0);if(i)throw new xe.ErrnoError(i);if(!t.node_ops.rmdir)throw new xe.ErrnoError(63);if(xe.isMountpoint(n))throw new xe.ErrnoError(10);try{xe.trackingDelegate.willDeletePath&&xe.trackingDelegate.willDeletePath(e)}catch(t){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.rmdir(t,r),xe.destroyNode(n);try{xe.trackingDelegate.onDeletePath&&xe.trackingDelegate.onDeletePath(e)}catch(t){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readdir:function(e){var t=xe.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new xe.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=xe.lookupPath(e,{parent:!0}).node,r=ke.basename(e),n=xe.lookupNode(t,r),i=xe.mayDelete(t,r,!1);if(i)throw new xe.ErrnoError(i);if(!t.node_ops.unlink)throw new xe.ErrnoError(63);if(xe.isMountpoint(n))throw new xe.ErrnoError(10);try{xe.trackingDelegate.willDeletePath&&xe.trackingDelegate.willDeletePath(e)}catch(t){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.unlink(t,r),xe.destroyNode(n);try{xe.trackingDelegate.onDeletePath&&xe.trackingDelegate.onDeletePath(e)}catch(t){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readlink:function(e){var t=xe.lookupPath(e).node;if(!t)throw new xe.ErrnoError(44);if(!t.node_ops.readlink)throw new xe.ErrnoError(28);return Re.resolve(xe.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var r=xe.lookupPath(e,{follow:!t}).node;if(!r)throw new xe.ErrnoError(44);if(!r.node_ops.getattr)throw new xe.ErrnoError(63);return r.node_ops.getattr(r)},lstat:function(e){return xe.stat(e,!0)},chmod:function(e,t,r){var n;"string"==typeof e?n=xe.lookupPath(e,{follow:!r}).node:n=e;if(!n.node_ops.setattr)throw new xe.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,t){xe.chmod(e,t,!0)},fchmod:function(e,t){var r=xe.getStream(e);if(!r)throw new xe.ErrnoError(8);xe.chmod(r.node,t)},chown:function(e,t,r,n){var i;"string"==typeof e?i=xe.lookupPath(e,{follow:!n}).node:i=e;if(!i.node_ops.setattr)throw new xe.ErrnoError(63);i.node_ops.setattr(i,{timestamp:Date.now()})},lchown:function(e,t,r){xe.chown(e,t,r,!0)},fchown:function(e,t,r){var n=xe.getStream(e);if(!n)throw new xe.ErrnoError(8);xe.chown(n.node,t,r)},truncate:function(e,t){if(t<0)throw new xe.ErrnoError(28);var r;"string"==typeof e?r=xe.lookupPath(e,{follow:!0}).node:r=e;if(!r.node_ops.setattr)throw new xe.ErrnoError(63);if(xe.isDir(r.mode))throw new xe.ErrnoError(31);if(!xe.isFile(r.mode))throw new xe.ErrnoError(28);var n=xe.nodePermissions(r,"w");if(n)throw new xe.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var r=xe.getStream(e);if(!r)throw new xe.ErrnoError(8);if(0==(2097155&r.flags))throw new xe.ErrnoError(28);xe.truncate(r.node,t)},utime:function(e,t,r){var n=xe.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open:function(e,t,r,n,i){if(""===e)throw new xe.ErrnoError(44);var s;if(r=void 0===r?438:r,r=64&(t="string"==typeof t?xe.modeStringToFlags(t):t)?4095&r|32768:0,"object"==typeof e)s=e;else{e=ke.normalize(e);try{s=xe.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var a=!1;if(64&t)if(s){if(128&t)throw new xe.ErrnoError(20)}else s=xe.mknod(e,r,0),a=!0;if(!s)throw new xe.ErrnoError(44);if(xe.isChrdev(s.mode)&&(t&=-513),65536&t&&!xe.isDir(s.mode))throw new xe.ErrnoError(54);if(!a){var u=xe.mayOpen(s,t);if(u)throw new xe.ErrnoError(u)}512&t&&xe.truncate(s,0),t&=-641;var l=xe.createStream({node:s,path:xe.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1},n,i);l.stream_ops.open&&l.stream_ops.open(l),!o.logReadFiles||1&t||(xe.readFiles||(xe.readFiles={}),e in xe.readFiles||(xe.readFiles[e]=1,console.log("FS.trackingDelegate error on read file: "+e)));try{if(xe.trackingDelegate.onOpenFile){var d=0;1!=(2097155&t)&&(d|=xe.tracking.openFlags.READ),0!=(2097155&t)&&(d|=xe.tracking.openFlags.WRITE),xe.trackingDelegate.onOpenFile(e,d)}}catch(t){console.log("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+t.message)}return l},close:function(e){if(xe.isClosed(e))throw new xe.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{xe.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,r){if(xe.isClosed(e))throw new xe.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new xe.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new xe.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:function(e,t,r,n,i){if(n<0||i<0)throw new xe.ErrnoError(28);if(xe.isClosed(e))throw new xe.ErrnoError(8);if(1==(2097155&e.flags))throw new xe.ErrnoError(8);if(xe.isDir(e.node.mode))throw new xe.ErrnoError(31);if(!e.stream_ops.read)throw new xe.ErrnoError(28);var o=void 0!==i;if(o){if(!e.seekable)throw new xe.ErrnoError(70)}else i=e.position;var s=e.stream_ops.read(e,t,r,n,i);return o||(e.position+=s),s},write:function(e,t,r,n,i,o){if(n<0||i<0)throw new xe.ErrnoError(28);if(xe.isClosed(e))throw new xe.ErrnoError(8);if(0==(2097155&e.flags))throw new xe.ErrnoError(8);if(xe.isDir(e.node.mode))throw new xe.ErrnoError(31);if(!e.stream_ops.write)throw new xe.ErrnoError(28);1024&e.flags&&xe.llseek(e,0,2);var s=void 0!==i;if(s){if(!e.seekable)throw new xe.ErrnoError(70)}else i=e.position;var a=e.stream_ops.write(e,t,r,n,i,o);s||(e.position+=a);try{e.path&&xe.trackingDelegate.onWriteToFile&&xe.trackingDelegate.onWriteToFile(e.path)}catch(t){console.log("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+t.message)}return a},allocate:function(e,t,r){if(xe.isClosed(e))throw new xe.ErrnoError(8);if(t<0||r<=0)throw new xe.ErrnoError(28);if(0==(2097155&e.flags))throw new xe.ErrnoError(8);if(!xe.isFile(e.node.mode)&&!xe.isDir(e.node.mode))throw new xe.ErrnoError(43);if(!e.stream_ops.allocate)throw new xe.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:function(e,t,r,n,i,o,s){if(0!=(2&o)&&0==(2&s)&&2!=(2097155&e.flags))throw new xe.ErrnoError(2);if(1==(2097155&e.flags))throw new xe.ErrnoError(2);if(!e.stream_ops.mmap)throw new xe.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,i,o,s)},msync:function(e,t,r,n,i){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,i):0},munmap:function(e){return 0},ioctl:function(e,t,r){if(!e.stream_ops.ioctl)throw new xe.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:function(e,t){if((t=t||{}).flags=t.flags||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var r,n=xe.open(e,t.flags),i=xe.stat(e).size,o=new Uint8Array(i);return xe.read(n,o,0,i,0),"utf8"===t.encoding?r=P(o,0):"binary"===t.encoding&&(r=o),xe.close(n),r},writeFile:function(e,t,r){(r=r||{}).flags=r.flags||"w";var n=xe.open(e,r.flags,r.mode);if("string"==typeof t){var i=new Uint8Array(I(t)+1),o=C(t,i,0,i.length);xe.write(n,i,0,o,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");xe.write(n,t,0,t.byteLength,void 0,r.canOwn)}xe.close(n)},cwd:function(){return xe.currentPath},chdir:function(e){var t=xe.lookupPath(e,{follow:!0});if(null===t.node)throw new xe.ErrnoError(44);if(!xe.isDir(t.node.mode))throw new xe.ErrnoError(54);var r=xe.nodePermissions(t.node,"x");if(r)throw new xe.ErrnoError(r);xe.currentPath=t.path},createDefaultDirectories:function(){xe.mkdir("/tmp"),xe.mkdir("/home"),xe.mkdir("/home/web_user")},createDefaultDevices:function(){var e;if(xe.mkdir("/dev"),xe.registerDevice(xe.makedev(1,3),{read:function(){return 0},write:function(e,t,r,n,i){return n}}),xe.mkdev("/dev/null",xe.makedev(1,3)),Oe.register(xe.makedev(5,0),Oe.default_tty_ops),Oe.register(xe.makedev(6,0),Oe.default_tty1_ops),xe.mkdev("/dev/tty",xe.makedev(5,0)),xe.mkdev("/dev/tty1",xe.makedev(6,0)),"object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}e||(e=function(){fe("random_device")}),xe.createDevice("/dev","random",e),xe.createDevice("/dev","urandom",e),xe.mkdir("/dev/shm"),xe.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){xe.mkdir("/proc"),xe.mkdir("/proc/self"),xe.mkdir("/proc/self/fd"),xe.mount({mount:function(){var e=xe.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var r=+t,n=xe.getStream(r);if(!n)throw new xe.ErrnoError(8);var i={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return i.parent=i,i}},e}},{},"/proc/self/fd")},createStandardStreams:function(){o.stdin?xe.createDevice("/dev","stdin",o.stdin):xe.symlink("/dev/tty","/dev/stdin"),o.stdout?xe.createDevice("/dev","stdout",null,o.stdout):xe.symlink("/dev/tty","/dev/stdout"),o.stderr?xe.createDevice("/dev","stderr",null,o.stderr):xe.symlink("/dev/tty1","/dev/stderr");xe.open("/dev/stdin","r"),xe.open("/dev/stdout","w"),xe.open("/dev/stderr","w")},ensureErrnoError:function(){xe.ErrnoError||(xe.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},xe.ErrnoError.prototype=new Error,xe.ErrnoError.prototype.constructor=xe.ErrnoError,[44].forEach((function(e){xe.genericErrors[e]=new xe.ErrnoError(e),xe.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){xe.ensureErrnoError(),xe.nameTable=new Array(4096),xe.mount(Me,{},"/"),xe.createDefaultDirectories(),xe.createDefaultDevices(),xe.createSpecialDirectories(),xe.filesystems={MEMFS:Me,IDBFS:Be,NODEFS:Le,WORKERFS:Pe}},init:function(e,t,r){xe.init.initialized=!0,xe.ensureErrnoError(),o.stdin=e||o.stdin,o.stdout=t||o.stdout,o.stderr=r||o.stderr,xe.createStandardStreams()},quit:function(){xe.init.initialized=!1;var e=o._fflush;e&&e(0);for(var t=0;t<xe.streams.length;t++){var r=xe.streams[t];r&&xe.close(r)}},getMode:function(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r},joinPath:function(e,t){var r=ke.join.apply(null,e);return t&&"/"==r[0]&&(r=r.substr(1)),r},absolutePath:function(e,t){return Re.resolve(t,e)},standardizePath:function(e){return ke.normalize(e)},findObject:function(e,t){var r=xe.analyzePath(e,t);return r.exists?r.object:(Te(r.error),null)},analyzePath:function(e,t){try{e=(n=xe.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=xe.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=ke.basename(e),n=xe.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(e){r.error=e.errno}return r},createFolder:function(e,t,r,n){var i=ke.join2("string"==typeof e?e:xe.getPath(e),t),o=xe.getMode(r,n);return xe.mkdir(i,o)},createPath:function(e,t,r,n){e="string"==typeof e?e:xe.getPath(e);for(var i=t.split("/").reverse();i.length;){var o=i.pop();if(o){var s=ke.join2(e,o);try{xe.mkdir(s)}catch(e){}e=s}}return s},createFile:function(e,t,r,n,i){var o=ke.join2("string"==typeof e?e:xe.getPath(e),t),s=xe.getMode(n,i);return xe.create(o,s)},createDataFile:function(e,t,r,n,i,o){var s=t?ke.join2("string"==typeof e?e:xe.getPath(e),t):e,a=xe.getMode(n,i),u=xe.create(s,a);if(r){if("string"==typeof r){for(var l=new Array(r.length),d=0,c=r.length;d<c;++d)l[d]=r.charCodeAt(d);r=l}xe.chmod(u,146|a);var f=xe.open(u,"w");xe.write(f,r,0,r.length,0,o),xe.close(f),xe.chmod(u,a)}return u},createDevice:function(e,t,r,n){var i=ke.join2("string"==typeof e?e:xe.getPath(e),t),o=xe.getMode(!!r,!!n);xe.createDevice.major||(xe.createDevice.major=64);var s=xe.makedev(xe.createDevice.major++,0);return xe.registerDevice(s,{open:function(e){e.seekable=!1},close:function(e){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,t,n,i,o){for(var s=0,a=0;a<i;a++){var u;try{u=r()}catch(e){throw new xe.ErrnoError(29)}if(void 0===u&&0===s)throw new xe.ErrnoError(6);if(null==u)break;s++,t[n+a]=u}return s&&(e.node.timestamp=Date.now()),s},write:function(e,t,r,i,o){for(var s=0;s<i;s++)try{n(t[r+s])}catch(e){throw new xe.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),s}}),xe.mkdev(i,o,s)},createLink:function(e,t,r,n,i){var o=ke.join2("string"==typeof e?e:xe.getPath(e),t);return xe.symlink(r,o)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!h)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=Ke(h(e.url),!0),e.usedBytes=e.contents.length}catch(e){t=!1}return t||Te(29),t},createLazyFile:function(e,t,r,n,i){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),i=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;i||(s=n);var a=this;a.setDataGetter((function(e){var t=e*s,i=(e+1)*s-1;if(i=Math.min(i,n-1),void 0===a.chunks[e]&&(a.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var i=new XMLHttpRequest;if(i.open("GET",r,!1),n!==s&&i.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(i.responseType="arraybuffer"),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.send(null),!(i.status>=200&&i.status<300||304===i.status))throw new Error("Couldn't load "+r+". Status: "+i.status);return void 0!==i.response?new Uint8Array(i.response||[]):Ke(i.responseText||"",!0)}(t,i)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!o&&n||(s=n=1,n=this.getter(0).length,s=n,console.log("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!f)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new o;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:s}}else a={isDevice:!1,url:r};var u=xe.createFile(e,t,a,n,i);a.contents?u.contents=a.contents:a.url&&(u.contents=null,u.url=a.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var l={};return Object.keys(u.stream_ops).forEach((function(e){var t=u.stream_ops[e];l[e]=function(){if(!xe.forceLoadFile(u))throw new xe.ErrnoError(29);return t.apply(null,arguments)}})),l.read=function(e,t,r,n,i){if(!xe.forceLoadFile(u))throw new xe.ErrnoError(29);var o=e.node.contents;if(i>=o.length)return 0;var s=Math.min(o.length-i,n);if(o.slice)for(var a=0;a<s;a++)t[r+a]=o[i+a];else for(a=0;a<s;a++)t[r+a]=o.get(i+a);return s},u.stream_ops=l,u},createPreloadedFile:function(e,t,r,n,i,s,a,u,l,d){Browser.init();var c=t?Re.resolve(ke.join2(e,t)):e;function f(r){function f(r){d&&d(),u||xe.createDataFile(e,t,r,n,i,l),s&&s(),ce()}var h=!1;o.preloadPlugins.forEach((function(e){h||e.canHandle(c)&&(e.handle(r,c,f,(function(){a&&a(),ce()})),h=!0)})),h||f(r)}de(),"string"==typeof r?Browser.asyncLoad(r,(function(e){f(e)}),a):f(r)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,r){t=t||function(){},r=r||function(){};var n=xe.indexedDB();try{var i=n.open(xe.DB_NAME(),xe.DB_VERSION)}catch(e){return r(e)}i.onupgradeneeded=function(){console.log("creating db"),i.result.createObjectStore(xe.DB_STORE_NAME)},i.onsuccess=function(){var n=i.result.transaction([xe.DB_STORE_NAME],"readwrite"),o=n.objectStore(xe.DB_STORE_NAME),s=0,a=0,u=e.length;function l(){0==a?t():r()}e.forEach((function(e){var t=o.put(xe.analyzePath(e).object.contents,e);t.onsuccess=function(){++s+a==u&&l()},t.onerror=function(){s+ ++a==u&&l()}})),n.onerror=r},i.onerror=r},loadFilesFromDB:function(e,t,r){t=t||function(){},r=r||function(){};var n=xe.indexedDB();try{var i=n.open(xe.DB_NAME(),xe.DB_VERSION)}catch(e){return r(e)}i.onupgradeneeded=r,i.onsuccess=function(){var n=i.result;try{var o=n.transaction([xe.DB_STORE_NAME],"readonly")}catch(e){return void r(e)}var s=o.objectStore(xe.DB_STORE_NAME),a=0,u=0,l=e.length;function d(){0==u?t():r()}e.forEach((function(e){var t=s.get(e);t.onsuccess=function(){xe.analyzePath(e).exists&&xe.unlink(e),xe.createDataFile(ke.dirname(e),ke.basename(e),t.result,!0,!0,!0),++a+u==l&&d()},t.onerror=function(){a+ ++u==l&&d()}})),o.onerror=r},i.onerror=r}},Ce={DEFAULT_POLLMASK:5,mappings:{},umask:511,calculateAt:function(e,t){if("/"!==t[0]){var r;if(-100===e)r=xe.cwd();else{var n=xe.getStream(e);if(!n)throw new xe.ErrnoError(8);r=n.path}t=ke.join2(r,t)}return t},doStat:function(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&ke.normalize(t)!==ke.normalize(xe.getPath(e.node)))return-54;throw e}return H[r>>2]=n.dev,H[r+4>>2]=0,H[r+8>>2]=n.ino,H[r+12>>2]=n.mode,H[r+16>>2]=n.nlink,H[r+20>>2]=n.uid,H[r+24>>2]=n.gid,H[r+28>>2]=n.rdev,H[r+32>>2]=0,ye=[n.size>>>0,(ge=n.size,+re(ge)>=1?ge>0?(0|oe(+ie(ge/4294967296),4294967295))>>>0:~~+ne((ge-+(~~ge>>>0))/4294967296)>>>0:0)],H[r+40>>2]=ye[0],H[r+44>>2]=ye[1],H[r+48>>2]=4096,H[r+52>>2]=n.blocks,H[r+56>>2]=n.atime.getTime()/1e3|0,H[r+60>>2]=0,H[r+64>>2]=n.mtime.getTime()/1e3|0,H[r+68>>2]=0,H[r+72>>2]=n.ctime.getTime()/1e3|0,H[r+76>>2]=0,ye=[n.ino>>>0,(ge=n.ino,+re(ge)>=1?ge>0?(0|oe(+ie(ge/4294967296),4294967295))>>>0:~~+ne((ge-+(~~ge>>>0))/4294967296)>>>0:0)],H[r+80>>2]=ye[0],H[r+84>>2]=ye[1],0},doMsync:function(e,t,r,n){var i=new Uint8Array(V.subarray(e,e+r));xe.msync(t,i,0,r,n)},doMkdir:function(e,t){return"/"===(e=ke.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),xe.mkdir(e,t,0),0},doMknod:function(e,t,r){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return xe.mknod(e,t,r),0},doReadlink:function(e,t,r){if(r<=0)return-28;var n=xe.readlink(e),i=Math.min(r,I(n)),o=z[t+i];return N(n,t,r+1),z[t+i]=o,i},doAccess:function(e,t){if(-8&t)return-28;var r;if(!(r=xe.lookupPath(e,{follow:!0}).node))return-44;var n="";return 4&t&&(n+="r"),2&t&&(n+="w"),1&t&&(n+="x"),n&&xe.nodePermissions(r,n)?-2:0},doDup:function(e,t,r){var n=xe.getStream(r);return n&&xe.close(n),xe.open(e,t,0,r,r).fd},doReadv:function(e,t,r,n){for(var i=0,o=0;o<r;o++){var s=H[t+8*o>>2],a=H[t+(8*o+4)>>2],u=xe.read(e,z,s,a,n);if(u<0)return-1;if(i+=u,u<a)break}return i},doWritev:function(e,t,r,n){for(var i=0,o=0;o<r;o++){var s=H[t+8*o>>2],a=H[t+(8*o+4)>>2],u=xe.write(e,z,s,a,n);if(u<0)return-1;i+=u}return i},varargs:0,get:function(e){return Ce.varargs+=4,H[Ce.varargs-4>>2]},getStr:function(){return x(Ce.get())},getStreamFromFD:function(e){void 0===e&&(e=Ce.get());var t=xe.getStream(e);if(!t)throw new xe.ErrnoError(8);return t},get64:function(){var e=Ce.get();Ce.get();return e},getZero:function(){Ce.get()}};function Ne(e){try{var t=Ce.getStreamFromFD(e);return xe.close(t),0}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),e.errno}}function Ie(e,t){try{var r=Ce.getStreamFromFD(e),n=r.tty?2:xe.isDir(r.mode)?3:xe.isLink(r.mode)?7:4;return z[t>>0]=n,0}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),e.errno}}function Fe(e,t,r,n,i){try{var o=Ce.getStreamFromFD(e),s=4294967296*r+(t>>>0);return s<=-9007199254740992||s>=9007199254740992?-61:(xe.llseek(o,s,n),ye=[o.position>>>0,(ge=o.position,+re(ge)>=1?ge>0?(0|oe(+ie(ge/4294967296),4294967295))>>>0:~~+ne((ge-+(~~ge>>>0))/4294967296)>>>0:0)],H[i>>2]=ye[0],H[i+4>>2]=ye[1],o.getdents&&0===s&&0===n&&(o.getdents=null),0)}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),e.errno}}function je(e,t,r,n){try{var i=Ce.getStreamFromFD(e),o=Ce.doWritev(i,t,r);return H[n>>2]=o,0}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),e.errno}}function ze(e,t,r){i(e,t,r)}function Ve(){return z.length}function Ge(e){fe("OOM")}o._broadwayOnPictureDecoded=ze;var He=re;var Xe=(N("GMT",239216,4),239216);function We(e){return Math.pow(2,e)}var Ye=se;function qe(){if(!qe.called){qe.called=!0,H[tt()>>2]=60*(new Date).getTimezoneOffset();var e=(new Date).getFullYear(),t=new Date(e,0,1),r=new Date(e,6,1);H[et()>>2]=Number(t.getTimezoneOffset()!=r.getTimezoneOffset());var n=a(t),i=a(r),o=B(Ke(n),"i8",O),s=B(Ke(i),"i8",O);r.getTimezoneOffset()<t.getTimezoneOffset()?(H[rt()>>2]=o,H[rt()+4>>2]=s):(H[rt()>>2]=s,H[rt()+4>>2]=o)}function a(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}}xe.staticInit();function Ke(e,t,r){var n=r>0?r:I(e)+1,i=new Array(n),o=C(e,i,0,i.length);return t&&(i.length=o),i}var $e={___buildEnvironment:function e(t){var r,n;e.called?(n=H[t>>2],r=H[n>>2]):(e.called=!0,De.USER="web_user",De.LOGNAME="web_user",De.PATH="/",De.PWD="/",De.HOME="/home/web_user",De.LANG=("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",De._=l,r=U(1024),n=U(256),H[n>>2]=r,H[t>>2]=n);var i=[],o=0;for(var s in De)if("string"==typeof De[s]){var a=s+"="+De[s];i.push(a),o+=a.length}if(o>1024)throw new Error("Environment size exceeded TOTAL_ENV_SIZE!");for(var u=0;u<i.length;u++){F(a=i[u],r),H[n+4*u>>2]=r,r+=a.length+1}H[n+4*i.length>>2]=0},___setErrNo:Te,___syscall221:function(e,t){Ce.varargs=t;try{var r=Ce.getStreamFromFD();switch(Ce.get()){case 0:return(n=Ce.get())<0?-28:xe.open(r.path,r.flags,0,n).fd;case 1:case 2:return 0;case 3:return r.flags;case 4:var n=Ce.get();return r.flags|=n,0;case 12:n=Ce.get();return G[n+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return Te(28),-1;default:return-28}}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),-e.errno}},___syscall3:function(e,t){Ce.varargs=t;try{var r=Ce.getStreamFromFD(),n=Ce.get(),i=Ce.get();return xe.read(r,z,n,i)}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),-e.errno}},___syscall5:function(e,t){Ce.varargs=t;try{var r=Ce.getStr(),n=Ce.get(),i=Ce.get();return xe.open(r,n,i).fd}catch(e){return void 0!==xe&&e instanceof xe.ErrnoError||fe(e),-e.errno}},___wasi_fd_close:function(){return Ne.apply(null,arguments)},___wasi_fd_fdstat_get:function(){return Ie.apply(null,arguments)},___wasi_fd_seek:function(){return Fe.apply(null,arguments)},___wasi_fd_write:function(){return je.apply(null,arguments)},__memory_base:1024,__table_base:0,_abort:function(){fe()},_broadwayOnBroadwayInited:function(){e()},_broadwayOnPictureDecoded:ze,_clock:function e(){return void 0===e.start&&(e.start=Date.now()),1e3*(Date.now()-e.start)|0},_emscripten_get_heap_size:Ve,_emscripten_memcpy_big:function(e,t,r){V.set(V.subarray(t,t+r),e)},_emscripten_resize_heap:function(e){Ge()},_exit:function(e){!function(e,t){if(t&&b&&0===e)return;b||(k=!0,e,!0,o.onExit&&o.onExit(e));d(e,new st(e))}(e)},_fabs:He,_fd_close:Ne,_fd_fdstat_get:Ie,_fd_seek:Fe,_fd_write:je,_getenv:function e(t){return 0===t?0:(t=x(t),De.hasOwnProperty(t)?(e.ret&&nt(e.ret),e.ret=(r=De[t],n=I(r)+1,(i=it(n))&&C(r,z,i,n),i),e.ret):0);var r,n,i},_gettimeofday:function(e){var t=Date.now();return H[e>>2]=t/1e3|0,H[e+4>>2]=t%1e3*1e3|0,0},_gmtime_r:function(e,t){var r=new Date(1e3*H[e>>2]);H[t>>2]=r.getUTCSeconds(),H[t+4>>2]=r.getUTCMinutes(),H[t+8>>2]=r.getUTCHours(),H[t+12>>2]=r.getUTCDate(),H[t+16>>2]=r.getUTCMonth(),H[t+20>>2]=r.getUTCFullYear()-1900,H[t+24>>2]=r.getUTCDay(),H[t+36>>2]=0,H[t+32>>2]=0;var n=Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0),i=(r.getTime()-n)/864e5|0;return H[t+28>>2]=i,H[t+40>>2]=Xe,t},_llvm_exp2_f32:We,_llvm_exp2_f64:function(e){return We(e)},_llvm_trunc_f64:Ye,_localtime_r:function(e,t){qe();var r=new Date(1e3*H[e>>2]);H[t>>2]=r.getSeconds(),H[t+4>>2]=r.getMinutes(),H[t+8>>2]=r.getHours(),H[t+12>>2]=r.getDate(),H[t+16>>2]=r.getMonth(),H[t+20>>2]=r.getFullYear()-1900,H[t+24>>2]=r.getDay();var n=new Date(r.getFullYear(),0,1),i=(r.getTime()-n.getTime())/864e5|0;H[t+28>>2]=i,H[t+36>>2]=-60*r.getTimezoneOffset();var o=new Date(r.getFullYear(),6,1).getTimezoneOffset(),s=n.getTimezoneOffset(),a=0|(o!=s&&r.getTimezoneOffset()==Math.min(s,o));H[t+32>>2]=a;var u=H[rt()+(a?4:0)>>2];return H[t+40>>2]=u,t},_mktime:function(e){qe();var t=new Date(H[e+20>>2]+1900,H[e+16>>2],H[e+12>>2],H[e+8>>2],H[e+4>>2],H[e>>2],0),r=H[e+32>>2],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=i.getTimezoneOffset(),a=Math.min(s,o);if(r<0)H[e+32>>2]=Number(o!=s&&a==n);else if(r>0!=(a==n)){var u=Math.max(s,o),l=r>0?a:u;t.setTime(t.getTime()+6e4*(l-n))}H[e+24>>2]=t.getDay();var d=(t.getTime()-i.getTime())/864e5|0;return H[e+28>>2]=d,t.getTime()/1e3|0},_tzset:qe,abort:fe,abortOnCannotGrowMemory:Ge,demangle:we,demangleAll:be,getTempRet0:function(){return S},jsStackTrace:Ae,memory:A,setTempRet0:function(e){S=e},stackTrace:Se,table:T,tempDoublePtr:ve},Je=o.asm({},$e,j);o.asm=Je;var Ze,Qe=o.___emscripten_environ_constructor=function(){return o.asm.___emscripten_environ_constructor.apply(null,arguments)},et=(o.___errno_location=function(){return o.asm.___errno_location.apply(null,arguments)},o.__get_daylight=function(){return o.asm.__get_daylight.apply(null,arguments)}),tt=(o.__get_environ=function(){return o.asm.__get_environ.apply(null,arguments)},o.__get_timezone=function(){return o.asm.__get_timezone.apply(null,arguments)}),rt=o.__get_tzname=function(){return o.asm.__get_tzname.apply(null,arguments)},nt=(o._broadwayCreateStream=function(){return o.asm._broadwayCreateStream.apply(null,arguments)},o._broadwayExit=function(){return o.asm._broadwayExit.apply(null,arguments)},o._broadwayInit=function(){return o.asm._broadwayInit.apply(null,arguments)},o._broadwayPlayStream=function(){return o.asm._broadwayPlayStream.apply(null,arguments)},o._emscripten_get_sbrk_ptr=function(){return o.asm._emscripten_get_sbrk_ptr.apply(null,arguments)},o._free=function(){return o.asm._free.apply(null,arguments)}),it=(o._llvm_bswap_i16=function(){return o.asm._llvm_bswap_i16.apply(null,arguments)},o._llvm_bswap_i32=function(){return o.asm._llvm_bswap_i32.apply(null,arguments)},o._malloc=function(){return o.asm._malloc.apply(null,arguments)}),ot=(o._memcpy=function(){return o.asm._memcpy.apply(null,arguments)},o._memmove=function(){return o.asm._memmove.apply(null,arguments)},o._memset=function(){return o.asm._memset.apply(null,arguments)},o.establishStackSpace=function(){return o.asm.establishStackSpace.apply(null,arguments)},o.stackAlloc=function(){return o.asm.stackAlloc.apply(null,arguments)});o.stackRestore=function(){return o.asm.stackRestore.apply(null,arguments)},o.stackSave=function(){return o.asm.stackSave.apply(null,arguments)},o.dynCall_dd=function(){return o.asm.dynCall_dd.apply(null,arguments)},o.dynCall_did=function(){return o.asm.dynCall_did.apply(null,arguments)},o.dynCall_didd=function(){return o.asm.dynCall_didd.apply(null,arguments)},o.dynCall_ii=function(){return o.asm.dynCall_ii.apply(null,arguments)},o.dynCall_iidiiii=function(){return o.asm.dynCall_iidiiii.apply(null,arguments)},o.dynCall_iii=function(){return o.asm.dynCall_iii.apply(null,arguments)},o.dynCall_iiii=function(){return o.asm.dynCall_iiii.apply(null,arguments)},o.dynCall_iiiii=function(){return o.asm.dynCall_iiiii.apply(null,arguments)},o.dynCall_iiiiii=function(){return o.asm.dynCall_iiiiii.apply(null,arguments)},o.dynCall_iiiiiii=function(){return o.asm.dynCall_iiiiiii.apply(null,arguments)},o.dynCall_jiji=function(){return o.asm.dynCall_jiji.apply(null,arguments)},o.dynCall_vi=function(){return o.asm.dynCall_vi.apply(null,arguments)},o.dynCall_vii=function(){return o.asm.dynCall_vii.apply(null,arguments)},o.dynCall_viii=function(){return o.asm.dynCall_viii.apply(null,arguments)},o.dynCall_viiii=function(){return o.asm.dynCall_viiii.apply(null,arguments)},o.dynCall_viiiii=function(){return o.asm.dynCall_viiiii.apply(null,arguments)},o.dynCall_viiiiii=function(){return o.asm.dynCall_viiiiii.apply(null,arguments)},o.dynCall_viiiiiiii=function(){return o.asm.dynCall_viiiiiiii.apply(null,arguments)},o.dynCall_viiiiiiiii=function(){return o.asm.dynCall_viiiiiiiii.apply(null,arguments)},o.dynCall_viiiiiiiiii=function(){return o.asm.dynCall_viiiiiiiiii.apply(null,arguments)};function st(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}o.asm=Je;function at(e){function t(){Ze||(Ze=!0,k||(te=!0,o.noFSInit||xe.init.initialized||xe.init(),Oe.init(),$(Z),xe.ignorePermissions=!1,$(Q),o.onRuntimeInitialized&&o.onRuntimeInitialized(),function(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)e=o.postRun.shift(),ee.unshift(e);var e;$(ee)}()))}e=e||u,ae>0||(!function(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)e=o.preRun.shift(),J.unshift(e);var e;$(J)}(),ae>0||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t()))}if(le=function e(){Ze||at(),Ze||(le=e)},o.run=at,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return b=!0,at(),o}(),s=n.Module||o;return s._broadwayOnBroadwayInit=e,s._broadwayOnPictureDecoded=i,s},o=function(){return(new Date).getTime()};"undefined"!=typeof performance&&performance.now&&(o=function(){return performance.now()});var s=function(e){var t;this.options=e||{},this.now=o;var r=function(e,r,n){var i,s=this.pictureBuffers[e];s||(s=this.pictureBuffers[e]=d(e,r*n*3/2));var a=!1;if(this.infoAr.length&&(a=!0,i=this.infoAr),this.infoAr=[],this.options.rgb){t||(t=u(r,n)),t.inp.set(s),t.doit();var l=new Uint8Array(t.outSize);return l.set(t.out),a&&(i[0].finishDecoding=o()),void this.onPictureDecoded(l,r,n,i)}a&&(i[0].finishDecoding=o()),this.onPictureDecoded(s,r,n,i)}.bind(this);this.options.sliceMode&&(r=function(e,t,r,n){var i=this.pictureBuffers[e];i||(i=this.pictureBuffers[e]=d(e,t*r*3/2));var s,u,l,c=this.pictureBuffers[n];c||(c=this.pictureBuffers[n]=(s=n,u=18,new Uint32Array(a.buffer,s,u)));this.infoAr.length&&(!0,l=this.infoAr),this.infoAr=[],l[0].finishDecoding=o();for(var f=[],h=0;h<20;++h)f.push(c[h]);l[0].sliceInfoAr=f,this.onPictureDecoded(i,t,r,l)}.bind(this));let n=this;var s=i.apply({},[function(){n.decoderReady=!0,n.onDecoderReady&&n.onDecoderReady()},r]);s.onRuntimeInitialized=function(){s._broadwayInit(),n.streamBuffer=d(s._broadwayCreateStream(l),l)};s.HEAP8;var a=s.HEAPU8,l=(s.HEAP16,s.HEAP32,1048576);function d(e,t){return a.subarray(e,e+t)}this.pictureBuffers={},this.infoAr=[],this.onPictureDecoded=function(e,t,r,n){};var c=0;this.options.sliceMode?(c=this.options.sliceNum,this.decode=function(e,t,r){this.infoAr.push(t),t.startDecoding=o();var n,i=t.nals;if(!i){i=[],t.nals=i;var a=e.length,u=!1,l=0,d=0;for(n=0;n<a;++n)if(1===e[n]&&0===e[n-1]&&0===e[n-2]){var f=n-2;0===e[n-3]&&(f=n-3),u&&i.push({offset:l,end:f,type:31&e[d]}),l=f,d=f+3,0===e[n-3]&&(d=f+4),u=!0}u&&i.push({offset:l,end:n,type:31&e[d]})}var h,p=0,m=0;for(n=0;n<i.length;++n)1===i[n].type||5===i[n].type?(p===c&&(h=e.subarray(i[n].offset,i[n].end),this.streamBuffer[m]=0,m+=1,this.streamBuffer.set(h,m),m+=h.length),p+=1):(h=e.subarray(i[n].offset,i[n].end),this.streamBuffer[m]=0,m+=1,this.streamBuffer.set(h,m),m+=h.length,s._broadwayPlayStream(m),m=0);r(),s._broadwayPlayStream(m)}):this.decode=function(e,t){console.info("Decoding: "+e.length+" bytes"),t&&(this.infoAr.push(t),t.startDecoding=o()),this.streamBuffer.set(e),s._broadwayPlayStream(e.length)}};s.prototype={};var a={},u=function(e,t){var r=e+"x"+t;if(a[r])return a[r];for(var i=e*t,o=(0|i)>>2,s=i+o+o,u=e*t*4,l=s+u+4*Math.pow(2,24),d=Math.pow(2,24),c=d;c<l;)c+=d;var f=new ArrayBuffer(c),h=function(e,t,r){"use asm";var n=e.Math.imul,i=e.Math.min,o=e.Math.max,s=e.Math.pow,a=new e.Uint8Array(r),u=new e.Uint32Array(r),l=new e.Uint8Array(r),d=new e.Uint8Array(r),c=new e.Uint32Array(r),f=0,h=0,p=0,m=0,g=0,y=0,_=0,E=0,v=0,w=0;function b(e,t){e=e|0;t=t|0;var r=0;var i=0;f=e;v=n(e,4)|0;h=t;p=n(f|0,h|0)|0;m=(p|0)>>2;y=n(n(f,h)|0,4)|0;g=p+m|0+m|0;E=0;_=E+y|0;w=_+g|0;i=~~+s(+2,+24);i=n(i,4)|0;for(r=0|0;(r|0)<(i|0)|0;r=r+4|0){c[(w+r|0)>>2]=0}}function A(){var e=0;var t=0;var r=0;var n=0;var i=0;var o=0;var s=0;var a=0;var u=0;var d=0;var g=0;var y=0;var b=0;var A=0;b=E|0;e=_|0;t=e+p|0|0;r=t+m|0;for(u=0;(u|0)<(h|0);u=u+2|0){g=t;y=r;for(d=0;(d|0)<(f|0);d=d+2|0){n=l[e>>0]|0;i=l[(e+f|0)>>0]|0;o=l[t>>0]|0;s=l[r>>0]|0;A=((n<<16|0)+(o<<8|0)|0)+s|0;a=c[(w+A|0)>>2]|0;if(a){}else{a=S(n,o,s)|0;c[(w+A|0)>>2]=a|0}c[b>>2]=a;A=((i<<16|0)+(o<<8|0)|0)+s|0;a=c[(w+A|0)>>2]|0;if(a){}else{a=S(i,o,s)|0;c[(w+A|0)>>2]=a|0}c[(b+v|0)>>2]=a;b=b+4|0;e=e+1|0;n=l[e>>0]|0;i=l[(e+f|0)>>0]|0;A=((n<<16|0)+(o<<8|0)|0)+s|0;a=c[(w+A|0)>>2]|0;if(a){}else{a=S(n,o,s)|0;c[(w+A|0)>>2]=a|0}c[b>>2]=a;A=((i<<16|0)+(o<<8|0)|0)+s|0;a=c[(w+A|0)>>2]|0;if(a){}else{a=S(i,o,s)|0;c[(w+A|0)>>2]=a|0}c[(b+v|0)>>2]=a;b=b+4|0;e=e+1|0;t=t+1|0;r=r+1|0}b=b+v|0;e=e+f|0}}function S(e,t,r){e=e|0;t=t|0;r=r|0;var s=0;var a=0;var u=0;var l=0;var d=0;var c=0;var f=0;var h=0;var p=0;d=n(1192,e-16|0)|0;c=n(1634,r-128|0)|0;f=n(832,r-128|0)|0;h=n(400,t-128|0)|0;p=n(2066,t-128|0)|0;s=(d+c|0)>>10|0;a=((d-f|0)-h|0)>>10|0;u=(d+p|0)>>10|0;if((s&255|0)!=(s|0)|0){s=i(255,o(0,s|0)|0)|0}if((a&255|0)!=(a|0)|0){a=i(255,o(0,a|0)|0)|0}if((u&255|0)!=(u|0)|0){u=i(255,o(0,u|0)|0)|0}l=255;l=l<<8|0;l=l+u|0;l=l<<8|0;l=l+a|0;l=l<<8|0;l=l+s|0;return l|0}return{init:b,doit:A}}(n,{},f);return h.init(e,t),a[r]=h,h.heap=f,h.out=new Uint8Array(f,0,u),h.inp=new Uint8Array(f,u,s),h.outSize=u,h};var l;s.nowValue=o,e.exports=function(e){e.addEventListener("message",(function(t){var r=t.data;if(r.msg)switch(r.msg){case"init":(l=new s({rgb:!0})).onDecoderReady=function(){e.postMessage({msg:"DECODER_READY"})},l.onPictureDecoded=function(t,r,n,i){e.postMessage({msg:"DECODED",data:t,width:r,height:n,info:i})};break;case"decode":l.decode(r.data,r.info)}else e.postMessage({msg:"ERROR:invalid message"})}),!1)}}).call(this,r(32),r(33).Buffer,r(11))},function(e,t,r){"use strict";var n,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,d=[],c=!1,f=-1;function h(){c&&l&&(c=!1,l.length?d=l.concat(d):f=-1,d.length&&p())}function p(){if(!c){var e=u(h);c=!0;for(var t=d.length;t;){for(l=d,d=[];++f<t;)l&&l[f].run();f=-1,t=d.length}l=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new m(e,t)),1!==d.length||c||u(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=r(34),i=r(35),o=r(36);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return l(this,e,t,r)}function l(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r),i=(e=a(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|h(t.length);return 0===(e=a(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?a(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(d(t),e=a(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t){var r=t.length<0?0:0|h(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(e).length;default:if(n)return z(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return D(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:_(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):_(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function _(e,t,r,n,i){var o,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var d=-1;for(o=r;o<a;o++)if(l(e,o)===l(t,-1===d?0:o-d)){if(-1===d&&(d=o),o-d+1===u)return d*s}else-1!==d&&(o-=o-d),d=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var c=!0,f=0;f<u;f++)if(l(e,o+f)!==l(t,f)){c=!1;break}if(c)return o}return-1}function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function v(e,t,r,n){return G(z(t,e.length-r),e,r,n)}function w(e,t,r,n){return G(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return w(e,t,r,n)}function A(e,t,r,n){return G(V(t),e,r,n)}function S(e,t,r,n){return G(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function D(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,u,l=e[i],d=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(d=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(d=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&l)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(d=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(d=u)}null===d?(d=65533,c=1):d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|1023&d),n.push(d),i+=c}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return l(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return d(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return c(null,e)},u.allocUnsafeSlow=function(e){return c(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(n,i),d=e.slice(t,r),c=0;c<a;++c)if(l[c]!==d[c]){o=l[c],s=d[c];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return w(this,e,t,r);case"latin1":case"binary":return b(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=j(e[o]);return i}function B(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function U(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function P(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function x(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function C(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,n,o){return o||C(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function I(e,t,r,n,o){return o||C(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUInt8=function(e,t){return t||U(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||U(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||U(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||U(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||U(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||U(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||U(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||U(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||U(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||U(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):x(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):x(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return I(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return I(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=u.isBuffer(e)?e:z(new u(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function V(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(11))},function(e,t,r){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=l(e),s=n[0],a=n[1],u=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),d=0,c=a>0?s-4:s;for(r=0;r<c;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],u[d++]=t>>16&255,u[d++]=t>>8&255,u[d++]=255&t;2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,u[d++]=255&t);1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,u[d++]=t>>8&255,u[d++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(d(e,s,s+16383>a?a:s+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function d(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t,r){"use strict";t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,l=u>>1,d=-7,c=r?i-1:0,f=r?-1:1,h=e[t+c];for(c+=f,o=h&(1<<-d)-1,h>>=-d,d+=a;d>0;o=256*o+e[t+c],c+=f,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=n;d>0;s=256*s+e[t+c],c+=f,d-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),o-=l}return(h?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,u,l=8*o-i-1,d=(1<<l)-1,c=d>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(s++,u/=2),s+c>=d?(a=0,s=d):s+c>=1?(a=(t*u-1)*Math.pow(2,i),s+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;e[r+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[r+h]=255&s,h+=p,s/=256,l-=8);e[r+h-p]|=128*m}},function(e,t,r){"use strict";var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.config=Object.assign({},e),this.context=new AudioContext,this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.meta=void 0,this.samples=[],this.preloadTime=this.config.preloadTime||3,this.duration=0,this._currentBuffer=void 0,this._nextBuffer=void 0,this._lastpts=void 0,this._preDecode=[],this._currentTime=0,this._decoding=!1,this._played=!1}get currentTime(){return this._currentTime}setAudioData(e){for(let t=0;t<e.length;t++)e[t].pts=void 0===e[t].pts?e[t].dts:e[t].pts,this._preDecode.push(e[t]);this._preDecode.length>0&&(void 0===this._lastpts&&(this._lastpts=this._preDecode[0].pts),(this._preDecode[this._preDecode.length-1].pts-this._lastpts)/1e3>this.preloadTime&&this.decodeAAC())}decodeAAC(){if(this._decoding)return;this._decoding=!0;let e=this._preDecode,t=[],r=this,i=e.shift();for(;i;){let r=n.getAACData(this.meta,i);t.push(r),this._lastpts=i.pts,i=e.shift()}let o=n.combileData(t);try{this.context.decodeAudioData(o.buffer,(function(e){let t=r.context.createBufferSource();t.buffer=e,t.onended=r.onSourceEnded.bind(r),r.samples.push({time:r.duration,duration:e.duration,data:t}),r.duration+=e.duration,r._currentBuffer||(r._currentBuffer=r.getTimeBuffer(r.currentTime),r._played&&r.play()),!r._nextBuffer&&r._currentBuffer&&(r._nextBuffer=r.getTimeBuffer(r.currentTime+r._currentBuffer.duration)),r._decoding=!1,(r._preDecode.length>0&&r._preDecode[r._preDecode.length-1].pts-r._lastpts)/1e3>=r.preloadTime&&r.decodeAAC()}))}catch(e){console.error(e)}}onSourceEnded(){if(!this._nextBuffer||!this._played)return;let e=this._nextBuffer.data;e.start(),e.connect(this.gainNode),this._currentBuffer=this._nextBuffer,this._currentTime=this._currentBuffer.time,this._nextBuffer=this.getTimeBuffer(this.currentTime),this._currentBuffer&&(this._nextBuffer=this.getTimeBuffer(this.currentTime+this._currentBuffer.duration))}play(){if(this._played=!0,!this._currentBuffer)return;let e=this._currentBuffer.data;e.connect(this.gainNode),e.start()}getTimeBuffer(e){let t;for(let r=0;r<this.samples.length;r++){let n=this.samples[r];if(n.time<=e&&n.time+n.duration>e){t=n;break}}return t}setAudioMetaData(e){this.meta=e}static getAACData(e,t){let r=new Uint8Array(t.data.byteLength+7),i=n.getAdts(e,t.data);return r.set(i),r.set(t.data,7),r}static combileData(e){let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].byteLength;let r=new Uint8Array(t),n=0;for(let t=0,i=e.length;t<i;t++)r.set(e[t],n),n+=e[t].byteLength;return r}static getAdts(e,t){let r=new Uint8Array(7);r[0]=255,r[1]=240,r[1]=1|r[1],r[2]=192&e.objectType-1<<6,r[2]=r[2]|60&e.sampleRateIndex<<2,r[2]=r[2]|1&e.channelCount>>2,r[3]=192&e.channelCount<<6;let n=t.byteLength+7;return r[3]=r[3]|3&n>>11,r[4]=255&n>>3,r[5]=224&n<<5,r[5]=31|r[5],r[6]=252,r}}t.default=n},function(e,t,r){"use strict";e.exports={Mp4Remuxer:r(39).default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(40),s=(n=o)&&n.__esModule?n:{default:n};const a=i.EVENTS.REMUX_EVENTS;class u{constructor(){this._dtsBase=0,this._isDtsBaseInited=!1,this.videoAllDuration=0,this.audioAllDuration=0}init(){this.on(a.REMUX_MEDIA,this.remux.bind(this)),this.on(a.REMUX_METADATA,this.onMetaDataReady.bind(this))}destroy(){this._dtsBase=-1,this._dtsBaseInited=!1}reset(){this._dtsBase=0,this._isDtsBaseInited=!1}remux(){const{audioTrack:e,videoTrack:t}=this._context.getInstance("TRACKS");!this._isDtsBaseInited&&this.calcDtsBase(e,t),this._remuxVideo(t),this._remuxAudio(e)}seek(){}onMetaDataReady(e){let t,r,n=new i.Buffer,o=s.default.ftyp();if("audio"===e){const{audioTrack:e}=this._context.getInstance("TRACKS");r=e}else{const{videoTrack:e}=this._context.getInstance("TRACKS");r=e}t=s.default.moov({type:e,meta:r.meta}),n.write(o,t);let u=this._context.getInstance("PRE_SOURCE_BUFFER"),l=u.getSource(e);l||(l=u.createSource(e)),l.mimetype=r.meta.codec,l.init=n,this.emit(a.INIT_SEGMENT,e)}calcDtsBase(e,t){if(!e.samples.length&&!t.samples.length)return;let r=1/0,n=1/0;e.samples&&e.samples.length&&(r=e.samples[0].dts),t.samples&&t.samples.length&&(n=t.samples[0].dts),this._dtsBase=Math.min(r,n),this._isDtsBaseInited=!0}_remuxVideo(e){const t=e;if(!e.samples||!e.samples.length)return;let{samples:r}=t,n=-1;const o=[],u={samples:[]};for(;r.length;){const e=r.shift(),{isKeyframe:t}=e;let i,s,a=e.dts-this._dtsBase;-1===n&&(n=a),e.pts&&(i=(s=e.pts-this._dtsBase)-a),e.cts&&(s=e.cts+a,i=e.cts);let l={buffer:[],size:0};u.samples.push(l),l.buffer.push(e.data),l.size+=e.data.byteLength;let d=0;if(r.length>=1){d=r[0].dts-this._dtsBase-a}else d=o.length>=1?o[o.length-1].duration:this.videoMeta.refSampleDuration;this.videoAllDuration+=d,o.push({dts:a,cts:i,pts:s,data:e.data,size:e.data.byteLength,isKeyframe:t,duration:d,flags:{isLeading:0,dependsOn:t?2:1,isDependedOn:t?1:0,hasRedundancy:0,isNonSync:t?0:1},originDts:a,type:"video"})}let l=new i.Buffer;const d=s.default.moof({id:t.meta.id,time:n,samples:o}),c=s.default.mdat(u);l.write(d,c),t.samples=[],t.length=0;let f=this._context.getInstance("PRE_SOURCE_BUFFER"),h=f.getSource("video");h||(h=f.createSource("video")),h.data.push(l),this.emit(a.MEDIA_SEGMENT,"video")}_remuxAudio(e){const{samples:t}=e;let r=-1,n=[];const o={samples:[]};if(!t||!t.length)return;let u=!1;for(;t.length;){let e=t.shift();const{data:i}=e;let s=e.dts-this._dtsBase;const a=s;u||(r=s,u=!0);let l=0;if(this.audioMeta.refSampleDurationFixed)l=this.audioMeta.refSampleDurationFixed;else if(t.length>=1){l=t[0].dts-this._dtsBase-s}else l=n.length>=1?n[n.length-1].duration:this.audioMeta.refSampleDuration;this.audioAllDuration+=l;const d={dts:s,pts:s,cts:0,size:i.byteLength,duration:e.duration?e.duration:l,flags:{isLeading:0,dependsOn:2,isDependedOn:1,hasRedundancy:0,isNonSync:0},isKeyframe:!0,originDts:a,type:"audio"};let c={buffer:[],size:0};c.buffer.push(i),c.size+=i.byteLength,o.samples.push(c),n.push(d)}const l=new i.Buffer,d=s.default.moof({id:e.meta.id,time:r,samples:n}),c=s.default.mdat(o);l.write(d,c),e.samples=[],e.length=0;let f=this._context.getInstance("PRE_SOURCE_BUFFER"),h=f.getSource("audio");h||(h=f.createSource("audio")),h.data.push(l),this.emit(a.MEDIA_SEGMENT,"audio",l)}initSilentAudio(e,t){const r=u.getSilentFrame(this.audioMeta.channelCount);return{dts:e,pts:e,cts:0,duration:t,unit:r,size:r.byteLength,originDts:e,type:"video"}}get videoMeta(){return this._context.getInstance("TRACKS").videoTrack.meta}get audioMeta(){return this._context.getInstance("TRACKS").audioTrack.meta}static getSilentFrame(e){return 1===e?new Uint8Array([0,200,0,128,35,128]):2===e?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]):6===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null}}t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);class i{static size(e){return n.Buffer.writeUint32(e)}static initBox(e,t,...r){const o=new n.Buffer;return o.write(i.size(e),i.type(t),...r),o.buffer}static extension(e,t){return new Uint8Array([e,t>>16&255,t>>8&255,255&t])}static ftyp(){return i.initBox(24,"ftyp",new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))}static moov({type:e,meta:t}){let r,n=8,o=i.mvhd(t.duration,t.timescale);r="video"===e?i.videoTrak(t):i.audioTrak(t);let s=i.mvex(t.duration,t.timescale||1e3,t.id);return[o,r,s].forEach(e=>{n+=e.byteLength}),i.initBox(n,"moov",o,r,s)}static mvhd(e,t=1e3){let r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i.initBox(8+r.length,"mvhd",new Uint8Array(r))}static videoTrak(e){let t=8,r=i.tkhd({id:1,duration:e.duration,timescale:e.timescale||1e3,width:e.presentWidth,height:e.presentHeight,type:"video"}),n=i.mdia({type:"video",timescale:e.timescale||1e3,duration:e.duration,avcc:e.avcc,parRatio:e.parRatio,width:e.presentWidth,height:e.presentHeight});return[r,n].forEach(e=>{t+=e.byteLength}),i.initBox(t,"trak",r,n)}static audioTrak(e){let t=8,r=i.tkhd({id:2,duration:e.duration,timescale:e.timescale||1e3,width:0,height:0,type:"audio"}),n=i.mdia({type:"audio",timescale:e.timescale||1e3,duration:e.duration,channelCount:e.channelCount,samplerate:e.sampleRate,config:e.config});return[r,n].forEach(e=>{t+=e.byteLength}),i.initBox(t,"trak",r,n)}static tkhd(e){let t=e.id,r=e.duration,n=e.width,o=e.height,s=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,255&n,0,0,o>>>8&255,255&o,0,0]);return i.initBox(8+s.byteLength,"tkhd",s)}static edts(e){let t=new n.Buffer,r=e.duration,o=e.mediaTime;return t.write(i.size(36),i.type("edts")),t.write(i.size(28),i.type("elst")),t.write(new Uint8Array([0,0,0,1,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,0,0,0,1])),t.buffer}static mdia(e){let t=8,r=i.mdhd(e.timescale,e.duration),n=i.hdlr(e.type),o=i.minf(e);return[r,n,o].forEach(e=>{t+=e.byteLength}),i.initBox(t,"mdia",r,n,o)}static mdhd(e=1e3,t){let r=new Uint8Array([0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,85,196,0,0]);return i.initBox(12+r.byteLength,"mdhd",i.extension(0,0),r)}static hdlr(e){let t=[0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0];return"audio"===e&&(t.splice(8,4,115,111,117,110),t.splice(24,13,83,111,117,110,100,72,97,110,100,108,101,114,0)),i.initBox(8+t.length,"hdlr",new Uint8Array(t))}static minf(e){let t=8,r="video"===e.type?i.vmhd():i.smhd(),n=i.dinf(),o=i.stbl(e);return[r,n,o].forEach(e=>{t+=e.byteLength}),i.initBox(t,"minf",r,n,o)}static vmhd(){return i.initBox(20,"vmhd",new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))}static smhd(){return i.initBox(16,"smhd",new Uint8Array([0,0,0,0,0,0,0,0]))}static dinf(){let e=new n.Buffer;return e.write(i.size(36),i.type("dinf"),i.size(28),i.type("dref"),new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])),e.buffer}static stbl(e){let t=8,r=i.stsd(e),n=i.stts(),o=i.stsc(),s=i.stsz(),a=i.stco();return[r,n,o,s,a].forEach(e=>{t+=e.byteLength}),i.initBox(t,"stbl",r,n,o,s,a)}static stsd(e){let t;return t="audio"===e.type?i.mp4a(e):i.avc1(e),i.initBox(16+t.byteLength,"stsd",i.extension(0,0),new Uint8Array([0,0,0,1]),t)}static mp4a(e){let t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,e.samplerate>>8&255,255&e.samplerate,0,0]),r=i.esds(e.config);return i.initBox(8+t.byteLength+r.byteLength,"mp4a",t,r)}static esds(e=[43,146,8,0]){const t=e.length;let r=new n.Buffer,o=new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e).concat([6,1,2]));return r.write(i.size(8+o.byteLength),i.type("esds"),o),r.buffer}static avc1(e){let t=new n.Buffer,r=e.width,o=e.height,s=e.parRatio.height,a=e.parRatio.width,u=e.avcc,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>8&255,255&r,o>>8&255,255&o,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d=new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]),c=new Uint8Array([s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a]);return t.write(i.size(40+l.byteLength+u.byteLength+d.byteLength),i.type("avc1"),l,i.size(8+u.byteLength),i.type("avcC"),u,i.size(20),i.type("btrt"),d,i.size(16),i.type("pasp"),c),t.buffer}static stts(){let e=new Uint8Array([0,0,0,0,0,0,0,0]);return i.initBox(16,"stts",e)}static stsc(){let e=new Uint8Array([0,0,0,0,0,0,0,0]);return i.initBox(16,"stsc",e)}static stco(){let e=new Uint8Array([0,0,0,0,0,0,0,0]);return i.initBox(16,"stco",e)}static stsz(){let e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);return i.initBox(20,"stsz",e)}static mvex(e,t=1e3,r){let o=new n.Buffer,s=n.Buffer.writeUint32(e);return o.write(i.size(56),i.type("mvex"),i.size(16),i.type("mehd"),i.extension(0,0),s,i.trex(r)),o.buffer}static trex(e){let t=new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return i.initBox(8+t.byteLength,"trex",t)}static moof(e){let t=8,r=i.mfhd(),n=i.traf(e);return[r,n].forEach(e=>{t+=e.byteLength}),i.initBox(t,"moof",r,n)}static mfhd(){let e=n.Buffer.writeUint32(i.sequence);return i.sequence+=1,i.initBox(16,"mfhd",i.extension(0,0),e)}static traf(e){let t=8,r=i.tfhd(e.id),n=i.tfdt(e.time),o=i.sdtp(e),s=i.trun(e,o.byteLength);return[r,n,s,o].forEach(e=>{t+=e.byteLength}),i.initBox(t,"traf",r,n,s,o)}static tfhd(e){let t=n.Buffer.writeUint32(e);return i.initBox(16,"tfhd",i.extension(0,0),t)}static tfdt(e){return i.initBox(16,"tfdt",i.extension(0,0),n.Buffer.writeUint32(e))}static trun(e,t){let r=new n.Buffer,o=n.Buffer.writeUint32(e.samples.length),s=n.Buffer.writeUint32(92+16*e.samples.length+t);return r.write(i.size(20+16*e.samples.length),i.type("trun"),new Uint8Array([0,0,15,1]),o,s),e.samples.forEach(e=>{const t=e.flags;r.write(new Uint8Array([e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,e.size>>>24&255,e.size>>>16&255,e.size>>>8&255,255&e.size,t.isLeading<<2|t.dependsOn,t.isDependedOn<<6|t.hasRedundancy<<4|t.isNonSync,0,0,e.cts>>>24&255,e.cts>>>16&255,e.cts>>>8&255,255&e.cts]))}),r.buffer}static sdtp(e){let t=new n.Buffer;return t.write(i.size(12+e.samples.length),i.type("sdtp"),i.extension(0,0)),e.samples.forEach(e=>{const r=e.flags,n=r.isLeading<<6|r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;t.write(new Uint8Array([n]))}),t.buffer}static mdat(e){let t=new n.Buffer,r=8;e.samples.forEach(e=>{r+=e.size}),t.write(i.size(r),i.type("mdat"));let o=new Uint8Array(r),s=0;return o.set(t.buffer,s),s+=8,e.samples.forEach(e=>{e.buffer.forEach(e=>{o.set(e,s),s+=e.byteLength})}),o}}i.type=e=>new Uint8Array([e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]),i.sequence=1,t.default=i},function(e,t,r){"use strict";e.exports={FetchLoader:r(42).default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0).EVENTS.LOADER_EVENTS,i=0,o=1,s=2,a=3;t.default=class{constructor(e){this.configs=Object.assign({},e),this.url=null,this.status=0,this.error=null,this._reader=null,this._canceled=!1,this.readtype=this.configs.readtype,this.buffer=this.configs.buffer||"LOADER_BUFFER",this._loaderTaskNo=0}init(){this.on(n.LADER_START,this.load.bind(this))}static get type(){return"loader"}load(e,t){let r=this;this.url=e,this._canceled=!1;let i=this.getParams(t);return r.loading=!0,fetch(this.url,i).then((function(e){if(e.ok)return r.status=e.status,r._onFetchResponse(e);r.emit(n.LOADER_ERROR,r,e),r.loading=!1})).catch((function(e){throw r.emit(n.LOADER_ERROR,r,e),r.loading=!1,new Error(e.message)}))}_onFetchResponse(e){let t=this,r=this._context.getInstance(this.buffer);this._loaderTaskNo++;let u=this._loaderTaskNo;if(!0===e.ok)switch(this.readtype){case s:e.json().then(e=>{t.loading=!1,t._canceled||(r?(r.push(e),t.emit(n.LOADER_COMPLETE,r)):t.emit(n.LOADER_COMPLETE,e))});break;case o:e.text().then(e=>{t.loading=!1,t._canceled||(r?(r.push(e),t.emit(n.LOADER_COMPLETE,r)):t.emit(n.LOADER_COMPLETE,e))});break;case a:e.arrayBuffer().then(e=>{t.loading=!1,t._canceled||(r?(r.push(new Uint8Array(e)),t.emit(n.LOADER_COMPLETE,r)):t.emit(n.LOADER_COMPLETE,e))});break;case i:default:return this._onReader(e.body.getReader(),u)}}_onReader(e,t){let r=this._context.getInstance(this.buffer);if(r||this._reader.cancel(),this._reader=e,!1===this.loading)return;let i=this;this._reader&&this._reader.read().then((function(o){return o.done?(i.loading=!1,i.status=0,void i.emit(n.LOADER_COMPLETE,r)):i._canceled?void i._reader.cancel():(r.push(o.value),i.emit(n.LOADER_DATALOADED,r),i._onReader(e,t))})).catch(e=>{console.error(e),i.emit(n.LOADER_ERROR,i,e),i.loading=!1})}getParams(e){let t=Object.assign({},e),r=new Headers,n={method:"GET",headers:r,mode:"cors",cache:"default"};if("object"==typeof this.configs.headers){let e=this.configs.headers;for(let t in e)e.hasOwnProperty(t)&&r.append(t,e[t])}if("object"==typeof t.headers){let e=t.headers;for(let t in e)e.hasOwnProperty(t)&&r.append(t,e[t])}return!1===t.cors&&(n.mode="same-origin"),t.withCredentials&&(n.credentials="include"),n}cancel(){this._reader&&(this._reader.cancel(),this._reader=null,this.loading=!1,this._canceled=!0)}destroy(){this.cancel()}}},function(e,t,r){"use strict";e.exports={M3U8Parser:r(44).default,TsDemuxer:r(45).default,Playlist:r(49).default,FlvDemuxer:r(50).default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static parse(e,t=""){let r={duration:0};if(!e||!e.split)return;let i=e.split(/\r|\n/),o=(i=i.filter(e=>e)).shift();if(!o.match("#EXTM3U"))return null;for(o=i.shift();o;){let e=o.match(/#(.*):(.*)/);if(e&&e.length>2)switch(e[1]){case"EXT-X-VERSION":r.version=parseInt(e[2]);break;case"EXT-X-MEDIA-SEQUENCE":r.sequence=parseInt(e[2]);break;case"EXT-X-TARGETDURATION":r.targetduration=parseFloat(e[2]);break;case"EXTINF":n.parseFrag(e,i,r,t)}o=i.shift()}return r}static parseFrag(e,t,r,n){r.frags||(r.frags=[]);let i={start:r.duration,duration:1e3*parseFloat(e[2])};r.duration+=i.duration;let o=t.shift();o.match(/#(.*):(.*)/)&&(o=t.shift()),o.length>0&&"/"===o.charAt(0)&&n.match(/.*\/\/.*\.\w+/g)&&(n=n.match(/.*\/\/.*\.\w+/g)[0]),o.match(/.*:\/\/.*/)?i.url=o:i.url=n+o,r.frags.push(i)}static parseURL(e){let t="",r=e.match(/(.*\/).*\.m3u8/);if(r&&r.length>0)for(let e=0;e<r.length;e++)r[e].match(/.*\/$/g)&&r[e].length>t.length&&(t=r[e]);return t}}t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(0);const s=o.EVENTS.DEMUX_EVENTS,a={1:["video","MPEG-1"],2:["video","MPEG-2"],27:["video","AVC.H264"],234:["video","VC-1"],3:["audio","MPEG-1"],4:["audio","MPEG-2"],15:["audio","MPEG-2.AAC"],17:["audio","MPEG-4.AAC"],128:["audio","LPCM"],129:["audio","AC3"],6:["audio","AC3"],130:["audio","DTS"],131:["audio","Dolby TrueHD"],132:["audio","AC3-Plus"],133:["audio","DTS-HD"],134:["audio","DTS-MA"],161:["audio","AC3-Plus-SEC"],162:["audio","DTS-HD-SEC"]};class u{constructor(e){this.configs=Object.assign({},e),this.demuxing=!1,this.pat=[],this.pmt=[],this._hasVideoMeta=!1,this._hasAudioMeta=!1}init(){this.on(s.DEMUX_START,this.demux.bind(this))}demux(){if(this.demuxing)return;let e=this.inputBuffer,t={pat:[],pmt:[]},r={};for(;e.length>=188;){for(;e.length>=1&&71!==e.array[0][e.offset];)e.shift(1);let n=e.shift(188),i=new o.Stream(n.buffer),s={};u.read(i,s,t),s.pes?(r[s.header.pid]||(r[s.header.pid]=[]),r[s.header.pid].push(s.pes),s.pes.ES.buffer=[s.pes.ES.buffer]):r[s.header.pid]&&r[s.header.pid][r[s.header.pid].length-1].ES.buffer.push(s.payload.stream)}for(let e=0;e<Object.keys(r).length;e++){let t=r[Object.keys(r)[e]];for(let n=0;n<t.length;n++)t[n].id=Object.keys(r)[e],t[n].ES.buffer=u.Merge(t[n].ES.buffer),"audio"===t[n].type?this.pushAudioSample(t[n]):"video"===t[n].type&&this.pushVideoSample(t[n])}this._hasAudioMeta&&this.emit(s.DEMUX_COMPLETE,"audio"),this._hasVideoMeta&&this.emit(s.DEMUX_COMPLETE,"video")}pushAudioSample(e){let t;this._tracks.audioTrack?t=this._tracks.audioTrack:(this._tracks.audioTrack=new i.AudioTrack,(t=this._tracks.audioTrack).meta=new o.AudioTrackMeta({audioSampleRate:e.ES.frequence,sampleRate:e.ES.frequence,channelCount:e.ES.channel,codec:"mp4a.40."+e.ES.audioObjectType,config:e.ES.audioConfig,id:2,sampleRateIndex:e.ES.frequencyIndex}),t.meta.refSampleDuration=Math.floor(1024/t.meta.audioSampleRate*t.meta.timescale),this._hasAudioMeta||(this._hasAudioMeta=!0,this.emit(s.METADATA_PARSED,"audio")));let r=new Uint8Array(e.ES.buffer.buffer.slice(e.ES.buffer.position,e.ES.buffer.length)),n=parseInt(e.pts/90),a=parseInt(e.pts/90),u=new o.AudioTrackSample({dts:n,pts:a,data:r});t.samples.push(u)}pushVideoSample(e){let t,r=n.Nalunit.getNalunits(e.ES.buffer);this._tracks.videoTrack?t=this._tracks.videoTrack:(this._tracks.videoTrack=new i.VideoTrack,(t=this._tracks.videoTrack).meta=new o.VideoTrackMeta);let a=0,l=!1,d=!1;for(let e=0;e<r.length;e++){let n=r[e];if(n.sps){if(t.sps&&u.compaireUint8(n.body,t.sps))continue;l=n,t.sps=n.body,t.meta.chromaFormat=l.sps.chroma_format,t.meta.codec="avc1.";for(var c=1;c<4;c++){var f=l.body[c].toString(16);f.length<2&&(f="0"+f),t.meta.codec+=f}t.meta.codecHeight=l.sps.codec_size.height,t.meta.codecWidth=l.sps.codec_size.width,t.meta.frameRate=l.sps.frame_rate,t.meta.id=1,t.meta.level=l.sps.level_string,t.meta.presentHeight=l.sps.present_size.height,t.meta.presentWidth=l.sps.present_size.width,t.meta.profile=l.sps.profile_string,t.meta.refSampleDuration=Math.floor(t.meta.timescale*(l.sps.frame_rate.fps_den/l.sps.frame_rate.fps_num)),t.meta.sarRatio=l.sps.sar_ratio?l.sps.sar_ratio:l.sps.par_ratio}else n.pps?(t.pps=n.body,d=n):a+=4+n.body.byteLength}l&&d&&(t.meta.avcc=n.Nalunit.getAvcc(l.body,d.body),this._hasVideoMeta||(this._hasVideoMeta=!0,this.emit(s.METADATA_PARSED,"video")));let h=new Uint8Array(a),p=0,m=!1;for(let e=0;e<r.length;e++){let t=r[e],n=t.body.byteLength;t.idr&&(m=!0),t.pps||t.sps||(h.set(new Uint8Array([n>>>24&255,n>>>16&255,n>>>8&255,255&n]),p),p+=4,h.set(t.body,p),p+=n)}let g=new o.VideoTrackSample({dts:parseInt(e.dts/90),pts:parseInt(e.pts/90),cts:(e.pts-e.dts)/90,originDts:e.dts,isKeyframe:m,data:h});t.samples.push(g)}destory(){this.off(s.DEMUX_START,this.demux),this.configs={},this.demuxing=!1,this.pat=[],this.pmt=[],this._hasVideoMeta=!1,this._hasAudioMeta=!1}static compaireUint8(e,t){if(e.byteLength!==t.byteLength)return!1;let r=!0;for(let n=0;n<e.byteLength;n++)e[n]!==t[n]&&(r=!1);return r}static Merge(e){let t,r=0,n=0;for(let t=0;t<e.length;t++)r+=e[t].length-e[t].position;t=new Uint8Array(r);for(let r=0;r<e.length;r++){let i=e[r];t.set(new Uint8Array(i.buffer,i.position),n),n+=i.length-i.position}return new o.Stream(t.buffer)}static read(e,t,r){u.readHeader(e,t),u.readPayload(e,t,r),"MEDIA"!==t.header.packet||1!==t.header.payload||t.unknownPIDs||(t.pes=u.PES(t))}static readPayload(e,t,r){let n=t.header.pid;switch(n){case 0:u.PAT(e,t,r);break;case 1:u.CAT(e,t,r);break;case 2:u.TSDT(e,t,r);break;case 8191:break;default:if(r.pat.some(e=>e.pid===n))u.PMT(e,t,r);else{let i=r.pmt?r.pmt.filter(e=>e.pid===n):[];i.length>0?u.Media(e,t,a[i[0].streamType][0]):t.unknownPIDs=!0}}}static readHeader(e,t){let r={};r.sync=e.readUint8();let n=e.readUint16();r.error=n>>>15,r.payload=n>>>14&1,r.priority=n>>>13&1,r.pid=8191&n,n=e.readUint8(),r.scrambling=n>>6&3,r.adaptation=n>>4&3,r.continuity=15&n,r.packet=0===r.pid?"PAT":"MEDIA",t.header=r}static PAT(e,t,r){let n={},i=e.readUint8();e.skip(i),i=e.readUint8(),n.tabelID=i,i=e.readUint16(),n.error=i>>>7,n.zero=i>>>6&1,n.sectionLength=4095&i,n.streamID=e.readUint16(),n.current=1&e.readUint8(),n.sectionNumber=e.readUint8(),n.lastSectionNumber=e.readUint8();let o=(n.sectionLength-9)/4,s=[];for(let t=0;t<o;t++){let t=e.readUint16(),r=8191&e.readUint16();s.push({program:t,pid:r,type:0===t?"network":"mapPID"})}s.length>0&&(r.pat=r.pat.concat(s)),n.list=s,n.program=e.readUint16(),n.pid=8191&e.readUint16(),t.payload=n}static PMT(e,t,r){let n={};t.header.packet="PMT";let i=e.readUint8();e.skip(i),i=e.readUint8(),n.tableID=i,i=e.readUint16(),n.sectionLength=4095&i,n.program=e.readUint16(),n.current=1&e.readUint8(),n.order=e.readUint8(),n.lastOrder=e.readUint8(),n.PCR_PID=8191&e.readUint16(),n.programLength=4095&e.readUint16();let o=(n.sectionLength-13)/5,s=[];for(let t=0;t<o;t++)s.push({streamType:e.readUint8(),pid:8191&e.readUint16(),es:4095&e.readUint16()});n.list=s,this.pmt||(this.pmt=[]),r.pmt=this.pmt.concat(s.map(e=>({pid:e.pid,es:e.es,streamType:e.streamType,program:n.program}))),t.payload=n}static Media(e,t,r){let n=t.header,i={};if(n.type=r,3===n.adaptation&&(i.adaptationLength=e.readUint8(),i.adaptationLength>0)){let t=e.readUint8();i.discontinue=t>>>7,i.access=t>>>6&1,i.priority=t>>>5&1,i.PCR=t>>>4&1,i.OPCR=t>>>3&1,i.splicePoint=t>>>2&1,i.transportPrivate=t>>>1&1,i.adaptationField=1&t;let r=e.position;if(1===i.PCR&&(i.programClockBase=e.readUint32()<<1,t=e.readUint16(),i.programClockBase|=t>>>15,i.programClockExtension=511&t),1===i.OPCR&&(i.originProgramClockBase=e.readUint32()<<1,t=e.readUint16(),i.originProgramClockBase+=t>>>15,i.originProgramClockExtension=511&t),1===i.splicePoint&&(i.spliceCountdown=e.readUint8()),1===i.transportPrivate){let t=e.readUint8(),r=[];for(let n=0;n<t;n++)r.push(e.readUint8())}if(1===i.adaptationField){let t=e.readUint8(),r=e.readUint8(),n=e.position,o=r>>>6&1,s=r>>>5&1;1===r>>>7&&(r=e.readUint16(),i.ltwValid=r>>>15,i.ltwOffset=61439&r),1===o&&(r=e.readUint24(),i.piecewiseRate=4194303&r),1===s&&(r=e.readInt8(),i.spliceType=r>>>4,i.dtsNextAU1=r>>>1&7,i.marker1=1&r,r=e.readUint16(),i.dtsNextAU2=r>>>1,i.marker2=1&r,r=e.readUint16(),i.dtsNextAU3=r),e.skip(t-1-(e.position-n))}let n=i.adaptationLength-1-(e.position-r);e.skip(n)}i.stream=new o.Stream(e.buffer.slice(e.position)),t.payload=i}static PES(e){let t={},r=e.payload.stream;if(1!==r.readUint24())t.ES={},t.ES.buffer=r;else{let e=r.readUint8();e>=224&&e<=239&&(t.type="video"),e>=192&&e<=223&&(t.type="audio");let n=r.readUint16();if(t.packetLength=n,"video"!==t.type&&"audio"!==t.type)throw new Error("format is not supported");{let e=r.readUint8();if(2!==e>>>6)throw new Error("error when parse pes header");e=r.readUint8(),t.ptsDTSFlag=e>>>6,t.escrFlag=e>>>5&1,t.esRateFlag=e>>>4&1,t.dsmFlag=e>>>3&1,t.additionalFlag=e>>>2&1,t.crcFlag=e>>>1&1,t.extensionFlag=1&e,t.pesHeaderLength=r.readUint8();let n=t.pesHeaderLength;if(2===t.ptsDTSFlag){let i=[];e=r.readUint8(),i.push(e>>>1&7),e=r.readUint16(),i.push(e>>>1),e=r.readUint16(),i.push(e>>>1),t.pts=i[0]<<30|i[1]<<15|i[2],n-=5,"video"===t.type&&(t.dts=t.pts)}if(3===t.ptsDTSFlag){let i=[];e=r.readUint8(),i.push(e>>>1&7),e=r.readUint16(),i.push(e>>>1),e=r.readUint16(),i.push(e>>>1),t.pts=i[0]<<30|i[1]<<15|i[2];let o=[];e=r.readUint8(),o.push(e>>>1&7),e=r.readUint16(),o.push(e>>>1),e=r.readUint16(),o.push(e>>>1),t.dts=o[0]<<30|o[1]<<15|o[2],n-=10}if(1===t.escrFlag){let i=[],o=[];e=r.readUint8(),i.push(e>>>3&7),i.push(3&e),e=r.readUint16(),i.push(e>>>13),i.push(3&e),e=r.readUint16(),i.push(e>>>13),o.push(3&e),e=r.readUint8(),o.push(e>>>1),t.escr=300*(i[0]<<30|i[1]<<28|i[2]<<15|i[3]<<13|i[4])+(o[0]<<7|o[1]),n-=6}if(1===t.esRateFlag&&(e=r.readUint24(),t.esRate=e>>>1&4194303,n-=3),1===t.dsmFlag)throw new Error("not support DSM_trick_mode");if(1===t.additionalFlag&&(e=r.readUint8(),t.additionalCopyInfo=127&e,n-=1),1===t.crcFlag&&(t.pesCRC=r.readUint16(),n-=2),1===t.extensionFlag)throw new Error("not support extension");n>0&&r.skip(n),t.ES=u.ES(r,t.type)}}return t}static ES(e,t){let r,n={};if("video"===t){if(1!==(r=e.readUint32())&&(e.back(4),1!==(r=e.readUint24())))throw new Error("h264 nal header parse failed");e.skip(2),n.buffer=e}else{if("audio"!==t)throw new Error(`ES ${t} is not supported`);{if((r=e.readUint16())>>>4!=4095)throw new Error("aac ES parse Error");const t=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n.id=0==(r>>>3&1)?"MPEG-4":"MPEG-2",n.layer=r>>>1&3,n.absent=1&r,r=e.readUint16(),n.audioObjectType=1+(r>>>14&3),n.profile=n.audioObjectType-1,n.frequencyIndex=r>>>10&15,n.frequence=t[n.frequencyIndex],n.channel=r>>>6&7,n.frameLength=(3&r)<<11|e.readUint16()>>>5,n.audioConfig=u.getAudioConfig(n.audioObjectType,n.channel,n.frequencyIndex),e.skip(1),n.buffer=e}}return n}static TSDT(e,t,r){t.payload={}}static CAT(e,t,r){let n={};n.tableID=e.readUint8();let i=e.readUint16();n.sectionIndicator=i>>>7,n.sectionLength=4095&i,e.skip(2),i=e.readUint8(),n.version=i>>>3,n.currentNextIndicator=1&i,n.sectionNumber=e.readUint8(),n.lastSectionNumber=e.readUint8();let o=(this.sectionLength-9)/4,s=[];for(let e=0;e<o;e++)s.push({});n.crc32=e.readUint32(),t.payload=n}static getAudioConfig(e,t,r){let n,i,o=navigator.userAgent.toLowerCase();return/firefox/i.test(o)?r>=6?(e=5,n=new Array(4),i=r-3):(e=2,n=new Array(2),i=r):-1!==o.indexOf("android")?(e=2,n=new Array(2),i=r):(e=5,n=new Array(4),r>=6?i=r-3:(1===t&&(e=2,n=new Array(2)),i=r)),n[0]=e<<3,n[0]|=(14&r)>>1,n[1]=(1&r)<<7,n[1]|=t<<3,5===e&&(n[1]|=(14&i)>>1,n[2]=(1&i)<<7,n[2]|=8,n[3]=0),n}get inputBuffer(){return this._context.getInstance(this.configs.inputbuffer)}get _tracks(){return this._context.getInstance("TRACKS")}}t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(47),s=(n=o)&&n.__esModule?n:{default:n};const{REMUX_EVENTS:a}=i.EVENTS;class u{constructor(){this.nextAudioDts=0,this.nextVideoDts=0,this.lastAudioSamplesLen=0,this.lastVideoSamplesLen=0,this.lastVideoDts=void 0,this.lastAudioDts=void 0,this.allAudioSamplesCount=0,this.allVideoSamplesCount=0,this._firstAudioSample=null,this._firstVideoSample=null,this.filledAudioSamples=[],this.filledVideoSamples=[]}init(){this.before(a.REMUX_MEDIA,this.doFix.bind(this))}reset(){this.nextAudioDts=0,this.nextVideoDts=0,this.lastAudioSamplesLen=0,this.lastVideoSamplesLen=0,this.lastVideoDts=void 0,this.lastAudioDts=void 0,this.allAudioSamplesCount=0,this.allVideoSamplesCount=0,this._firstAudioSample=null,this._firstVideoSample=null,this.filledAudioSamples=[],this.filledVideoSamples=[]}doFix(){const{isFirstAudioSamples:e,isFirstVideoSamples:t}=this.getFirstSample();this.removeInvalidSamples(),this.recordSamplesCount(),this._firstVideoSample&&this.fixRefSampleDuration(this.videoTrack.meta,this.videoTrack.samples),this._firstAudioSample&&this.fixRefSampleDuration(this.audioTrack.meta,this.audioTrack.samples),this.doFixVideo(t),this.doFixAudio(e)}doFixVideo(e){let{samples:t,meta:r}=this.videoTrack;if(r.frameRate&&!1===r.frameRate.fixed)return;if(!t||!t.length||!this._firstVideoSample)return;const n=t[0],i=n.dts,o=t.length;if(e&&this._firstAudioSample){const e=this._firstVideoSample.dts,i=e-this._firstAudioSample.dts;if(i>2*r.refSampleDuration){const o=Math.floor(i/r.refSampleDuration);for(let i=0;i<o;i++){const o=Object.assign({},n);o.dts=e-(i+1)*r.refSampleDuration,o.pts=o.dts+o.cts,t.unshift(o),this.filledVideoSamples.push({dts:o.dts,size:o.data.byteLength})}}}let s;if(this.nextVideoDts){s=i-this.nextVideoDts;const e=Math.abs(s);if(s>2*r.refSampleDuration){const e=Math.floor(s/r.refSampleDuration);for(let n=0;n<e;n++){const e=Object.assign({},t[0]),o=i-(n+1)*r.refSampleDuration;e.dts=o>this.nextVideoDts?o:this.nextVideoDts,e.pts=e.dts+e.cts,this.videoTrack.samples.unshift(e),this.filledVideoSamples.push({dts:e.dts,size:e.data.byteLength})}}else e<=10&&e>0&&(t[0].dts=this.nextVideoDts,t[0].originDts=t[0].dts,t[0].cts=t[0].cts||t[0].pts-t[0].dts,t[0].pts=t[0].dts+t[0].cts)}const a=t[t.length-1].dts,u=t.length>=2?a-t[t.length-2].dts:r.refSampleDuration;this.lastVideoSamplesLen=o,this.nextVideoDts=a+u,this.lastVideoDts=a;for(let e=0,n=t.length;e<n;e++){const n=t[e],i=t[e+1];if(!i)break;const o=i.dts-n.dts;if(o>2*r.refSampleDuration){let s=Math.floor(o/r.refSampleDuration),a=0;for(;a<s;){const o=Object.assign({},i);o.dts=n.dts+(a+1)*r.refSampleDuration,o.pts=o.dts+o.cts,o<i.dts&&(t.splice(e,0,o),this.filledVideoSamples.push({dts:o.dts,size:o.data.byteLength})),a++,e++}}}this.videoTrack.samples=t}doFixAudio(e){let{samples:t,meta:r}=this.audioTrack;if(!t||!t.length)return;const n=t.length,i=s.default.getSilentFrame(r.codec,r.channelCount),o=this._firstAudioSample;if(t=u.sortAudioSamples(t),this._firstVideoSample&&e){const e=this._firstVideoSample.pts?this._firstVideoSample.pts:this._firstVideoSample.dts+this._firstVideoSample.cts;if(o.dts-e>r.refSampleDuration){const n=Math.floor((o.dts-e)/r.refSampleDuration);for(let e=0;e<n;e++){const n={data:i,datasize:i.byteLength,dts:o.dts-(e+1)*r.refSampleDuration,filtered:0};t.unshift(n),this.filledAudioSamples.push({dts:n.dts,size:n.data.byteLength})}}}let a;const l=t[0].dts;if(this.nextAudioDts){a=l-this.nextAudioDts;const e=Math.abs(a);if(e>r.refSampleDuration&&1===n&&1===this.lastAudioSamplesLen&&(r.refSampleDurationFixed=void 0),a>2*r.refSampleDuration)if(1===n&&1===this.lastAudioSamplesLen)r.refSampleDurationFixed=void 0!==r.refSampleDurationFixed?r.refSampleDurationFixed+a:r.refSampleDuration+a;else{const e=Math.floor(a/r.refSampleDuration);for(let n=0;n<e;n++){const e=l-(n+1)*r.refSampleDuration,i=Object.assign({},t[0],{dts:e>this.nextAudioDts?e:this.nextAudioDts});this.filledAudioSamples.push({dts:i.dts,size:i.data.byteLength}),this.audioTrack.samples.unshift(i)}}else e<=10&&e>0&&(t[0].dts=this.nextAudioDts,t[0].pts=this.nextAudioDts)}const d=t[t.length-1].dts,c=t.length>=2?d-t[t.length-2].dts:r.refSampleDuration;this.lastAudioSamplesLen=n,this.nextAudioDts=r.refSampleDurationFixed?d+r.refSampleDurationFixed:d+c,this.lastAudioDts=d;for(let e=0,r=t.length;e<r;e++){const r=t[e],n=t[e+1];if(!n)break;const i=n.dts-r.dts;t[e].duration=i}this.audioTrack.samples=u.sortAudioSamples(t)}getFirstSample(){let{samples:e}=this.videoTrack,{samples:t}=this.audioTrack,r=!1,n=!1;return!this._firstVideoSample&&e.length&&(this._firstVideoSample=u.findFirstVideoSample(e),r=!0),!this._firstAudioSample&&t.length&&(this._firstAudioSample=u.findFirstAudioSample(t),n=!0),{isFirstVideoSamples:r,isFirstAudioSamples:n}}fixRefSampleDuration(e,t){const r="video"===e.type,n=r?this.allVideoSamplesCount:this.allAudioSamplesCount,i=r?this._firstVideoSample.dts:this._firstAudioSample.dts,o=r?this.filledVideoSamples.length:this.filledAudioSamples.length;if(!e.refSampleDuration||e.refSampleDuration<=0||Number.isNaN(e.refSampleDuration)){if(t.length>=1){const r=t[t.length-1].dts;e.refSampleDuration=Math.floor((r-i)/(n+o-1))}}else if(e.refSampleDuration&&t.length>=3){const r=(t[t.length-1].dts-t[0].dts)/t.length;e.refSampleDuration=Math.abs(e.refSampleDuration-r)<=e.refSampleDuration?e.refSampleDuration:r}}recordSamplesCount(){const{audioTrack:e,videoTrack:t}=this;this.allAudioSamplesCount+=e.samples.length,this.allVideoSamplesCount+=t.samples.length}removeInvalidSamples(){const{_firstVideoSample:e,_firstAudioSample:t}=this;this.audioTrack.samples=this.audioTrack.samples.filter(e=>e.dts>=t.dts&&(void 0===this.lastAudioDts||e.dts>this.lastAudioDts)),this.videoTrack.samples=this.videoTrack.samples.filter(t=>t.dts>=e.dts&&(void 0===this.lastVideoDts||t.dts>this.lastVideoDts))}static sortAudioSamples(e){return 1===e.length?e:e.sort((e,t)=>e.dts-t.dts)}static findFirstAudioSample(e){return e&&0!==e.length?u.sortAudioSamples(e)[0]:null}static findFirstVideoSample(e){if(!e.length)return null;const t=e.sort((e,t)=>e.dts-t.dts);for(let e=0,r=t.length;e<r;e++)if(t[e].isKeyframe)return t[e]}get tracks(){return this._context.getInstance("TRACKS")}get audioTrack(){return this.tracks?this.tracks.audioTrack:null}get videoTrack(){return this.tracks?this.tracks.videoTrack:null}}t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.mimetype="",this.init=null,this.data=[]}}t.default=class{constructor(){this.sources={}}getSource(e){return this.sources[e]}createSource(e){return this.sources[e]=new n,this.sources[e]}clear(){this.sources={}}destroy(){this.sources={}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0,this.fragLength=0,this._lastget=void 0,this._audoclear=e.autoclear||!1}get list(){return this._list}set baseURL(e){this.baseURL!==e&&(this.clear(),this._baseURL=e)}get baseURL(){return this._baseURL}push(e,t){this._ts[e]||(this._ts[e]={duration:t,downloaded:!1,downloading:!1,start:this.duration},this._list[this.duration]=e,this.duration+=t,this.fragLength+=1)}deleteFrag(e){this._ts[e]&&(this._ts[e].start>this._lastget.time&&(this._lastget={duration:this._ts[e].duration,time:this._ts[e].start,downloaded:!1,downloading:!1,url:e}),delete this._list[this._ts[e].start],delete this._ts[e],this.fragLength-=1)}pushM3U8(e,t){if(e&&(this.version=e.version,this.targetduration=e.targetduration,e.sequence>this.sequence)){this.sequence=e.sequence;let r=[];for(let t=0;t<e.frags.length;t++){let n=e.frags[t];this._ts[n.url]||(r.push(n.url),this.push(n.url,n.duration))}if(t){let e=this.getTsList();for(let t=0;t<e.length;t++)r.indexOf(e[t])<0&&this.deleteFrag(e[t])}}}getTsList(){return Object.keys(this._ts)}downloaded(e,t){let r=this._ts[e];r&&(r.downloaded=t)}downloading(e,t){let r=this._ts[e];r&&(r.downloading=t)}getTsByName(e){return this._ts[e]}getTs(e){let t,r=Object.keys(this._list);if(void 0===e&&(e=this._lastget?this._lastget.time+this._lastget.duration:0),!(r.length<1||e>=this.duration)){r.sort((e,t)=>parseFloat(e)-parseFloat(t));for(let n=0;n<r.length&&e>=parseInt(r[n]);n++){let e=this._list[r[n]];t={url:e,downloaded:this._ts[e].downloaded,downloading:this._ts[e].downloading,time:parseInt(r[n]),duration:parseInt(this._ts[e].duration)},this.autoclear&&(delete this._ts[this._lastget.url],delete this._list[this._lastget.time]),this._lastget=t}return t}}clear(){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0}clearDownloaded(){for(let e=0,t=Object.keys(this._ts).length;e<t;e++){let t=this._ts[Object.keys(this._ts)[e]];t.downloaded=!1,t.downloading=!1}}destroy(){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0,this.fragLength=0,this._lastget=void 0,this._audoclear=!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(2),s=r(3),a=r(51),u=(n=a)&&n.__esModule?n:{default:n};const l=i.EVENTS.DEMUX_EVENTS;class d{constructor(){this._firstFragmentLoaded=!1,this._trackNum=0,this._hasScript=!1}init(){this.on(l.DEMUX_START,this.doParseFlv.bind(this))}static isFlvFile(e){return!(70!==e[0]||76!==e[1]||86!==e[2]||1!==e[3])}static getPlayType(e){const t={hasVideo:!1,hasAudio:!1};return!0&e&&(t.hasVideo=!0),!0&e&&(t.hasAudio=!0),t}doParseFlv(){if(this._firstFragmentLoaded){if(this.loaderBuffer.length<11)return;let e;do{e=this._parseFlvTag()}while(e);this.emit(l.DEMUX_COMPLETE)}else{if(this.loaderBuffer.length<13)return;const e=this.loaderBuffer.shift(13);this.parseFlvHeader(e),this.doParseFlv()}}parseFlvHeader(e){if(d.isFlvFile(e)){this._firstFragmentLoaded=!0;const t=d.getPlayType(e[4]);t.hasVideo&&this.initVideoTrack(),t.hasAudio&&this.initAudioTrack()}else this.emit(l.DEMUX_ERROR,new Error("invalid flv file")),this.doParseFlv();this.doParseFlv()}initVideoTrack(){this._trackNum++;let e=new s.VideoTrack;e.meta=new i.VideoTrackMeta,e.id=e.meta.id=this._trackNum,this.tracks.videoTrack=e}initAudioTrack(){this._trackNum++;let e=new s.AudioTrack;e.meta=new i.AudioTrackMeta,e.id=e.meta.id=this._trackNum,this.tracks.audioTrack=e}_parseFlvTag(){if(this.loaderBuffer.length<11)return null;let e=this._parseFlvTagHeader();return e&&this._processChunk(e),e}_parseFlvTagHeader(){let e=0,t={},r=this.loaderBuffer.toInt(e,1);if(e+=1,t.filtered=(32&r)>>>5,t.tagType=31&r,t.datasize=this.loaderBuffer.toInt(e,3),e+=3,8!==t.tagType&&9!==t.tagType&&11!==t.tagType&&18!==t.tagType||0!==this.loaderBuffer.toInt(8,3))return this.loaderBuffer&&this.loaderBuffer.length>0&&this.loaderBuffer.shift(1),this.logger.warn(this.TAG,"tagType "+t.tagType),null;if(this.loaderBuffer.length<t.datasize+15)return null;this.loaderBuffer.shift(4);let n=this.loaderBuffer.toInt(0,3);this.loaderBuffer.shift(3);let i=this.loaderBuffer.shift(1)[0];return i>0&&(n+=16777216*i),t.dts=n,this.loaderBuffer.shift(3),t}_processChunk(e){switch(e.tagType){case 18:this._parseScriptData(e);break;case 8:this._parseAACData(e);break;case 9:this._parseHevcData(e);break;case 11:this.loaderBuffer.shift(3);break;default:this.loaderBuffer.shift(1)}}_parseScriptData(e){let t=this.tracks.audioTrack,r=this.tracks.videoTrack,n=this.loaderBuffer.shift(e.datasize);const i=(new u.default).resolve(n,n.length),o=this._context.onMetaData=i?i.onMetaData:void 0;if(this._context.mediaInfo.duration=o.duration,this._context.mediaInfo.hasVideo=o.hasVideo,this._context.mediaInfo.hsaAudio=o.hasAudio,this._datasizeValidator(e.datasize)&&(this.emit(l.MEDIA_INFO),this._hasScript=!0),t&&!t.hasSpecificConfig){let e=t.meta;switch(o.audiosamplerate&&(e.sampleRate=o.audiosamplerate),o.audiochannels&&(e.channelCount=o.audiochannels),o.audiosamplerate){case 44100:e.sampleRateIndex=4;break;case 22050:e.sampleRateIndex=7;break;case 11025:e.sampleRateIndex=10}}if(r&&!r.hasSpecificConfig){let e=r.meta;if("number"==typeof o.framerate){let t=Math.floor(1e3*o.framerate);if(t>0){let r=t/1e3;e.frameRate||(e.frameRate={}),e.frameRate.fixed=!0,e.frameRate.fps=r,e.frameRate.fps_num=t,e.frameRate.fps_den=1e3}}}}_aacSequenceHeaderParser(e){let t={hasSpecificConfig:!0};t.objectType=e[1]>>>3,t.sampleRateIndex=(7&e[1])<<1|e[2]>>>7,t.audiosamplerate=this._switchAudioSampleRate(t.sampleRateIndex),t.channelCount=(120&e[2])>>>3,t.frameLength=(4&e[2])>>>2,t.dependsOnCoreCoder=(2&e[2])>>>1,t.extensionFlagIndex=1&e[2],t.codec=`mp4a.40.${t.objectType}`;let r,n,i=window.navigator.userAgent.toLowerCase(),o=t.sampleRateIndex;return-1!==i.indexOf("firefox")?t.sampleRateIndex>=6?(t.objectType=5,n=new Array(4),r=o-3):(t.objectType=2,n=new Array(2),r=o):-1!==i.indexOf("android")?(t.objectType=2,n=new Array(2),r=o):(t.objectType=5,r=t.sampleRateIndex,n=new Array(4),t.sampleRateIndex>=6?r=t.sampleRateIndex-3:1===t.channelCount&&(t.objectType=2,n=new Array(2),r=t.sampleRateIndex)),n[0]=t.objectType<<3,n[0]|=(15&t.sampleRateIndex)>>>1,n[1]=(15&t.sampleRateIndex)<<7,n[1]|=(15&t.channelCount)<<3,5===t.objectType&&(n[1]|=(15&r)>>>1,n[2]=(1&r)<<7,n[2]|=8,n[3]=0),t.config=n,t}_parseAACData(e){let t=this.tracks.audioTrack;if(!t)return;let r=t.meta;r||(r=new i.AudioTrackMeta);let n=this.loaderBuffer.shift(1)[0];e.data=this.loaderBuffer.shift(e.datasize-1);let o=(240&n)>>>4;t.format=o,10!==o&&this.emit(l.DEMUX_ERROR,new Error(`invalid audio format: ${o}`)),10!==o||this._hasAudioSequence||(r.sampleRate=this._switchAudioSamplingFrequency(n),r.sampleRateIndex=(12&n)>>>2,r.frameLenth=(2&n)>>>1,r.channelCount=1&n,r.refSampleDuration=Math.floor(1024/r.audioSampleRate*r.timescale));let s=r.audioSampleRate,a=r.sampleRateIndex,u=r.refSampleDuration;delete e.tagType;let d=this._datasizeValidator(e.datasize);if(0===e.data[0]){let t=this._aacSequenceHeaderParser(e.data);s=t.audiosamplerate||r.audioSampleRate,a=t.sampleRateIndex||r.sampleRateIndex,u=Math.floor(1024/s*r.timescale),r.channelCount=t.channelCount,r.sampleRate=s,r.sampleRateIndex=a,r.refSampleDuration=u,r.duration=this._context.mediaInfo.duration*r.timescale,r.config=t.config,r.objectType=t.objectType;const n=this._context.mediaInfo.audio;n.codec=t.codec,n.channelCount=t.channelCount,n.sampleRate=s,n.sampleRateIndex=t.audioSampleRateIndex,this._hasScript&&!this._hasAudioSequence?this.emit(l.METADATA_PARSED,"audio"):this._hasScript&&this._hasAudioSequence&&this.emit(l.AUDIO_METADATA_CHANGE),this._hasAudioSequence=!0}else e.data=e.data.slice(1,e.data.length),t.samples.push(e);if(!d){const t=new Error("TAG length error at "+e.datasize);this.emit(l.DEMUX_ERROR,t.message),this.logger.warn(this.TAG,t.message)}}_parseHevcData(e){let t=this.loaderBuffer.shift(1)[0];e.frameType=(240&t)>>>4,e.isKeyframe=1===e.frameType;let r=15&t;if(this.tracks.videoTrack.codecID=r,e.avcPacketType=this.loaderBuffer.shift(1)[0],e.cts=this.loaderBuffer.toInt(0,3),this.loaderBuffer.shift(3),12===r){const t=this.loaderBuffer.shift(e.datasize-5);if(e.data=t,0!==Number.parseInt(e.avcPacketType)){this._datasizeValidator(e.datasize)||this.logger.warn(this.TAG,`invalid video tag datasize: ${e.datasize}`);let t={},r=0;for(t.cts=e.cts,t.dts=e.dts;e.data.length>r;){let n=e.data.slice(Number.parseInt(r),4+r);t.size=n[3],t.size+=256*n[2],t.size+=256*n[1]*256,t.size+=256*n[0]*256*256,r+=4,t.data=e.data.slice(Number.parseInt(r),t.size+r),r+=t.size,this.tracks.videoTrack.samples.push(t),this.emit(l.METADATA_PARSED,"video")}}else 0===Number.parseInt(e.avcPacketType)&&(this._datasizeValidator(e.datasize)?this.emit(l.METADATA_PARSED,"video"):this.logger.warn(this.TAG,`invalid video tag datasize: ${e.datasize}`))}else if(7===r){let t=this.loaderBuffer.shift(e.datasize-5);if(0===t[4]&&0===t[5]&&0===t[6]&&1===t[7]){let e=0;for(let r=0;r<4;r++)e=256*e+t[r];e-=4,(t=t.slice(4,t.length))[3]=e%256,e=(e-t[3])/256,t[2]=e%256,e=(e-t[2])/256,t[1]=e%256,t[0]=(e-t[1])/256}if(e.data=t,0===e.avcPacketType){this._avcSequenceHeaderParser(e.data),this._datasizeValidator(e.datasize)&&(this._hasScript&&!this._hasVideoSequence?this.emit(l.METADATA_PARSED,"video"):this._hasScript&&this._hasVideoSequence&&this.emit(l.VIDEO_METADATA_CHANGE),this._hasVideoSequence=!0)}else{if(!this._datasizeValidator(e.datasize))return void this.logger.warn(this.TAG,`invalid video tag datasize: ${e.datasize}`);this.tracks.videoTrack.samples.push(e)}}else this.logger.warn(this.TAG,`video codeid is ${r}`),e.data=this.loaderBuffer.shift(e.datasize-1),this._datasizeValidator(e.datasize)||this.logger.warn(this.TAG,`invalid video tag datasize: ${e.datasize}`),this.tracks.videoTrack.samples.push(e),this.emit(l.DEMUX_COMPLETE);delete e.tagType}_avcSequenceHeaderParser(e){let t=this.tracks.videoTrack;if(!t)return;let r=0;t.meta||(t.meta=new i.VideoTrackMeta);let n=t.meta;n.configurationVersion=e[0],n.avcProfileIndication=e[1],n.profileCompatibility=e[2],n.avcLevelIndication=e[3]/10,n.nalUnitLength=1+(3&e[4]);let s=31&e[5];r=6;let a={};for(let t=0;t<s;t++){let t=255*e[r]+e[r+1];r+=2;let i=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e[r+n];let s="avc1.";for(let e=1;e<4;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),s+=t}n.codec=s,r+=t,this.tracks.videoTrack.meta.sps=i,a=o.SpsParser.parseSPS(i)}let u=e[r];r++;for(let t=0;t<u;t++){let t=255*e[r]+e[r+1];r+=2;let n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=e[r+i];r+=t,this.tracks.videoTrack.meta.pps=n}Object.assign(n,o.SpsParser.toVideoMeta(a));const l=this._context.mediaInfo.video;l.codec=n.codec,l.profile=n.profile,l.level=n.level,l.chromaFormat=n.chromaFormat,l.frameRate=n.frameRate,l.parRatio=n.parRatio,l.width=l.width===n.presentWidth?l.width:n.presentWidth,l.height=l.height===n.presentHeight?l.width:n.presentHeight,n.duration=this._context.mediaInfo.duration*n.timescale,n.avcc=new Uint8Array(e.length),n.avcc.set(e),t.meta=n}_switchAudioSampleRate(e){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][e]}_switchAudioSamplingFrequency(e){return[5500,11025,22050,44100,48e3][(12&e)>>>2]}_switchAudioChannel(e){return[1,2][1&e]}_datasizeValidator(e){let t=this.loaderBuffer.toInt(0,4);return this.loaderBuffer.shift(4),t===e+11}get loaderBuffer(){if(this._context.getInstance("LOADER_BUFFER"))return this._context.getInstance("LOADER_BUFFER");this.emit(l.DEMUX_ERROR,new Error("找不到 loaderBuffer 实例"))}get tracks(){return this._context.getInstance("TRACKS")}get logger(){return this._context.getInstance("LOGGER")}}t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);const i={NUMBER:0,BOOLEAN:1,STRING:2,OBJECT:3,MIX_ARRAY:8,OBJECT_END:9,STRICT_ARRAY:10,DATE:11,LONE_STRING:12};t.default=class{constructor(){this.offset=0,this.readOffset=this.offset}resolve(e,t){if(t<3)throw new Error("not enough data for metainfo");const r={},n=this.parseValue(e),i=this.parseValue(e,t-n.bodySize);return r[n.data]=i.data,this.resetStatus(),r}resetStatus(){this.offset=0,this.readOffset=this.offset}parseString(e){const t=new DataView(e,this.readOffset).getUint16(0,!n.isLe);let r="";r=t>0?n.UTF8.decode(new Uint8Array(e,this.readOffset+2,t)):"";let i=t+2;return this.readOffset+=i,{data:r,bodySize:t+2}}parseDate(e,t){const r=new DataView(e,this.readOffset,t);let i=r.getFloat64(0,!n.isLe);return i+=60*r.getInt16(8,!n.isLe)*1e3,this.readOffset+=10,{data:new Date(i),bodySize:10}}parseObject(e,t){const r=this.parseString(e,t),n=this.parseValue(e,t-r.bodySize);return{data:{name:r.data,value:n.data},bodySize:r.bodySize+n.bodySize,isObjEnd:n.isObjEnd}}parseLongString(e){const t=new DataView(e,this.readOffset).getUint32(0,!n.isLe);let r="";return r=t>0?n.UTF8.decode(new Uint8Array(e,this.readOffset+2,t)):"",this.readOffset+=t+4,{data:r,bodySize:t+4}}parseValue(e,t){let r=new ArrayBuffer;r=e instanceof ArrayBuffer?e:e.buffer;const{NUMBER:o,BOOLEAN:s,STRING:a,OBJECT:u,MIX_ARRAY:l,OBJECT_END:d,STRICT_ARRAY:c,DATE:f,LONE_STRING:h}=i,p=new DataView(r,this.readOffset,t);let m=!1;const g=p.getUint8(0);let y=1;this.readOffset+=1;let _=null;switch(g){case o:_=p.getFloat64(1,!n.isLe),this.readOffset+=8,y+=8;break;case s:_=!!p.getUint8(1),this.readOffset+=1,y+=1;break;case a:{const e=this.parseString(r);_=e.data,y+=e.bodySize;break}case u:{_={};let e=0;for(16777215&p.getUint32(t-4,!n.isLe)&&(e=3);y<t-4;){const n=this.parseObject(r,t-y-e);if(n.isObjectEnd)break;_[n.data.name]=n.data.value,y+=n.bodySize}if(y<=t-3){9===(16777215&p.getUint32(y-1,!n.isLe))&&(this.readOffset+=3,y+=3)}break}case l:{_={},y+=4,this.readOffset+=4;let e=0;for(9==(16777215&p.getUint32(t-4,!n.isLe))&&(e=3);y<t-8;){const n=this.parseObject(r,t-y-e);if(n.isObjectEnd)break;_[n.data.name]=n.data.value,y+=n.bodySize}if(y<=t-3){9===(16777215&p.getUint32(y-1,!n.isLe))&&(y+=3,this.readOffset+=3)}break}case d:_=null,m=!0;break;case c:{_=[];const e=p.getUint32(1,!n.isLe);y+=4,this.readOffset+=4;for(let n=0;n<e;n++){const e=this.parseValue(r,t-y);_.push(e.data),y+=e.bodySize}break}case f:{const e=this.parseDate(r,t-1);_=e.data,y+=e.bodySize;break}case h:{const e=this.parseLongString(r,t-1);_=e.data,y+=e.bodySize;break}default:y=t}return{data:_,bodySize:y,isObjEnd:m}}}},function(e,t,r){e.exports=r(53)},function(e,t,r){"use strict";var n=s(r(4)),i=r(0),o=s(r(54));function s(e){return e&&e.__esModule?e:{default:e}}const a=i.EVENTS.FlvAllowedEvents;class u extends n.default{constructor(e){super(e),this.context=new i.Context(a),this.initEvents()}start(){this.initFlv(),this.context.init(),super.start(this.flv.mse.url)}initFlvEvents(e){const t=this;e.once(i.EVENTS.REMUX_EVENTS.INIT_SEGMENT,()=>{if(n.default.util.addClass(t.root,"xgplayer-is-live"),!n.default.util.findDom(this.root,"xg-live")){const e=n.default.util.createDom("xg-live","正在直播",{},"xgplayer-live");t.controls.appendChild(e)}}),e.once(i.EVENTS.LOADER_EVENTS.LOADER_COMPLETE,()=>{if(!t.paused){const e=setInterval(()=>{const r=t.getBufferedRange()[1];Math.abs(t.currentTime-r)<.5&&(t.emit("ended"),window.clearInterval(e))},200)}})}initEvents(){this.on("timeupdate",()=>{this.loadData()}),this.on("seeking",()=>{const e=this.currentTime,t=this.getBufferedRange();(e>t[1]||e<t[0])&&this.flv.seek(this.currentTime)})}initFlv(){const e=this.context.registry("FLV_CONTROLLER",o.default)(this);this.initFlvEvents(e),this.flv=e}play(){if(this._hasStart){this._destroy(),this.context=new i.Context(a);const e=this.context.registry("FLV_CONTROLLER",o.default)(this);this.initFlvEvents(e),this.flv=e,this.context.init(),super.start(e.mse.url),super.play()}else super.play()}pause(){super.pause(),this.flv&&this.flv.pause()}loadData(e=this.currentTime){this.flv&&this.flv.seek(e)}destroy(){this._destroy(),super.destroy()}_destroy(){this.context.destroy(),this.flv=null,this.context=null}get src(){return this.currentSrc}set src(e){this.player.config.url=e,this.paused?this.start(e):(this.pause(),this.once("pause",()=>{this.start(e)}),this.once("canplay",()=>{this.play()})),this.once("canplay",()=>{this.currentTime=0})}}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(38)),i=r(41),o=r(43),s=r(3),a=r(0),u=r(2),l=d(r(4));function d(e){return e&&e.__esModule?e:{default:e}}const c=a.EVENTS.REMUX_EVENTS,f=a.EVENTS.DEMUX_EVENTS,h=a.EVENTS.LOADER_EVENTS,p=a.EVENTS.MSE_EVENTS,m="FLVController";class g{warn(){}}t.default=class{constructor(e){this.TAG=m,this._player=e,this.state={initSegmentArrived:!1}}init(){this._context.registry("FETCH_LOADER",i.FetchLoader),this._context.registry("LOADER_BUFFER",s.XgBuffer),this._context.registry("FLV_DEMUXER",o.FlvDemuxer),this._context.registry("TRACKS",s.Tracks),this._context.registry("MP4_REMUXER",n.default.Mp4Remuxer),this._context.registry("PRE_SOURCE_BUFFER",s.PreSource),this._context.registry("COMPATIBILITY",u.Compatibility),this._context.registry("LOGGER",g),this.mse=this._context.registry("MSE",a.Mse)({container:this._player.video}),this.initListeners()}initListeners(){this.on(h.LOADER_DATALOADED,this._handleLoaderDataLoaded.bind(this)),this.on(h.LOADER_ERROR,this._handleNetworkError.bind(this)),this.on(f.MEDIA_INFO,this._handleMediaInfo.bind(this)),this.on(f.METADATA_PARSED,this._handleMetadataParsed.bind(this)),this.on(f.DEMUX_COMPLETE,this._handleDemuxComplete.bind(this)),this.on(f.DEMUX_ERROR,this._handleDemuxError.bind(this)),this.on(c.INIT_SEGMENT,this._handleAppendInitSegment.bind(this)),this.on(c.MEDIA_SEGMENT,this._handleMediaSegment.bind(this)),this.on(p.SOURCE_UPDATE_END,this._handleSourceUpdateEnd.bind(this)),this._player.on("timeupdate",this._handleTimeUpdate.bind(this))}_handleMediaInfo(){this._context.mediaInfo||this.emit(f.DEMUX_ERROR,new Error("failed to get mediainfo"))}_handleLoaderDataLoaded(){this.emitTo("FLV_DEMUXER",f.DEMUX_START)}_handleMetadataParsed(e){this.emit(c.REMUX_METADATA,e)}_handleDemuxComplete(){this.emit(c.REMUX_MEDIA)}_handleAppendInitSegment(){this.state.initSegmentArrived=!0,this.mse.addSourceBuffers()}_handleMediaSegment(){this.mse.addSourceBuffers(),this.mse.doAppend()}_handleSourceUpdateEnd(){const e=this._player.currentTime,t=this._player.video,r=this._player.config.preloadTime||5,{length:n}=t.buffered;if(0===n)return;const i=t.buffered.end(n-1);i-e>2*r&&(this._player.currentTime=i-r)}_handleTimeUpdate(){const e=this._player.currentTime;e>2&&this.mse.remove(e-2)}_handleNetworkError(){this._player.emit("error",new l.default.Errors("network",this._player.config.url))}_handleDemuxError(){this._player.emit("error",new l.default.Errors("parse",this._player.config.url))}seek(){this.state.initSegmentArrived||this.loadData()}loadData(){this.emit(h.LADER_START,this._player.config.url)}pause(){const e=this._context.getInstance("FETCH_LOADER");e&&e.cancel()}}}]);